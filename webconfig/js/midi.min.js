for(var mapSelection,IMUmapSelection,on,off,deviceName,buttonRowWrite,jumpFactorWrite,fingeringWrite,exprlowsliderHandleSetting,exprhighsliderHandleSetting,WARBL2SettingsReceive,sendDelay=15,center=[1,1,1,1],IMUchannel=[1,1,1],IMUnumber=[2,2,2],curve=[0,0,0,0],pressureShakeMod=[0,0,0],pressureShakeDepth=[0,0,0],inputSliderMin=[0,0,0,0,-90,-90,-90],inputSliderMax=[100,100,100,100,90,90,90],outputSliderMin=[0,0,0,0,0,0,0],outputSliderMax=[127,127,127,127,127,127,127],consoleEntries=0,customFingeringFills=[[null,null,null,null,null,null,null,null,null,null,null],[0,74,73,72,71,69,67,66,64,62,61],[0,74,72,72,70,68,67,65,64,62,61],[0,74,74,72,72,69,68,67,65,62,60]],communicationMode=!1,noteNames=["C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G"],noteNamesforKeySelect=["G#","A","Bb","B","C3","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C4","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C5","C#","D","Eb","F","F#","G","G#","A"],notePlaying=-1,numberOfGestures=10,midiNotes=[],currentVersion=42,currentVersionOriginal=21,previousVersion=0,midiAccess=null,WARBLout=null,WARBLin=null,midiConnecting=!1,midiScanningOut=null,selectedMidiOutId=0,gExportProxy=null,gPressureGraphEnabled=!1,gCurrentPressure=0,gGraphInterval=null,gNPressureReadings=100,gMaxPressure=25,gPressureReadings=[],volume=0,currentNote=62,sendAllQueue=[],sendWARBLoutQueue=[],sendWARBLInterval=setInterval(sendQueuedWARBLoutMessages,sendDelay),sendAllInterval=setInterval(sendAllQueuedMessages,sendDelay),sensorValue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],version="Unknown",instrument=0,lsb=0,connIntvlLSB=0,defaultInstr=0,modals=new Array,w=1;w<=29;w++)modals[w]=document.getElementById("open-modal"+w);function updatePlatform(){var newdisp="app"==platform||"app2"==platform?"none":"block",newdisp=(document.getElementById("myTopnav").style.display=newdisp,document.getElementById("topLogo").style.display=newdisp,document.getElementById("importexport").style.display=newdisp,"app"==platform?"none":"block");document.getElementById("midiSelector").style.display=newdisp,document.getElementById("tinyDeviceLabel").style.display=newdisp}function showWARBLNotDetected(){communicationMode=!1,document.getElementById("status").innerHTML="WARBL not detected.",document.getElementById("status").style.color="#F78339",document.getElementById("version").style.color="#F78339",document.getElementById("connect").innerHTML="Connect to WARBL",document.getElementById("pressure").innerHTML="",document.getElementById("connLabel").innerHTML="BLE not connected",document.getElementById("connLabel").style.left="95px";for(var m=0;m<9;m++)document.getElementById("dot"+m).style.backgroundColor="#333",0==m&&(document.getElementById("dot0").style.opacity="0");$("#importPreset").attr("disabled","disabled")}function showWARBLUnknown(){document.getElementById("version").innerHTML="Unknown",document.getElementById("current").style.visibility="hidden",document.getElementById("status").style.visibility="visible",document.getElementById("connect").innerHTML="Connect to WARBL",$("#importPreset").attr("disabled","disabled")}function updateMidiDeviceSelector(){if(midiAccess){for(var element,selector=document.getElementById("midiDeviceSelector"),autoelement=(selector.length=0,document.createElement("option")),iter=(autoelement.value=0,autoelement.text="Auto",selector.append(autoelement),midiAccess.outputs.values()),currSelectionExists=!1,o=iter.next();!o.done;o=iter.next())o.value&&(element=document.createElement("option"),o.value.id&&(element.value=o.value.id,o.value.id==selectedMidiOutId)&&(currSelectionExists=!0),element.text=o.value.name,selector.append(element));selector.value=WARBLout?WARBLout.id:currSelectionExists?selectedMidiOutId:0}}function midiDeviceSelected(value){console.log("Midi device selected: "+value),selectedMidiOutId=value,startMidiConnect()}function enableMidiInputForOnly(portid){if(midiAccess)for(var inputs=midiAccess.inputs.values(),input=inputs.next();input&&!input.done;input=inputs.next())input.value.id==portid?input.value.onmidimessage=WARBL_Receive:input.value.onmidimessage=null}function enableMidiInputsForAll(){if(midiAccess){for(var inputs=midiAccess.inputs.values(),input=inputs.next();input&&!input.done;input=inputs.next())input.value.onmidimessage=WARBL_Receive,"app"==platform&&(input.value.onstatechange=function(event){event=event.port;console.log("MIDIInputPort onstatechange name:"+event.name+" connection:"+event.connection+" state:"+event.state),"disconnected"==event.state&&setToDisconnected()});return console.log("Number midi inputs: "+midiAccess.inputs.size),0<midiAccess.inputs.size}return!1}function connect(){var cc;communicationMode&&2<version?(console.log("DISCONNECTING"),cc=buildMessage(MIDI_CC_102,version<4.1?MIDI_CC_102_VALUE_99:MIDI_CC_102_VALUE_104),WARBLout&&1!=WARBLout&&WARBLout.send(cc),setToDisconnected(),enableMidiInputForOnly(0)):startMidiConnect()}async function startMidiConnect(){setToDisconnected(),console.log("startMidiConnect");for(var outputId=document.getElementById("midiDeviceSelector").value,cc=(enableMidiInputsForAll(),buildMessage(MIDI_CC_102,MIDI_ENTER_COMM_MODE)),iter=(midiConnecting=!0,midiAccess.outputs.values()),o=iter.next();!o.done&&!communicationMode;o=iter.next())0!=outputId&&o.value.id!=outputId||!o.value.name.includes("WARBL")||(console.log("Attempting connect to "+o.value.name+" id: "+o.value.id),midiScanningOut=o.value,o.value.send(cc),await sleep(250));if(!communicationMode)for(o=(iter=midiAccess.outputs.values()).next();!o.done&&!communicationMode;o=iter.next())0!=outputId&&o.value.id!=outputId||o.value.name.includes("WARBL")||(console.log("Attempting connect to "+o.value.name+" id: "+o.value.id),midiScanningOut=o.value,o.value.send(cc),await sleep(250));midiScanningOut=null,midiConnecting=!1,communicationMode||(console.log("Could not detect any connected WARBLs"),enableMidiInputForOnly(0),showWARBLNotDetected())}async function onMIDIInit(midi){(midiAccess=midi).onstatechange=midiOnStateChange,WARBLin=WARBLout=null;midi=enableMidiInputsForAll();updateMidiDeviceSelector(),(midi?(console.log("trying initial connect"),startMidiConnect):(console.log("no inputs"),showWARBLNotDetected))()}function onMIDIReject(err){alert("The MIDI system failed to start. Please refresh the page.")}function setToDisconnected(){showWARBLNotDetected(),showWARBLUnknown(),WARBLin=WARBLout=null,communicationMode=!1,previousVersion=0,document.getElementById("connect").innerHTML="Connect to WARBL"}function midiOnStateChange(event){if(console.log("midi state change"),WARBLout){for(var iter=midiAccess.outputs.values(),foundit=!1,o=iter.next();!o.done;o=iter.next())if(console.log("Searching out "+o.value.id+"  wout: "+WARBLout.id),o.value==WARBLout){foundit=!0;break}foundit||(selectedMidiOutId=0,setToDisconnected(),enableMidiInputForOnly(0))}updateMidiDeviceSelector()}function setPing(){setTimeout(function(){ping=1},3e3)}function buildMessage(byte2,byte3){if(byte2==MIDI_CC_102&&byte3==MIDI_START_CALIB||byte2==MIDI_CC_106&&byte3==MIDI_CALIB_BELL_SENSOR||blink(1),byte2==MIDI_CC_102){if(byte3==MIDI_SAVE_CALIB){blink(3);for(var i=1;i<10;i++)document.getElementById("v"+i).innerHTML="0";for(i=0;i<19;i++)sensorValue[i]=0}isEven(byte3)&&byte3<=MIDI_CALIB_MSGS_END&&(sensorValue[byte3-2]++,document.getElementById("v"+(byte3>>1)).innerHTML=sensorValue[byte3-2]),isOdd(byte3)&&byte3<=MIDI_CALIB_MSGS_END&&(sensorValue[byte3-1]--,document.getElementById("v"+(byte3+1>>1)).innerHTML=sensorValue[byte3-1],checkMax(byte3+1>>1))}return cc=[182,byte2,byte3]}function sendToAll(byte2,byte3){byte2=buildMessage(byte2,byte3);sendAllQueue.push(byte2),sendAllInterval=sendAllInterval||setInterval(sendAllQueuedMessages,sendDelay)}function sendToWARBL(byte2,byte3){var cc;communicationMode&&("app"==platform?(cc=buildMessage(byte2,byte3),sendAllQueue.push(cc),sendAllInterval=sendAllInterval||setInterval(sendAllQueuedMessages,sendDelay)):WARBLout?(cc=buildMessage(byte2,byte3),MIDI_DEBUG&&console.log("sendToWARBL",byte2,byte3),sendWARBLoutQueue.push(cc),sendWARBLInterval=sendWARBLInterval||setInterval(sendQueuedWARBLoutMessages,sendDelay)):console.error("sendToWARBL: No MIDI port selected!"))}function sendQueuedWARBLoutMessages(){var cc;0<sendWARBLoutQueue.length?(cc=sendWARBLoutQueue.shift(),WARBLout.send(cc)):(clearInterval(sendWARBLInterval),sendWARBLInterval=null)}function sendAllQueuedMessages(){if(0<sendAllQueue.length)for(var cc=sendAllQueue.shift(),iter=midiAccess.outputs.values(),o=iter.next();!o.done;o=iter.next())o.value.send(cc);else clearInterval(sendAllInterval),sendAllInterval=null}function WARBL_Receive(event,source){var data0=event.data[0],data1=event.data[1],data2=event.data[2];if(gExportProxy)gExportProxy(data0,data1,data2);else if(source=null!=event.target?event.target:source,WARBLout&&WARBLin||(15&data0)!=MIDI_CONFIG_TOOL_CHANNEL-1||176!=(240&data0)||data1!=MIDI_CC_110||(console.log("Platform: "+platform),"app"==platform?(console.log("Legacy app connection"),WARBLout=1,WARBLin=source):(console.log("midiScanningOut: "+midiScanningOut+" id: "+midiScanningOut.id),!WARBLout&&midiScanningOut&&(selectedMidiOutId=(WARBLout=midiScanningOut).id),WARBLin=source,WARBLout&&WARBLin&&(console.log("Connected WARBL!"),console.log(WARBLin),enableMidiInputForOnly(WARBLin.id),updateMidiDeviceSelector()))),1==WARBLout||WARBLin&&WARBLin==source){var e,heightPixels,pitchcents,gesture,barWidth,centsBarWidth,pressbar,bendbar,iscenter,event=isNaN(data2)?" ":data2,markerTopPixels=(144==(240&data0)&&(e="On"),128==(240&data0)&&(e="Off"),176==(240&data0)&&(e="CC"),224==(240&data0)&&(e="PB"),192==(240&data0)&&(e="PC"),208==(240&data0)&&(e="CP"),"PB"==(e=160==(240&data0)?"KP":e)&&(source=data1+(data2<<7)-8192,pitchcents=(document.getElementById("receivedPB").innerHTML=source)/8192*100*document.getElementById("midiBendRange").value,document.getElementById("receivedPBCents").innerHTML=(0<pitchcents?"+":"")+pitchcents.toFixed(0),heightPixels=65-(pitchcents=source/81.92)/100*65+"px",markerTopPixels=65-pitchcents/100*65+90+"px",document.getElementById("PBmarker").style.top=markerTopPixels,source<0?(document.getElementById("PBlevel").style.height=-pitchcents+"%",document.getElementById("topPBlevel").style.height="0%"):0<source?(document.getElementById("PBlevel").style.height="0%",document.getElementById("topPBlevel").style.height=pitchcents+"%",document.getElementById("topPBlevel").style.top=heightPixels):(document.getElementById("PBlevel").style.height="0%",document.getElementById("topPBlevel").style.height="0%")),document.getElementById("IMUChannelInput").value),source=document.getElementById("IMUCC").value;switch("CC"==e&&parseFloat(15&data0)+1==markerTopPixels&&data1==source&&(barWidth=(document.getElementById("receivedCC").innerHTML=data2)/1.27,document.getElementById("CClevel").style.width=barWidth+"%"),0==mapSelection&&(markerTopPixels=document.getElementById("pressureChannel").value,source=document.getElementById("pressureCC").value,"CC"==e)&&parseFloat(15&data0)+1==markerTopPixels&&data1==source&&(barWidth=(document.getElementById("receivedpressureCC").innerHTML=data2)/1.27,document.getElementById("CCpressurelevel").style.width=barWidth+"%"),1==mapSelection&&"On"==e&&(barWidth=(document.getElementById("receivedpressureCC").innerHTML=data2)/1.27,document.getElementById("CCpressurelevel").style.width=barWidth+"%"),2==mapSelection&&"CP"==e&&(barWidth=(document.getElementById("receivedpressureCC").innerHTML=data1)/1.27,document.getElementById("CCpressurelevel").style.width=barWidth+"%"),3==mapSelection&&"KP"==e&&(barWidth=(document.getElementById("receivedpressureCC").innerHTML=data2)/1.27,document.getElementById("CCpressurelevel").style.width=barWidth+"%"),"CC"==e&&parseFloat(15&data0)==MIDI_CONFIG_TOOL_CHANNEL-1||(++consoleEntries<301?(document.getElementById("console").innerHTML+=e+" "+(1+(15&data0))+" "+data1+" "+event,document.getElementById("console").innerHTML+="<br>"):301==consoleEntries&&(document.getElementById("console").innerHTML+="max lines reached"),(pitchcents=document.getElementById("console")).scrollTop=pitchcents.scrollHeight),240&data0){case 144:if(0!=data2)return noteOn(data1),notePlaying=data1,void(document.getElementById("tinyConsole").value=noteNames[data1-1]+" "+data1);case 128:return noteOff(data1),void(notePlaying==data1&&(document.getElementById("tinyConsole").value="",notePlaying=-1));case 176:if(MIDI_DEBUG&&console.log("From WARBL",data1,data2),parseFloat(15&data0)==MIDI_CONFIG_TOOL_CHANNEL-1){if($("#importPreset").removeAttr("disabled"),data1==MIDI_CC_115)for(var byteA=data2,m=0;m<7;m++)1==bit_test(byteA,m)?(document.getElementById("dot"+m).style.backgroundColor="blue",0==m&&(document.getElementById("dot0").style.opacity="0.8")):(document.getElementById("dot"+m).style.backgroundColor="#333",0==m&&(document.getElementById("dot0").style.opacity="0"));if(data1==MIDI_CC_114)for(var n=0;n<2;n++)1==bit_test(data2,n)?document.getElementById("dot"+(7+n)).style.backgroundColor="blue":(1==n&&(document.getElementById("dot"+(7+n)).style.backgroundColor="#181818"),0==n&&(document.getElementById("dot"+(7+n)).style.backgroundColor="#333"));else if(data1==MIDI_CC_102){data2>=MIDI_MAX_CALIB_MSGS_START&&data2<=MIDI_MAX_CALIB_MSGS_END&&(document.getElementById("v"+(data2-MIDI_MAX_CALIB_MSGS_START-1)).innerHTML="MAX",checkMax(data2-MIDI_MAX_CALIB_MSGS_START-1));for(var i=0;i<3;i++)data2==MIDI_FINGERING_PATTERN_MODE_START+i&&(fingeringWrite=i),data2>=MIDI_FINGERING_PATTERN_START&&data2<=MIDI_FINGERING_PATTERN_END&&(fingeringWrite==i&&(document.getElementById("fingeringSelect"+i).value=data2-MIDI_FINGERING_PATTERN_START),updateCells()),data2>=MIDI_CUST_FINGERING_PATTERN_START&&data2<=MIDI_CUST_FINGERING_PATTERN_END&&3.9<version&&(fingeringWrite==i&&(document.getElementById("fingeringSelect"+i).value=data2-MIDI_FINGERING_PATTERN_START),updateCells());data2==MIDI_CURRENT_MODE_START&&(document.getElementById("fingering0").checked=!0,instrument=0,document.getElementById("instrument0").style.display="block",document.getElementById("instrument1").style.display="none",document.getElementById("instrument2").style.display="none",document.getElementById("key0").style.display="block",document.getElementById("key1").style.display="none",document.getElementById("key2").style.display="none",advancedOkay(),pressureOkay(),updateCells(),advancedOkayPB(),okayCCmap(),okayIMUmap(),okayPitchRegistermap(),okayOverride(),backIMU(),backPressure(),handleDefault(),customFingeringOkay()),data2==MIDI_CURRENT_MODE_START+1&&(document.getElementById("fingering1").checked=!0,instrument=1,document.getElementById("instrument0").style.display="none",document.getElementById("instrument1").style.display="block",document.getElementById("instrument2").style.display="none",document.getElementById("key0").style.display="none",document.getElementById("key1").style.display="block",document.getElementById("key2").style.display="none",advancedOkay(),pressureOkay(),updateCells(),advancedOkayPB(),okayCCmap(),okayIMUmap(),okayPitchRegistermap(),okayOverride(),backIMU(),backPressure(),handleDefault(),customFingeringOkay()),data2==MIDI_CURRENT_MODE_START+2&&(document.getElementById("fingering2").checked=!0,instrument=2,document.getElementById("instrument0").style.display="none",document.getElementById("instrument1").style.display="none",document.getElementById("instrument2").style.display="block",document.getElementById("key0").style.display="none",document.getElementById("key1").style.display="none",document.getElementById("key2").style.display="block",advancedOkay(),pressureOkay(),updateCells(),advancedOkayPB(),okayCCmap(),okayIMUmap(),okayPitchRegistermap(),okayOverride(),backIMU(),backPressure(),handleDefault(),customFingeringOkay());for(i=0;i<3;i++)data2==MIDI_DEFAULT_MODE_START+i&&(defaultInstr=i,handleDefault());for(i=0;i<4;i++)data2==MIDI_PB_MODE_START+i&&(document.getElementById("pitchbendradio"+i.toString()).checked=!0,updateCustom(),updateCustom());for(i=0;i<4;i++)data2==MIDI_BREATH_MODE_START+i&&(document.getElementById("sensorradio"+i.toString()).checked=!0,1==i)&&updateExpressionSliderEnableState();data2==MIDI_CC_102_VALUE_121&&(document.getElementById("bellSensor").style.opacity=1,document.getElementById("1").disabled=!1,document.getElementById("2").disabled=!1,document.getElementById("v1").classList.add("sensorValueEnabled")),data2==MIDI_CC_102_VALUE_120&&(document.getElementById("bellSensor").style.opacity=.1,document.getElementById("1").disabled=!0,document.getElementById("2").disabled=!0,document.getElementById("v1").classList.remove("sensorValueEnabled"));for(i=0;i<numberOfGestures;i++)data2==MIDI_GESTURE_START+i&&(buttonRowWrite=i);for(var j=0;j<numberOfGestures;j++)if(buttonRowWrite==j){119==data2&&(document.getElementById("row"+buttonRowWrite).value=19);for(var k=0;k<12;k++)data2==100+k&&version<4&&(document.getElementById("row"+buttonRowWrite).value=k),k<7&&data2==MIDI_ACTION_MIDI_START+k&&(document.getElementById("MIDIrow"+buttonRowWrite).value=k,updateCells())}for(var l=0;l<3;l++)buttonRowWrite==l&&(data2==MIDI_MOMENTARY_OFF&&(document.getElementById("checkbox"+l).checked=!1),data2==MIDI_MOMENTARY_ON)&&(document.getElementById("checkbox"+l).checked=!0)}else if(data1==MIDI_CC_103)document.getElementById("senseDistance").value=0-data2;else if(data1==MIDI_CC_117){document.getElementById("depth").value=data2+1;var output=document.getElementById("demo14");depth.dispatchEvent(new Event("input")),output.innerHTML=data2+1}else if(data1==MIDI_CC_104)jumpFactorWrite=data2;else if(data1==MIDI_CC_109&&data2!=MIDI_CUSTOM_CHARTS_RCVD)jumpFactorWrite=data2+MIDI_CC_109_OFFSET;else if(data1==MIDI_CC_109&&data2==MIDI_CUSTOM_CHARTS_RCVD)document.getElementById("sending").innerHTML="Success!",document.getElementById("WARBL2CustomSuccessOkay").style.display="block",document.getElementById("WARBL2customFingeringFill").value="10",document.getElementById("WARBL2CustomTextArea").value="";else if(data1==MIDI_CC_105&&jumpFactorWrite<=MIDI_PRESS_SELECT_VARS_END){document.getElementById("jumpFactor"+jumpFactorWrite).value=data2,jumpFactorWrite==MIDI_CC_104_VALUE_10&&(document.getElementById("jumpFactor10b").value=data2);for(i=1;i<=MIDI_PRESS_SELECT_VARS_END;i++)(k=document.getElementById("jumpFactor"+i)).dispatchEvent(new Event("input")),i==MIDI_CC_104_VALUE_10&&(k=document.getElementById("jumpFactor10b")).dispatchEvent(new Event("input"))}if(data1==MIDI_CC_105)jumpFactorWrite==MIDI_ED_VARS_START?document.getElementById("checkbox6").checked=data2:jumpFactorWrite==MIDI_ED_VARS_START+1?document.getElementById("expressionDepth").value=data2:jumpFactorWrite==MIDI_ED_VARS_START+2?(document.getElementById("checkbox7").checked=data2,updateCustom()):jumpFactorWrite==MIDI_ED_VARS_START+3?curve[0]=data2:jumpFactorWrite==MIDI_ED_VARS_START+4?document.getElementById("pressureChannel").value=data2:jumpFactorWrite==MIDI_ED_VARS_START+5?document.getElementById("pressureCC").value=data2:jumpFactorWrite==MIDI_ED_VARS_START+6?(inputSliderMin[0]=data2,slider.noUiSlider.set([data2,null])):jumpFactorWrite==MIDI_ED_VARS_START+7?(inputSliderMax[0]=data2,slider.noUiSlider.set([null,data2])):jumpFactorWrite==MIDI_ED_VARS_START+8?(outputSliderMin[0]=data2,slider2.noUiSlider.set([data2,null])):jumpFactorWrite==MIDI_ED_VARS_START+9?(outputSliderMax[0]=data2,slider2.noUiSlider.set([null,data2])):jumpFactorWrite==MIDI_ED_VARS_START+10?document.getElementById("dronesOnCommand").value=data2:jumpFactorWrite==MIDI_ED_VARS_START+11?document.getElementById("dronesOnChannel").value=data2:jumpFactorWrite==MIDI_ED_VARS_START+12?document.getElementById("dronesOnByte2").value=data2:jumpFactorWrite==MIDI_ED_VARS_START+13?document.getElementById("dronesOnByte3").value=data2:jumpFactorWrite==MIDI_ED_VARS_START+14?document.getElementById("dronesOffCommand").value=data2:jumpFactorWrite==MIDI_ED_VARS_START+15?document.getElementById("dronesOffChannel").value=data2:jumpFactorWrite==MIDI_ED_VARS_START+16?document.getElementById("dronesOffByte2").value=data2:jumpFactorWrite==MIDI_ED_VARS_START+17?document.getElementById("dronesOffByte3").value=data2:jumpFactorWrite==MIDI_ED_VARS_START+18&&0==data2?document.getElementById("dronesRadio0").checked=!0:jumpFactorWrite==MIDI_ED_VARS_START+18&&1==data2?document.getElementById("dronesRadio1").checked=!0:jumpFactorWrite==MIDI_ED_VARS_START+18&&2==data2?document.getElementById("dronesRadio2").checked=!0:jumpFactorWrite==MIDI_ED_VARS_START+18&&3==data2?document.getElementById("dronesRadio3").checked=!0:jumpFactorWrite==MIDI_ED_VARS_START+19?lsb=data2:jumpFactorWrite==MIDI_ED_VARS_START+20?(p=(x=24*((x=parseInt(data2<<7|lsb))-100)/900).toFixed(1),p=Math.min(Math.max(p,0),24),document.getElementById("dronesPressureInput").value=p):jumpFactorWrite==MIDI_LEARNED_PRESS_LSB?lsb=data2:jumpFactorWrite==MIDI_LEARNED_PRESS_MSB?(p=(x=24*((x=parseInt(data2<<7|lsb))-100)/900).toFixed(1),p=Math.min(Math.max(p,0),24),document.getElementById("octavePressureInput").value=p):jumpFactorWrite==MIDI_SWITCHES_VARS_START+3?document.getElementById("checkbox9").checked=data2:jumpFactorWrite==MIDI_SWITCHES_VARS_START+4?(document.getElementById("checkbox5").checked=data2,updateCustom()):jumpFactorWrite==MIDI_SWITCHES_VARS_START+2?document.getElementById("checkbox3").checked=data2:jumpFactorWrite==MIDI_SWITCHES_VARS_START?(updateSelected(),0==(document.getElementById("checkbox4").checked=data2)?document.getElementById("bagBreath0").checked=!0:document.getElementById("bagBreath1").checked=!0):jumpFactorWrite==MIDI_SWITCHES_VARS_START+1?document.getElementById("checkbox8").checked=data2:jumpFactorWrite==MIDI_SWITCHES_VARS_START+5?document.getElementById("checkbox10").checked=data2:jumpFactorWrite==MIDI_SWITCHES_VARS_START+6?(document.getElementById("checkbox11").checked=1&data2,document.getElementById("checkbox13").checked=2&data2):jumpFactorWrite==MIDI_SWITCHES_VARS_START+7?document.getElementById("checkbox12").checked=data2:jumpFactorWrite==MIDI_SWITCHES_VARS_START+8?document.getElementById("checkbox14").checked=data2:jumpFactorWrite==MIDI_SWITCHES_VARS_START+9?document.getElementById("checkbox15").checked=data2:jumpFactorWrite==MIDI_SWITCHES_VARS_START+10?(document.getElementById("checkbox16").checked=data2,document.getElementById("overrideExprCheck").checked=data2,updateExpressionSliderEnableState()):jumpFactorWrite==MIDI_SWITCHES_VARS_START+11?document.getElementById("checkbox17").checked=data2:jumpFactorWrite==MIDI_SWITCHES_VARS_START+12?(document.getElementById("checkbox18").checked=data2,updateCustom()):jumpFactorWrite==MIDI_SWITCHES_VARS_START+13?(document.getElementById("cbDoubleClick").checked=data2,updateDoubleClick()):jumpFactorWrite==MIDI_BEND_RANGE?document.getElementById("midiBendRange").value=data2:jumpFactorWrite==MIDI_MIDI_CHANNEL?document.getElementById("noteChannel").value=data2:jumpFactorWrite==MIDI_ED_VARS2_START?(inputSliderMin[1]=data2,slider.noUiSlider.set([data2,null])):jumpFactorWrite==MIDI_ED_VARS2_START+1?(inputSliderMax[1]=data2,slider.noUiSlider.set([null,data2])):jumpFactorWrite==MIDI_ED_VARS2_START+2?(outputSliderMin[1]=data2,slider2.noUiSlider.set([data2,null])):jumpFactorWrite==MIDI_ED_VARS2_START+3?(outputSliderMax[1]=data2,slider2.noUiSlider.set([null,data2])):jumpFactorWrite==MIDI_ED_VARS2_START+4?(inputSliderMin[2]=data2,slider.noUiSlider.set([data2,null])):jumpFactorWrite==MIDI_ED_VARS2_START+5?(inputSliderMax[2]=data2,slider.noUiSlider.set([null,data2])):jumpFactorWrite==MIDI_ED_VARS2_START+6?(outputSliderMin[2]=data2,slider2.noUiSlider.set([data2,null])):jumpFactorWrite==MIDI_ED_VARS2_START+7?(outputSliderMax[2]=data2,slider2.noUiSlider.set([null,data2])):jumpFactorWrite==MIDI_ED_VARS2_START+8?(inputSliderMin[3]=data2,slider.noUiSlider.set([data2,null])):jumpFactorWrite==MIDI_ED_VARS2_START+9?(inputSliderMax[3]=data2,slider.noUiSlider.set([null,data2])):jumpFactorWrite==MIDI_ED_VARS2_START+10?(outputSliderMin[3]=data2,slider2.noUiSlider.set([data2,null])):jumpFactorWrite==MIDI_ED_VARS2_START+11?(outputSliderMax[3]=data2,slider2.noUiSlider.set([null,data2])):jumpFactorWrite==MIDI_ED_VARS2_START+12?curve[1]=data2:jumpFactorWrite==MIDI_ED_VARS2_START+13?curve[2]=data2:jumpFactorWrite==MIDI_ED_VARS2_START+14?curve[3]=data2:jumpFactorWrite==MIDI_ED_VARS2_START+15?exprlowsliderHandleSetting=data2:jumpFactorWrite==MIDI_ED_VARS2_START+16?version<4.3?exprlowslider.noUiSlider.set([exprlowsliderHandleSetting,data2]):exprhighsliderHandleSetting=data2:version<4&&jumpFactorWrite>=MIDI_CC_104_VALUE_87&&jumpFactorWrite<=MIDI_ED_VARS2_END?document.getElementById("fingeringInput"+(jumpFactorWrite-86)).value=data2:jumpFactorWrite==MIDI_ED_VARS2_START+17?(document.getElementById("slidelimit").value=data2,output=document.getElementById("demo18"),depth.dispatchEvent(new Event("input")),output.innerHTML=data2):jumpFactorWrite==MIDI_ED_VARS2_START+18?4.3<=version&&exprlowslider.noUiSlider.set([exprlowsliderHandleSetting,data2]):jumpFactorWrite==MIDI_ED_VARS2_START+19?exprhighslider.noUiSlider.set([data2,exprhighsliderHandleSetting]):jumpFactorWrite==MIDI_ED_VARS2_START+20?exprlowbendslider.noUiSlider.set([data2]):jumpFactorWrite==MIDI_ED_VARS2_START+21?exprhighbendslider.noUiSlider.set([data2]):jumpFactorWrite==MIDI_ED_VARS2_START+22?(document.getElementById("exprfixedcenterslider").value=data2,updateExpressionCenterPressureLabel()):jumpFactorWrite==MIDI_ED_VARS2_START+23?document.getElementById("clampExprCheck").checked=data2:jumpFactorWrite==MIDI_ED_VARS2_START+24?(document.getElementById("exprcurvelowslider").value=data2,updateExpressionCurveLabels()):jumpFactorWrite==MIDI_ED_VARS2_START+25?(document.getElementById("exprcurvehighslider").value=data2,updateExpressionCurveLabels()):jumpFactorWrite==MIDI_ED_VARS2_START+26?document.getElementById("pressureMPEplusCheck").checked=0<data2:jumpFactorWrite>=MIDI_CC_109_OFFSET&&(jumpFactorWrite==MIDI_CC_109_OFFSET?document.getElementById("checkbox20").checked=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+1?document.getElementById("checkbox21").checked=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+2?document.getElementById("checkbox22").checked=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+3?center[1]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+4?center[3]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+5?inputSliderMin[4]=5*data2-90:jumpFactorWrite==MIDI_CC_109_OFFSET+6?inputSliderMax[4]=5*data2-90:jumpFactorWrite==MIDI_CC_109_OFFSET+7?outputSliderMin[4]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+8?outputSliderMax[4]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+9?inputSliderMin[5]=5*data2-90:jumpFactorWrite==MIDI_CC_109_OFFSET+10?inputSliderMax[5]=5*data2-90:jumpFactorWrite==MIDI_CC_109_OFFSET+11?outputSliderMin[5]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+12?outputSliderMax[5]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+13?inputSliderMin[6]=5*data2-90:jumpFactorWrite==MIDI_CC_109_OFFSET+14?inputSliderMax[6]=5*data2-90:jumpFactorWrite==MIDI_CC_109_OFFSET+15?outputSliderMin[6]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+16?outputSliderMax[6]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+17?IMUchannel[0]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+18?IMUchannel[1]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+19?IMUchannel[2]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+20?IMUnumber[0]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+21?IMUnumber[1]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+22?IMUnumber[2]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+23?document.getElementById("checkbox25").checked=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+24?document.getElementById("checkbox24").checked=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+25?(document.getElementById("autoCenterYawInterval").value=data2,output=document.getElementById("demo16"),autoCenterYawInterval.dispatchEvent(new Event("input")),output.innerHTML=data2/4):jumpFactorWrite==MIDI_CC_109_OFFSET+26?document.getElementById("checkbox27").checked=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+27?(document.getElementById("shakeDepth").value=data2,output=document.getElementById("demo15"),shakeDepth.dispatchEvent(new Event("input")),output.innerHTML=data2):jumpFactorWrite==MIDI_CC_109_OFFSET+28?slider6.noUiSlider.set([5*data2-90,null]):jumpFactorWrite==MIDI_CC_109_OFFSET+29?slider6.noUiSlider.set([null,5*data2-90]):jumpFactorWrite==MIDI_CC_109_OFFSET+30?(document.getElementById("pitchRegisterNumber").value=data2,output=document.getElementById("demo17"),pitchRegisterNumber.dispatchEvent(new Event("input")),output.innerHTML=data2):jumpFactorWrite==MIDI_CC_109_OFFSET+31?document.getElementById("shakeVibModeCommand").value=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+33?(pressureShakeMod[0]=data2,0==mapSelection&&(document.getElementById("pressureShakeModCheck").value=data2)):jumpFactorWrite==MIDI_CC_109_OFFSET+34?(pressureShakeMod[2]=data2,2==mapSelection&&(document.getElementById("pressureShakeModCheck").value=data2)):jumpFactorWrite==MIDI_CC_109_OFFSET+35?(pressureShakeMod[3]=data2,3==mapSelection&&(document.getElementById("pressureShakeModCheck").value=data2)):jumpFactorWrite==MIDI_CC_109_OFFSET+36?pressureShakeDepth[0]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+37?pressureShakeDepth[2]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+38?pressureShakeDepth[3]=data2:jumpFactorWrite==MIDI_CC_109_OFFSET+MIDI_CC_109_VALUE_127&&((gesture=document.getElementById("gestureLabel"+data2)).style.color="#f7c839",gesture.style.scale="1.1",setTimeout(function(){contract(gesture)},150)));else if(data1==MIDI_CC_109&&data2<=MIDI_IMU_SETTINGS_END)jumpFactorWrite=data2+MIDI_CC_109_OFFSET;else if(data1==MIDI_CC_110){version=data2,0!=previousVersion&&version!=previousVersion&&document.location.reload(!1),communicationMode=!0,40<=(previousVersion=version)&&currentVersion<=version||version<40&&currentVersionOriginal<=version?(document.getElementById("current").innerHTML="Your firmware is up to date.",document.getElementById("current").style.left="710px",document.getElementById("current").style.visibility="visible",document.getElementById("status").style.visibility="hidden",document.getElementById("current").style.color="#f7c839"):(document.getElementById("current").innerHTML="There is a firmware update available.",document.getElementById("current").style.left="690px",document.getElementById("current").style.visibility="visible",document.getElementById("status").style.visibility="hidden",document.getElementById("current").style.color="#F78339");n=(version/=10).toFixed(1);if(document.getElementById("version").innerHTML=n,document.getElementById("version").style.color="#f7c839",document.getElementById("status").innerHTML="WARBL Connected.",document.getElementById("status").style.color="#f7c839",2<version&&(document.getElementById("connect").innerHTML="Disconnect"),version<4.3&&(document.getElementById("exprOutputBendLevelContainer").style.display="none",document.getElementById("advancedOkayPB").style.top="275px",document.getElementById("advancedOkayPB").style.left="205px"),version<4.2&&(document.getElementById("switchDoubleClick").style.display="none",document.getElementById("doubleClickLabel").style.display="none"),version<3.9){numberOfGestures=8;for(var element of document.getElementsByClassName("WARBL2Elements"))element.style.display="none";for(document.getElementById("box9").style.display="none",document.getElementById("expressionPressureBox").style.display="block",document.getElementById("demo18").style.display="none",document.getElementById("slideLimitContainer").style.display="none",document.getElementById("slidelimitlabel").style.display="none",document.getElementById("advancedPBsliders").style.top="50px",document.getElementById("backPressureButton").style.display="none",document.getElementById("fingeringSelect0").options[22].disabled=!0,document.getElementById("fingeringSelect0").options[23].disabled=!0,document.getElementById("fingeringSelect0").options[24].disabled=!0,document.getElementById("fingeringSelect0").options[25].disabled=!0,document.getElementById("fingeringSelect1").options[22].disabled=!0,document.getElementById("fingeringSelect1").options[23].disabled=!0,document.getElementById("fingeringSelect1").options[24].disabled=!0,document.getElementById("fingeringSelect1").options[25].disabled=!0,document.getElementById("fingeringSelect2").options[22].disabled=!0,document.getElementById("fingeringSelect2").options[23].disabled=!0,document.getElementById("fingeringSelect2").options[24].disabled=!0,document.getElementById("fingeringSelect2").options[25].disabled=!0,document.getElementById("keyLabel").innerHTML="Key",document.getElementById("keyLabel").style.left="305px",i=0;i<37;++i)document.getElementsByName("keySelect")[0].options[i].innerHTML=noteNamesforKeySelect[i],document.getElementsByName("keySelect")[1].options[i].innerHTML=noteNamesforKeySelect[i],document.getElementsByName("keySelect")[2].options[i].innerHTML=noteNamesforKeySelect[i];for(i=0;i<document.getElementById("fingeringSelect0").length;++i)"19"==document.getElementById("fingeringSelect0").options[i].value&&(a=1);for(1!=a&&(x=document.getElementById("fingeringSelect0"),(option=document.createElement("option")).text="Custom (original WARBL)",option.value=19,x.add(option),y=document.getElementById("fingeringSelect1"),(option=document.createElement("option")).text="Custom (original WARBL)",option.value=19,y.add(option),z=document.getElementById("fingeringSelect2"),(option=document.createElement("option")).text="Custom (original WARBL)",option.value=19,z.add(option)),i=0;i<8;++i)document.getElementById("row"+i).options[13].disabled=!0,document.getElementById("row"+i).options[14].disabled=!0,document.getElementById("row"+i).options[15].disabled=!0,document.getElementById("autoCal"+i).value="19";document.getElementById("WARBL2Settings").style.display="none",document.getElementById("bellSensor").style.display="block",document.getElementById("dot0").style.left="935px",document.getElementById("1").style.left="900px",document.getElementById("2").style.left="900px",document.getElementById("v1").style.left="900px"}else{for(i=0;i<8;++i)document.getElementById("row"+i).options[13].disabled=!1,document.getElementById("row"+i).options[14].disabled=!1,document.getElementById("row"+i).options[15].disabled=!1,document.getElementById("autoCal"+i).value="12";document.getElementById("WARBL2Settings").style.display="block",document.getElementById("bellSensor").style.display="none",document.getElementById("dot0").style.left="870px",document.getElementById("1").style.left="870px",document.getElementById("2").style.left="870px",document.getElementById("v1").style.left="870px"}if(version<2.2&&(document.getElementById("fingeringSelect0").options[20].disabled=!0,document.getElementById("fingeringSelect1").options[20].disabled=!0,document.getElementById("fingeringSelect2").options[20].disabled=!0,document.getElementById("fingeringSelect0").options[21].disabled=!0,document.getElementById("fingeringSelect1").options[21].disabled=!0,document.getElementById("fingeringSelect2").options[21].disabled=!0),version<2.1&&(document.getElementById("jumpfactor10Container").style.visibility="visible",document.getElementById("jumpfactor4Container").style.visibility="visible",document.getElementById("jumpValue4").style.visibility="visible",document.getElementById("jumpValue10").style.visibility="visible",document.getElementById("jumpfactor10bContainer").style.visibility="hidden",document.getElementById("jumpLabel8").style.visibility="hidden",document.getElementById("jumpLabel5").style.visibility="visible",document.getElementById("demo10b").style.visibility="hidden",document.getElementById("jumpLabel4").innerHTML="Jump",document.getElementById("jumpfactor5Container").style.top="240px",document.getElementById("jumpfactor6Container").style.top="275px",document.getElementById("jumpfactor11Container").style.top="240px",document.getElementById("jumpfactor12Container").style.top="275px",document.getElementById("jumplabel6").style.top="242px",document.getElementById("jumplabel7").style.top="277px",document.getElementById("jumpValue5").style.top="225px",document.getElementById("jumpValue6").style.top="260px",document.getElementById("jumpValue11").style.top="225px",document.getElementById("jumpValue12").style.top="260px",document.getElementById("jumpFactor3").min="1",document.getElementById("jumpFactor3").max="175",document.getElementById("jumpFactor9").min="1",document.getElementById("jumpFactor9").max="175",document.getElementById("jumpFactor5").min="1",document.getElementById("jumpFactor6").min="1",document.getElementById("jumpFactor11").min="1",document.getElementById("jumpFactor12").min="1",document.getElementById("breathSlider").classList.remove("slider2"),document.getElementById("breathSlider").classList.add("slider"),document.getElementById("pressureGroup").style.top="0px",document.getElementById("ventedLabel").style.visibility="visible",document.getElementById("switch4").style.visibility="visible",document.getElementById("radioGroup10").style.visibility="hidden",document.getElementById("jumplabel10").innerHTML="Closed",document.getElementById("jumplabel11").innerHTML="Vented",document.getElementById("jumplabel10").style.left="170px",document.getElementById("jumplabel11").style.left="340px",document.getElementById("advancedSliders").style.top="-125px",document.getElementById("selectedSettings").style.visibility="hidden",document.getElementById("fingeringSelect0").options[19].disabled=!0,document.getElementById("fingeringSelect1").options[19].disabled=!0,document.getElementById("fingeringSelect2").options[19].disabled=!0,document.getElementById("fingeringSelect0").options[20].disabled=!0,document.getElementById("fingeringSelect1").options[20].disabled=!0,document.getElementById("fingeringSelect2").options[20].disabled=!0),version<2&&(document.getElementById("overrideExpression").disabled=!0,document.getElementById("polyMapButton").disabled=!0,document.getElementById("velocityMapButton").disabled=!0,document.getElementById("aftertouchMapButton").disabled=!0,document.getElementById("noteChannel").disabled=!0,document.getElementById("checkbox13").disabled=!0,document.getElementById("switch13").style.cursor="default",document.getElementById("advancedPBbutton").disabled=!0,document.getElementById("pitchbendradio3").disabled=!0,document.getElementById("configureCustomFingering").disabled=!0),version<1.5){document.getElementById("fingeringSelect0").options[2].disabled=!0,document.getElementById("fingeringSelect1").options[2].disabled=!0,document.getElementById("fingeringSelect2").options[2].disabled=!0,document.getElementById("checkbox10").disabled=!0;for(i=0;i<8;i++)document.getElementById("row"+i).options[7].disabled=!0,document.getElementById("row"+i).options[8].disabled=!0}if(version<1.6){for(i=0;i<8;i++)document.getElementById("row"+i).options[12].disabled=!0;document.getElementById("fingeringSelect0").options[6].disabled=!0,document.getElementById("fingeringSelect1").options[6].disabled=!0,document.getElementById("fingeringSelect2").options[6].disabled=!0,document.getElementById("fingeringSelect0").options[11].disabled=!0,document.getElementById("fingeringSelect1").options[11].disabled=!0,document.getElementById("fingeringSelect2").options[11].disabled=!0}version<1.7&&(document.getElementById("checkbox11").disabled=!0,document.getElementById("checkbox12").disabled=!0,document.getElementById("fingeringSelect0").options[12].disabled=!0,document.getElementById("fingeringSelect1").options[12].disabled=!0,document.getElementById("fingeringSelect2").options[12].disabled=!0,document.getElementById("fingeringSelect0").options[13].disabled=!0,document.getElementById("fingeringSelect1").options[13].disabled=!0,document.getElementById("fingeringSelect2").options[13].disabled=!0,document.getElementById("fingeringSelect0").options[14].disabled=!0,document.getElementById("fingeringSelect1").options[14].disabled=!0,document.getElementById("fingeringSelect2").options[14].disabled=!0,document.getElementById("fingeringSelect0").options[15].disabled=!0,document.getElementById("fingeringSelect1").options[15].disabled=!0,document.getElementById("fingeringSelect2").options[15].disabled=!0),version<2&&(document.getElementById("fingeringSelect0").options[16].disabled=!0,document.getElementById("fingeringSelect1").options[16].disabled=!0,document.getElementById("fingeringSelect2").options[16].disabled=!0,document.getElementById("fingeringSelect0").options[17].disabled=!0,document.getElementById("fingeringSelect1").options[17].disabled=!0,document.getElementById("fingeringSelect2").options[17].disabled=!0,document.getElementById("fingeringSelect0").options[18].disabled=!0,document.getElementById("fingeringSelect1").options[18].disabled=!0,document.getElementById("fingeringSelect2").options[18].disabled=!0)}else data1==MIDI_CC_111?document.getElementById("keySelect0").value=data2:data1==MIDI_CC_112?document.getElementById("keySelect1").value=data2:data1==MIDI_CC_113?document.getElementById("keySelect2").value=data2:data1==MIDI_CC_116?lsb=data2:data1==MIDI_CC_118&&(x=24*((output=parseInt(data2<<7|lsb))-100)/900,p=Math.min(Math.max(p,0),24),(p=x.toFixed(1))<.2&&(p=0),gPressureGraphEnabled?capturePressure(p):(document.getElementById("pressure").innerHTML=p,document.getElementById("pressure1").innerHTML=p,"block"==document.getElementById("box8").style.display&&(barWidth=p/24*100,pressbar=document.getElementById("exprInputPressureLevel"),100<barWidth?(barWidth=101,pressbar.style.background="var(--gauge-over-color)"):pressbar.style.background="var(--gauge-color)",pressbar.style.width=barWidth+"%",pressbar=!1,.5<(centsBarWidth=(output=calculateOutExprBendFromInput(output))/256)?(centsBarWidth=.51,pressbar=!0):centsBarWidth<-.5&&(centsBarWidth=-.51,pressbar=!0),bendbar=document.getElementById("exprOutputBendLevel"),iscenter=!1,Math.abs(output)<.5?(bendbar.style.left="49%",bendbar.style.width="2%",iscenter=!0):0<output?(bendbar.style.left="50%",bendbar.style.width=(100*centsBarWidth).toFixed(0)+"%"):(bendbar.style.left=(50+100*centsBarWidth).toFixed(0)+"%",bendbar.style.width=(100*-centsBarWidth).toFixed(0)+"%"),bendbar.style.background=iscenter?"var(--gauge-center-color)":pressbar?"var(--gauge-over-color)":"var(--gauge-color)")));for(var a,y,z,option,p,x,i=0;i<numberOfGestures;i++)buttonRowWrite==i&&(data1==MIDI_CC_106&&data2<=MIDI_ACTION_MIDI_CHANNEL_END&&(document.getElementById("channel"+buttonRowWrite).value=data2),data1==MIDI_CC_107&&(document.getElementById("byte2_"+buttonRowWrite).value=data2),data1==MIDI_CC_108)&&(document.getElementById("byte3_"+buttonRowWrite).value=data2);if(data1==MIDI_CC_106&&data2>MIDI_ACTION_MIDI_CHANNEL_END){if(data2>=MIDI_ENA_VIBRATO_HOLES_START&&data2<=MIDI_ENA_VIBRATO_HOLES_END&&(document.getElementById("vibratoCheckbox"+(data2-MIDI_ENA_VIBRATO_HOLES_START)).checked=!1),data2>=MIDI_DIS_VIBRATO_HOLES_START&&data2<=MIDI_DIS_VIBRATO_HOLES_END&&(document.getElementById("vibratoCheckbox"+(data2-MIDI_DIS_VIBRATO_HOLES_START)).checked=!0),data2==MIDI_STARTUP_CALIB&&(document.getElementById("calibrateradio0").checked=!0),data2==MIDI_USE_LEARNED_CALIB&&(document.getElementById("calibrateradio1").checked=!0),data2==MIDI_CC_106_VALUE_53){for(i=0;i<document.getElementById("fingeringSelect0").length;++i)"9"==document.getElementById("fingeringSelect0").options[i].value&&(a=1);1!=a&&(x=document.getElementById("fingeringSelect0"),(option=document.createElement("option")).text="Uilleann regulators",option.value=9,x.add(option),y=document.getElementById("fingeringSelect1"),(option=document.createElement("option")).text="Uilleann regulators",option.value=9,y.add(option),z=document.getElementById("fingeringSelect2"),(option=document.createElement("option")).text="Uilleann regulators",option.value=9,z.add(option))}if(data2>=MIDI_WARBL2_SETTINGS_START&&data2<=MIDI_WARBL2_SETTINGS_END&&(WARBL2SettingsReceive=data2-MIDI_WARBL2_SETTINGS_START),data2>=MIDI_BUTTON_ACTIONS_START&&3.9<version)for(j=0;j<numberOfGestures;j++)if(buttonRowWrite==j)for(k=0;k<27;k++)data2==MIDI_BUTTON_ACTIONS_START+k&&(document.getElementById("row"+buttonRowWrite).value=k)}data1==MIDI_CC_119&&(0==WARBL2SettingsReceive?document.getElementById("WARBL2Radio"+data2).checked=!0:1==WARBL2SettingsReceive?document.getElementById("checkbox19").checked=data2:2==WARBL2SettingsReceive?(document.getElementById("poweroffSlider").value=data2,document.getElementById("poweroffValue").innerHTML=data2):15==WARBL2SettingsReceive?(p=(x=(data2+50)/100).toFixed(2),document.getElementById("voltage").innerHTML=p):16==WARBL2SettingsReceive?(0==data2&&(document.getElementById("charging").style.display="none"),1==data2&&(document.getElementById("charging").style.display="block"),2==data2&&(document.getElementById("chargingLabel").innerHTML="Battery fault detected",document.getElementById("chargingLabel").style.display="block",setTimeout(turnOffFault,2e4))):17==WARBL2SettingsReceive?connIntvlLSB=data2:18==WARBL2SettingsReceive?(x=parseInt(data2<<7|connIntvlLSB),x/=100,0==(x=parseFloat(x.toFixed(4)))?(document.getElementById("connLabel").innerHTML="BLE not connected",document.getElementById("connLabel").style.left="95px"):(document.getElementById("connLabel").innerHTML="BLE connected at "+x+" mS interval",document.getElementById("connLabel").style.left="55px")):19==WARBL2SettingsReceive&&(output=data2,document.getElementById("percentage").innerHTML=output+"%",87<output?(document.getElementById("battery100").style.display="block",document.getElementById("battery75").style.display="none",document.getElementById("battery50").style.display="none",document.getElementById("battery25").style.display="none",document.getElementById("battery0").style.display="none"):63<output?(document.getElementById("battery100").style.display="none",document.getElementById("battery75").style.display="block",document.getElementById("battery50").style.display="none",document.getElementById("battery25").style.display="none",document.getElementById("battery0").style.display="none"):37<output?(document.getElementById("battery100").style.display="none",document.getElementById("battery75").style.display="none",document.getElementById("battery50").style.display="block",document.getElementById("battery25").style.display="none",document.getElementById("battery0").style.display="none"):13<output?(document.getElementById("battery100").style.display="none",document.getElementById("battery75").style.display="none",document.getElementById("battery50").style.display="none",document.getElementById("battery25").style.display="block",document.getElementById("battery0").style.display="none"):(document.getElementById("battery100").style.display="none",document.getElementById("battery75").style.display="none",document.getElementById("battery50").style.display="none",document.getElementById("battery25").style.display="none",document.getElementById("battery0").style.display="block")))}}updateCells()}else console.log("Ignoring midi message from unconnected device")}function bit_test(num,bit){return(num>>bit)%2!=0}function contract(gesture){gesture.style.scale="1",gesture.style.color="#c3c0c0"}function turnOffFault(){document.getElementById("chargingLabel").style.display="none"}function sendCustomFingeringFill(){modalclose(22);var selection=document.getElementById("customFingeringFill").value;for(i=1;i<12;++i){document.getElementById("fingeringInput"+i).value=customFingeringFills[selection][i-1];var x=document.getElementById("fingeringInput"+i).value;sendToWARBL(MIDI_CC_104,86+i),sendToWARBL(MIDI_CC_105,x)}document.getElementById("customFingeringFill").value="12"}function sendWARBL2CustomFingeringFill(){modalclose(24),modal(25);for(var selection=document.getElementById("WARBL2customFingeringFill").value,selection=parseFloat(selection),lines=document.getElementById("WARBL2CustomTextArea").value.split("\n"),j=0;j<lines.length;j++){if(257!=lines.length&&256!=lines.length)return modalclose(25),alert("There must be 256 MIDI notes. Please try again."),document.getElementById("WARBL2customFingeringFill").value="10",void(document.getElementById("WARBL2CustomTextArea").value="");if(lines[j]<0||127<lines[j]||isNaN(lines[j]))return modalclose(25),alert("Each MIDI note must be in the range of 0 to 127."),document.getElementById("WARBL2customFingeringFill").value="10",void(document.getElementById("WARBL2CustomTextArea").value="")}sendToWARBL(MIDI_CC_109,selection+MIDI_CUSTOM_CHARTS_START);for(var k=0;k<256;k++)sendToWARBL(MIDI_CC_105,lines[k])}function fingeringInput(input,selection){var x=document.getElementById("fingeringInput"+input).value;sendToWARBL(MIDI_CC_104,86+input),sendToWARBL(MIDI_CC_105,x)}function sendFingeringSelect(row,selection){var key;selection=parseFloat(selection),updateCells(),updateCustom(),blink(1),key=version<4?2==selection?8:3==selection?3:5==selection||13==selection?125:6==selection?122:8==selection?125:11==selection?113:12==selection||14==selection||15==selection?123:17==selection||18==selection?2:20==selection?123:22==selection?5:0:0,document.getElementById("keySelect"+row).value=key,sendToWARBL(MIDI_CC_102,MIDI_FINGERING_PATTERN_MODE_START+row),sendToWARBL(MIDI_CC_102,MIDI_FINGERING_PATTERN_START+selection),sendKey(row,key)}function defaultInstrument(){defaultInstr=instrument,handleDefault(),sendToWARBL(MIDI_CC_102,MIDI_DEFAULT_MODE_START)}function handleDefault(){(1.6<version||"Unknown"==version)&&(0!=defaultInstr&&(document.getElementById("instrument1Label").innerHTML="Instrument 1:"),1!=defaultInstr&&(document.getElementById("instrument2Label").innerHTML="Instrument 2:"),2!=defaultInstr&&(document.getElementById("instrument3Label").innerHTML="Instrument 3:"),0==defaultInstr&&(document.getElementById("instrument1Label").innerHTML="Instrument 1 (default):"),1==defaultInstr&&(document.getElementById("instrument2Label").innerHTML="Instrument 2 (default):"),2==defaultInstr&&(document.getElementById("instrument3Label").innerHTML="Instrument 3 (default):"),defaultInstr!=instrument?(document.getElementById("defaultInstrument").style.visibility="visible",0==instrument&&(document.getElementById("defaultInstrument").style.left="130px"),1==instrument&&(document.getElementById("defaultInstrument").style.left="430px"),2==instrument&&(document.getElementById("defaultInstrument").style.left="730px")):document.getElementById("defaultInstrument").style.visibility="hidden")}function sendKey(row,selection){selection=parseFloat(selection),row=parseFloat(row),updateCells(),blink(1),sendToWARBL(MIDI_CC_111+row,selection)}function sendFingeringRadio(tab){instrument=tab,updateCustom(),advancedOkay(),pressureOkay(),okayCCmap(),okayIMUmap(),okayPitchRegistermap(),okayOverride(),backIMU(),backPressure(),handleDefault(),customFingeringOkay(),0==tab?(document.getElementById("instrument0").style.display="block",document.getElementById("instrument1").style.display="none",document.getElementById("instrument2").style.display="none",document.getElementById("key0").style.display="block",document.getElementById("key1").style.display="none",document.getElementById("key2").style.display="none",sendToWARBL(MIDI_CC_102,MIDI_CURRENT_MODE_START)):1==tab?(document.getElementById("instrument0").style.display="none",document.getElementById("instrument1").style.display="block",document.getElementById("instrument2").style.display="none",document.getElementById("key0").style.display="none",document.getElementById("key1").style.display="block",document.getElementById("key2").style.display="none",blink(2),sendToWARBL(MIDI_CC_102,MIDI_CURRENT_MODE_START+1)):2==tab&&(document.getElementById("instrument0").style.display="none",document.getElementById("instrument1").style.display="none",document.getElementById("instrument2").style.display="block",document.getElementById("key0").style.display="none",document.getElementById("key1").style.display="none",document.getElementById("key2").style.display="block",blink(3),sendToWARBL(MIDI_CC_102,MIDI_CURRENT_MODE_START+2)),updateCells(),updateCustom()}function updateSelected(){1==document.getElementById("bagBreath0").checked?document.getElementById("selectedSettings").style.left="125px":document.getElementById("selectedSettings").style.left="285px",document.getElementById("selectedSettings").style.width="162px"}function sendSenseDistance(selection){blink(1),selection=parseFloat(selection),x=0-parseFloat(selection),sendToWARBL(MIDI_CC_103,x)}function sendDepth(selection){blink(1),selection=parseFloat(selection),sendToWARBL(MIDI_CC_117,selection)}function sendSlideLimit(selection){blink(1),selection=parseFloat(selection),sendToWARBL(MIDI_CC_104,MIDI_SLIDE_LIMIT_MAX),sendToWARBL(MIDI_CC_105,selection)}function sendShakeDepth(selection){blink(1),selection=parseFloat(selection),sendToWARBL(MIDI_CC_109,MIDI_Y_PITCHBEND_DEPTH),sendToWARBL(MIDI_CC_105,selection)}function sendShakeVibModeOnCommand(selection){blink(1),selection=parseFloat(selection),sendToWARBL(MIDI_CC_109,MIDI_Y_PITCHBEND_MODE),sendToWARBL(MIDI_CC_105,selection)}function sendAutoCenterYawInterval(selection){blink(1),selection=parseFloat(selection),sendToWARBL(MIDI_CC_109,MIDI_AUTOCENTER_YAW_INTERVAL),sendToWARBL(MIDI_CC_105,selection)}function sendpitchRegisterNumber(selection){blink(1),selection=parseFloat(selection),sendToWARBL(MIDI_CC_109,MIDI_PITCH_REGISTER_NUMBER),sendToWARBL(MIDI_CC_105,selection)}function sendExpressionDepth(selection){blink(1),selection=parseFloat(selection),sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_DEPTH),sendToWARBL(MIDI_CC_105,selection)}function sendExpressionCenterPressure(selection){blink(1),selection=parseFloat(selection),sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_FIXED_CENTER_PRESSURE),sendToWARBL(MIDI_CC_105,selection),updateExpressionCenterPressureLabel()}function sendExpressionCurveLow(value){blink(1),selection=parseFloat(value),sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_CURVE_LOW),sendToWARBL(MIDI_CC_105,selection),updateExpressionCurveLabels()}function sendExpressionCurveHigh(value){blink(1),selection=parseFloat(value),sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_CURVE_HIGH),sendToWARBL(MIDI_CC_105,selection),updateExpressionCurveLabels()}function resetExpressionCurveLow(){sendExpressionCurveLow(document.getElementById("exprcurvelowslider").value=64)}function resetExpressionCurveHigh(){sendExpressionCurveHigh(document.getElementById("exprcurvehighslider").value=64)}function sendPressureAftertouchMPEplus(value){blink(1),sendToWARBL(MIDI_CC_104,MIDI_AFTERTOUCH_MPEPLUS),sendToWARBL(MIDI_CC_105,value?1:0)}function sendClampExpr(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_OUT_CLAMP),sendToWARBL(MIDI_CC_105,selection)}function sendCurveRadio(selection){blink(1),selection=parseFloat(selection),curve[mapSelection]=selection,sendToWARBL(MIDI_CC_104,0==mapSelection?MIDI_CURVE:MIDI_VELOCITY_CURVE+mapSelection-1),sendToWARBL(MIDI_CC_105,selection)}function sendPressureChannel(selection){blink(1);selection=parseFloat(selection);selection<1||16<selection||isNaN(selection)?(alert("Value must be 1-16."),document.getElementById("pressureChannel").value=null):(sendToWARBL(MIDI_CC_104,MIDI_PRESSURE_CHANNEL),sendToWARBL(MIDI_CC_105,selection))}function sendPressureCC(selection){blink(1),selection=parseFloat(selection),sendToWARBL(MIDI_CC_104,MIDI_PRESSURE_CC),sendToWARBL(MIDI_CC_105,selection)}function sendPressureShakeMod(selection){blink(1),console.log("shake mod: "+selection),0==mapSelection?(sendToWARBL(MIDI_CC_109,MIDI_Y_SHAKE_MOD_CC),sendToWARBL(MIDI_CC_105,selection?1:0)):2==mapSelection?(sendToWARBL(MIDI_CC_109,MIDI_Y_SHAKE_MOD_CHPRESS),sendToWARBL(MIDI_CC_105,selection?1:0)):3==mapSelection&&(sendToWARBL(MIDI_CC_109,MIDI_Y_SHAKE_MOD_KEYPRESS),sendToWARBL(MIDI_CC_105,selection?1:0))}function sendBendRange(selection){blink(1);selection=parseFloat(selection);selection<1||96<selection||isNaN(selection)?(alert("Value must be 1-96."),document.getElementById("midiBendRange").value=null):(sendToWARBL(MIDI_CC_104,MIDI_BEND_RANGE),sendToWARBL(MIDI_CC_105,selection))}function sendNoteChannel(selection){blink(1);selection=parseFloat(selection);selection<1||16<selection||isNaN(selection)?(alert("Value must be 1-16."),document.getElementById("noteChannel").value=null):(sendToWARBL(MIDI_CC_104,MIDI_MIDI_CHANNEL),sendToWARBL(MIDI_CC_105,selection))}function sendRoll(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_109,MIDI_SEND_ROLL),sendToWARBL(MIDI_CC_105,selection)}function sendPitch(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_109,MIDI_SEND_PITCH),sendToWARBL(MIDI_CC_105,selection)}function sendYaw(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_109,MIDI_SEND_YAW),sendToWARBL(MIDI_CC_105,selection)}function sendShake(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_109,MIDI_Y_SHAKE_PITCHBEND),sendToWARBL(MIDI_CC_105,selection)}function sendAutoCenterYaw(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_109,MIDI_AUTOCENTER_YAW),sendToWARBL(MIDI_CC_105,selection)}function sendPitchRegister(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_109,MIDI_PITCH_REGISTER),sendToWARBL(MIDI_CC_105,selection)}function sendDronesOnCommand(selection){blink(1),selection=parseFloat(selection),sendToWARBL(MIDI_CC_104,MIDI_DRONES_ON_COMMAND),sendToWARBL(MIDI_CC_105,selection)}function sendDronesOnChannel(selection){selection=parseFloat(selection);selection<0||16<selection||isNaN(selection)?(alert("Value must be 1-16."),document.getElementById("dronesOnChannel").value=null):(blink(1),sendToWARBL(MIDI_CC_104,MIDI_DRONES_ON_CHANNEL),sendToWARBL(MIDI_CC_105,selection))}function sendDronesOnByte2(selection){selection=parseFloat(selection);selection<0||127<selection||isNaN(selection)?(alert("Value must be 0 - 127."),document.getElementById("dronesOnByte2").value=null):(blink(1),sendToWARBL(MIDI_CC_104,MIDI_DRONES_ON_BYTE2),sendToWARBL(MIDI_CC_105,selection))}function sendDronesOnByte3(selection){selection=parseFloat(selection);selection<0||127<selection||isNaN(selection)?(alert("Value must be 0 - 127."),document.getElementById("dronesOnByte3").value=null):(blink(1),sendToWARBL(MIDI_CC_104,MIDI_DRONES_ON_BYTE3),sendToWARBL(MIDI_CC_105,selection))}function sendDronesOffCommand(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_104,MIDI_DRONES_OFF_COMMAND),sendToWARBL(MIDI_CC_105,selection)}function sendDronesOffChannel(selection){selection=parseFloat(selection);selection<0||16<selection||isNaN(selection)?(alert("Value must be 1-16."),document.getElementById("dronesOffChannel").value=null):(blink(1),sendToWARBL(MIDI_CC_104,MIDI_DRONES_OFF_CHANNEL),sendToWARBL(MIDI_CC_105,selection))}function sendDronesOffByte2(selection){selection=parseFloat(selection);selection<0||127<selection||isNaN(selection)?(alert("Value must be 0 - 127."),document.getElementById("dronesOffByte2").value=null):(blink(1),sendToWARBL(MIDI_CC_104,MIDI_DRONES_OFF_BYTE2),sendToWARBL(MIDI_CC_105,selection))}function sendDronesOffByte3(selection){selection=parseFloat(selection);selection<0||127<selection||isNaN(selection)?(alert("Value must be 0 - 127."),document.getElementById("dronesOffByte3").value=null):(blink(1),sendToWARBL(MIDI_CC_104,MIDI_DRONES_OFF_BYTE3),sendToWARBL(MIDI_CC_105,selection))}function sendDronesRadio(selection){blink(1),selection=parseFloat(selection),sendToWARBL(MIDI_CC_104,MIDI_DRONES_CONTROL_MODE),sendToWARBL(MIDI_CC_105,selection)}function learnDrones(){blink(1),document.getElementById("dronesPressureInput").style.backgroundColor="#32CD32",setTimeout(blinkDrones,500),sendToWARBL(MIDI_CC_106,MIDI_LEARN_DRONES_PRESSURE)}function blinkDrones(){document.getElementById("dronesPressureInput").style.backgroundColor="#FFF"}function blinkOctave(){document.getElementById("octavePressureInput").style.backgroundColor="#FFF"}function sendDronesPressure(selection){selection=parseFloat(selection);selection<0||24<selection||isNaN(selection)?(alert("Value must be 0.0 - 24.0."),document.getElementById("dronesPressureInput").value=null):(selection=parseInt(900*selection/24+100),blink(1),document.getElementById("dronesPressureInput").style.backgroundColor="#32CD32",setTimeout(blinkDrones,500),sendToWARBL(MIDI_CC_104,MIDI_DRONES_PRESSURE_LOW_BYTE),sendToWARBL(MIDI_CC_105,127&selection),sendToWARBL(MIDI_CC_104,MIDI_DRONES_PRESSURE_HIGH_BYTE),sendToWARBL(MIDI_CC_105,selection>>7))}function sendOctavePressure(selection){selection=parseFloat(selection);selection<0||24<selection||isNaN(selection)?(alert("Value must be 0.0 - 24.0."),document.getElementById("octavePressureInput").value=null):(selection=parseInt(900*selection/24+100),blink(1),document.getElementById("octavePressureInput").style.backgroundColor="#32CD32",setTimeout(blinkOctave,500),sendToWARBL(MIDI_CC_104,MIDI_LEARNED_PRESS_LSB),sendToWARBL(MIDI_CC_105,127&selection),sendToWARBL(MIDI_CC_104,MIDI_LEARNED_PRESS_MSB),sendToWARBL(MIDI_CC_105,selection>>7))}function learn(){blink(1),document.getElementById("octavePressureInput").style.backgroundColor="#32CD32",setTimeout(blinkOctave,500),sendToWARBL(MIDI_CC_106,MIDI_LEARN_INITIAL_NOTE_PRESS)}function sendCalibrateRadio(selection){selection=parseFloat(selection),blink(1),sendToWARBL(MIDI_CC_106,MIDI_STARTUP_CALIB+selection)}function sendPitchbendRadio(selection){updateCustom(),updateCustom(),0<(selection=parseFloat(selection))&&blink(selection+1),sendToWARBL(MIDI_CC_102,MIDI_PB_MODE_START+selection)}function sendVibratoHoles(holeNumber,selection){selection=+selection,sendToWARBL(MIDI_CC_106,MIDI_DIS_VIBRATO_HOLES_START-10*selection+holeNumber)}function updateCustom(){var a=document.getElementById("fingeringSelect"+instrument).value;if(0==document.getElementById("pitchbendradio2").checked&&((0==a||1==a||4==a||10==a)&&(1==document.getElementById("pitchbendradio1").checked&&version<1.6||"Unknown"==version||1.5<version)||("Unknown"==version||1.5<version)&&(3==a||2==a))?(document.getElementById("checkbox5").disabled=!1,document.getElementById("switch5").style.cursor="pointer"):(document.getElementById("checkbox5").disabled=!0,document.getElementById("switch5").style.cursor="default"),1==document.getElementById("checkbox5").checked&&0==document.getElementById("checkbox5").disabled)for(var i=0;i<9;i++)document.getElementById("vibratoCheckbox"+i).disabled=!0,document.getElementById("vibratoCheckbox"+i).style.cursor="default";else for(i=0;i<9;i++)document.getElementById("vibratoCheckbox"+i).disabled=!1,document.getElementById("vibratoCheckbox"+i).style.cursor="pointer";1==document.getElementById("checkbox18").checked?(document.getElementById("fingeringInput11").disabled=!0,document.getElementById("fingeringInput11").style.cursor="default"):(document.getElementById("fingeringInput11").disabled=!1,document.getElementById("fingeringInput11").style.cursor="pointer"),exprlowslider.noUiSlider.updateOptions({range:{min:0,max:100},start:[0,100]})}function sendBreathmodeRadio(selection){0<(selection=parseFloat(selection))&&blink(selection+1),1==document.getElementById("sensorradio1").checked?(document.getElementById("checkbox16").disabled=!0,document.getElementById("overrideExprCheck").disabled=!0):(document.getElementById("checkbox16").disabled=!1,document.getElementById("overrideExprCheck").disabled=!1),sendToWARBL(MIDI_CC_102,MIDI_BREATH_MODE_START+selection),updateExpressionSliderEnableState()}function advanced(){document.getElementById("box2").style.display="block",document.getElementById("box1").style.display="none",updateSelected()}function advancedOkay(){document.getElementById("box2").style.display="none",document.getElementById("box1").style.display="block"}function advancedPB(){(1.8<version||"Unknown"==version)&&(document.getElementById("box4").style.display="block",document.getElementById("box5").style.display="none")}function mapPressure(){document.getElementById("expressionPressureBox").style.display="block",document.getElementById("box9").style.display="none"}function mapIMU(){document.getElementById("box10").style.display="block",document.getElementById("box9").style.display="none"}function backPressure(){(3.9<version||"Unknown"==version)&&(document.getElementById("expressionPressureBox").style.display="none",document.getElementById("box9").style.display="block")}function backIMU(){document.getElementById("box10").style.display="none",(3.9<version||"Unknown"==version)&&(document.getElementById("box9").style.display="block")}function overRideExpression(){var dispval;(1.8<version||"Unknown"==version)&&(1==document.getElementById("sensorradio1").checked?(document.getElementById("checkbox16").disabled=!0,document.getElementById("overrideExprCheck").disabled=!0):(document.getElementById("checkbox16").disabled=!1,document.getElementById("overrideExprCheck").disabled=!1),dispval=version<4.3?"none":"block",document.getElementById("exprhighslider").style.display=dispval,document.getElementById("exprhighslider-value-min").style.display=dispval,document.getElementById("exprhighslider-value-max").style.display=dispval,document.getElementById("exprlowbendslider").style.display=dispval,document.getElementById("exprlowbendslider-value").style.display=dispval,document.getElementById("exprhighbendslider").style.display=dispval,document.getElementById("exprhighbendslider-value").style.display=dispval,document.getElementById("clampExprMaxLabel").style.display=dispval,document.getElementById("clampExprSwitch").style.display=dispval,document.getElementById("resetExpressionButton").style.display=dispval,document.getElementById("overrideRangeLabel").style.display=dispval,document.getElementById("overrideCentsLabel").style.display=dispval,document.getElementById("lowrangelabel").style.display=dispval,document.getElementById("lowrangelabel2").style.display=dispval,document.getElementById("highrangelabel").style.display=dispval,document.getElementById("highrangelabel2").style.display=dispval,document.getElementById("exprInputPressureLevelContainer").style.display=dispval,document.getElementById("exprcurvelowlabel").style.display=dispval,document.getElementById("exprcurvelowslider").style.display=dispval,document.getElementById("exprcurvelowslider-value").style.display=dispval,document.getElementById("exprcurvehighlabel").style.display=dispval,document.getElementById("exprcurvehighslider").style.display=dispval,document.getElementById("exprcurvehighslider-value").style.display=dispval,document.getElementById("box8").style.display="block",document.getElementById("expressionPressureBox").style.display="none")}function okayOverride(){document.getElementById("box8").style.display="none",document.getElementById("expressionPressureBox").style.display="block"}function advancedOkayPB(){document.getElementById("box4").style.display="none",document.getElementById("box5").style.display="block"}function configureCustomFingering(){version<3.9?(document.getElementById("topControls").style.display="none",document.getElementById("customControls").style.display="block",document.getElementById("box1").style.top="740px",document.getElementById("box2").style.top="740px",document.getElementById("box4").style.top="740px",document.getElementById("box5").style.top="740px",document.getElementById("pressuregraph").style.top="740px",document.getElementById("box3").style.top="1200px",document.getElementById("expressionPressureBox").style.top="1200px",document.getElementById("box9").style.top="1200px",document.getElementById("box10").style.top="1200px",document.getElementById("box7").style.top="1200px",document.getElementById("box8").style.top="1200px",document.getElementById("buttonBox").style.top="1690px",document.getElementById("topcontrolbox").style.height="2155px"):(document.getElementById("topControls").style.display="none",document.getElementById("WARBL2customFingeringFill").value="10",document.getElementById("WARBL2CustomTextArea").value="",document.getElementById("WARBL2customControls").style.display="block")}function customFingeringOkay(){document.getElementById("customControls").style.display="none",document.getElementById("WARBL2customControls").style.display="none",document.getElementById("topControls").style.display="block",document.getElementById("box1").style.top="440px",document.getElementById("box2").style.top="440px",document.getElementById("box4").style.top="440px",document.getElementById("box5").style.top="440px",document.getElementById("pressuregraph").style.top="440px",document.getElementById("box3").style.top="900px",document.getElementById("expressionPressureBox").style.top="900px",document.getElementById("box9").style.top="900px",document.getElementById("box10").style.top="900px",document.getElementById("box7").style.top="900px",document.getElementById("box8").style.top="900px",document.getElementById("buttonBox").style.top="1390px",document.getElementById("topcontrolbox").style.height="1855px",document.getElementById("customFingeringFill").value="12"}function mapCC(){mapSelection=0,document.getElementById("receivedpressureCC").innerHTML=null,document.getElementById("CCpressurelevel").style.width="0%",slider.noUiSlider.set([inputSliderMin[0],inputSliderMax[0]]),slider2.noUiSlider.set([outputSliderMin[0],outputSliderMax[0]]),document.getElementById("pressureChannel").style.visibility="visible",document.getElementById("pressureCC").style.visibility="visible",document.getElementById("expressionChannel").style.visibility="visible",document.getElementById("highByte").style.visibility="visible",document.getElementById("box7").style.display="block",document.getElementById("expressionPressureBox").style.display="none",document.getElementById("pressureShakeModSwitch").style.display="block",document.getElementById("pressureShakeModLabel").style.display="block",document.getElementById("pressureMPEplusSwitch").style.display="none",document.getElementById("pressureMPEplusLabel").style.display="none",curve[0]<3&&(document.getElementById("curveRadio"+curve[0]).checked=!0),document.getElementById("pressureMappingHeader").innerHTML="CC Mapping"}function mapVelocity(){mapSelection=1,document.getElementById("receivedpressureCC").innerHTML=null,document.getElementById("CCpressurelevel").style.width="0%",slider.noUiSlider.set([inputSliderMin[1],inputSliderMax[1]]),slider2.noUiSlider.set([outputSliderMin[1],outputSliderMax[1]]),curve[1]<3&&(document.getElementById("curveRadio"+curve[1]).checked=!0),document.getElementById("box7").style.display="block",document.getElementById("expressionPressureBox").style.display="none",document.getElementById("pressureMappingHeader").innerHTML="Velocity Mapping",document.getElementById("pressureShakeModSwitch").style.display="none",document.getElementById("pressureShakeModLabel").style.display="none",document.getElementById("pressureMPEplusSwitch").style.display="none",document.getElementById("pressureMPEplusLabel").style.display="none"}function mapAftertouch(){mapSelection=2,document.getElementById("receivedpressureCC").innerHTML=null,document.getElementById("CCpressurelevel").style.width="0%",slider.noUiSlider.set([inputSliderMin[2],inputSliderMax[2]]),slider2.noUiSlider.set([outputSliderMin[2],outputSliderMax[2]]),curve[2]<3&&(document.getElementById("curveRadio"+curve[2]).checked=!0),document.getElementById("box7").style.display="block",document.getElementById("expressionPressureBox").style.display="none",document.getElementById("pressureMappingHeader").innerHTML="Channel Pressure Mapping",document.getElementById("pressureShakeModSwitch").style.display="block",document.getElementById("pressureShakeModLabel").style.display="block",document.getElementById("pressureMPEplusSwitch").style.display="block",document.getElementById("pressureMPEplusLabel").style.display="block",console.log("map aftertouch")}function mapPoly(){mapSelection=3,document.getElementById("receivedpressureCC").innerHTML=null,document.getElementById("CCpressurelevel").style.width="0%",slider.noUiSlider.set([inputSliderMin[3],inputSliderMax[3]]),slider2.noUiSlider.set([outputSliderMin[3],outputSliderMax[3]]),curve[3]<3&&(document.getElementById("curveRadio"+curve[3]).checked=!0),document.getElementById("box7").style.display="block",document.getElementById("expressionPressureBox").style.display="none",document.getElementById("pressureMappingHeader").innerHTML="Key Pressure Mapping",document.getElementById("pressureShakeModSwitch").style.display="block",document.getElementById("pressureShakeModLabel").style.display="block",document.getElementById("pressureMPEplusSwitch").style.display="none",document.getElementById("pressureMPEplusLabel").style.display="none"}function okayCCmap(){mapSelection=4,document.getElementById("box7").style.display="none",document.getElementById("expressionPressureBox").style.display="block",document.getElementById("pressureChannel").style.visibility="hidden",document.getElementById("pressureCC").style.visibility="hidden",document.getElementById("expressionChannel").style.visibility="hidden",document.getElementById("highByte").style.visibility="hidden"}function mapRoll(){IMUmapSelection=1,document.getElementById("receivedCC").innerHTML=null,document.getElementById("CClevel").style.width="0%",document.getElementById("checkbox23").checked=center[1],document.getElementById("IMUChannelInput").value=IMUchannel[0],document.getElementById("IMUCC").value=IMUnumber[0],slider5.noUiSlider.set([inputSliderMin[4],inputSliderMax[4]]),slider4.noUiSlider.set([outputSliderMin[4],outputSliderMax[4]]),document.getElementById("box10").style.display="none",document.getElementById("box11").style.display="block",document.getElementById("IMUMappingHeader").innerHTML="Roll Mapping",document.getElementById("centerLabel").style.display="block",document.getElementById("switch23").style.display="block"}function mapPitch(){IMUmapSelection=2,document.getElementById("receivedCC").innerHTML=null,document.getElementById("CClevel").style.width="0%",document.getElementById("IMUChannelInput").value=IMUchannel[1],document.getElementById("IMUCC").value=IMUnumber[1],slider5.noUiSlider.set([inputSliderMin[5],inputSliderMax[5]]),slider4.noUiSlider.set([outputSliderMin[5],outputSliderMax[5]]),document.getElementById("box10").style.display="none",document.getElementById("box11").style.display="block",document.getElementById("IMUMappingHeader").innerHTML="Elevation Mapping",document.getElementById("centerLabel").style.display="none",document.getElementById("switch23").style.display="none"}function mapYaw(){IMUmapSelection=3,document.getElementById("YawCenterControls").style.display="block",document.getElementById("IMUMappingControls").style.top="-190px",document.getElementById("receivedCC").innerHTML=null,document.getElementById("CClevel").style.width="0%",document.getElementById("IMUChannelInput").value=IMUchannel[2],document.getElementById("IMUCC").value=IMUnumber[2],document.getElementById("checkbox23").checked=center[3],slider5.noUiSlider.set([inputSliderMin[6],inputSliderMax[6]]),slider4.noUiSlider.set([outputSliderMin[6],outputSliderMax[6]]),document.getElementById("box10").style.display="none",document.getElementById("box11").style.display="block",document.getElementById("IMUMappingHeader").innerHTML="Yaw Mapping",document.getElementById("centerLabel").style.display="block",document.getElementById("switch23").style.display="block"}function mapPitchRegister(){document.getElementById("receivedCC").innerHTML=null,document.getElementById("CClevel").style.width="0%",document.getElementById("IMUChannelInput").value=IMUchannel[1],document.getElementById("IMUCC").value=IMUnumber[1],slider5.noUiSlider.set([inputSliderMin[5],inputSliderMax[5]]),slider4.noUiSlider.set([outputSliderMin[5],outputSliderMax[5]]),document.getElementById("box10").style.display="none",document.getElementById("box12").style.display="block",document.getElementById("IMUMappingHeader").innerHTML="Pitch Mapping",document.getElementById("centerLabel").style.display="none",document.getElementById("switch23").style.display="none"}function okayIMUmap(){document.getElementById("YawCenterControls").style.display="none",document.getElementById("IMUMappingControls").style.top="-170px",document.getElementById("box11").style.display="none",document.getElementById("box10").style.display="block"}function okayPitchRegistermap(){document.getElementById("box12").style.display="none",document.getElementById("box10").style.display="block"}function sendCenter(selection){center[IMUmapSelection]=selection=+selection,blink(1),sendToWARBL(MIDI_CC_109,1==IMUmapSelection?MIDI_SEND_CENTER_ROLL:MIDI_SEND_CENTER_YAW),sendToWARBL(MIDI_CC_105,selection)}function sendIMUChannel(selection){selection=+selection,blink(1),IMUchannel[IMUmapSelection-1]=selection,sendToWARBL(MIDI_CC_109,IMUmapSelection-1+MIDI_IMU_CHANNEL_START),sendToWARBL(MIDI_CC_105,selection)}function sendIMUCC(selection){selection=+selection,blink(1),IMUnumber[IMUmapSelection-1]=selection,sendToWARBL(MIDI_CC_109,IMUmapSelection-1+MIDI_IMU_CC_START),sendToWARBL(MIDI_CC_105,selection)}function pressureGraph(){document.getElementById("pressuregraph").style.display="block",document.getElementById("box1").style.display="none",startPressureGraph()}function pressureOkay(){stopPressureGraph(),document.getElementById("pressuregraph").style.display="none",document.getElementById("box1").style.display="block"}function advancedDefaults(){if(2<version||"Unknown"==version){document.getElementById("jumpFactor7").value="3",document.getElementById("jumpFactor8").value="7",document.getElementById("jumpFactor9").value="20",document.getElementById("jumpFactor11").value="12",document.getElementById("jumpFactor12").value="50";for(var i=7;i<10;i++)document.getElementById("jumpFactor"+i).dispatchEvent(new Event("input")),sendJumpFactor(i,document.getElementById("jumpFactor"+i).value);for(i=11;i<13;i++)document.getElementById("jumpFactor"+i).dispatchEvent(new Event("input")),sendJumpFactor(i,document.getElementById("jumpFactor"+i).value)}else{document.getElementById("jumpFactor1").value="25",document.getElementById("jumpFactor2").value="15",document.getElementById("jumpFactor3").value="15",document.getElementById("jumpFactor4").value="15",document.getElementById("jumpFactor5").value="30",document.getElementById("jumpFactor6").value="60",document.getElementById("jumpFactor7").value="3",document.getElementById("jumpFactor8").value="7",document.getElementById("jumpFactor9").value="100",document.getElementById("jumpFactor10").value="7",document.getElementById("jumpFactor11").value="9",document.getElementById("jumpFactor12").value="9";for(i=1;i<13;i++)document.getElementById("jumpFactor"+i).dispatchEvent(new Event("input")),sendJumpFactor(i,document.getElementById("jumpFactor"+i).value)}}function advancedBagDefaults(){if(2<version||"Unknown"==version){document.getElementById("jumpFactor1").value="50",document.getElementById("jumpFactor2").value="20",document.getElementById("jumpFactor3").value="20",document.getElementById("jumpFactor4").value="50",document.getElementById("jumpFactor6").value="75";for(var i=1;i<7;i++)document.getElementById("jumpFactor"+i).dispatchEvent(new Event("input")),sendJumpFactor(i,document.getElementById("jumpFactor"+i).value)}else{document.getElementById("jumpFactor1").value="75",document.getElementById("jumpFactor2").value="25",document.getElementById("jumpFactor3").value="15",document.getElementById("jumpFactor4").value="15",document.getElementById("jumpFactor5").value="30",document.getElementById("jumpFactor6").value="60",document.getElementById("jumpFactor7").value="50",document.getElementById("jumpFactor8").value="20",document.getElementById("jumpFactor9").value="28",document.getElementById("jumpFactor10").value="7",document.getElementById("jumpFactor11").value="15",document.getElementById("jumpFactor12").value="22";for(i=1;i<13;i++)document.getElementById("jumpFactor"+i).dispatchEvent(new Event("input")),sendJumpFactor(i,document.getElementById("jumpFactor"+i).value)}}function sendJumpFactor(factor,selection){selection=parseFloat(selection),blink(1),sendToWARBL(MIDI_CC_104,factor),sendToWARBL(MIDI_CC_105,selection)}function sendRow(rowNum){blink(1),updateCells(),sendToWARBL(MIDI_CC_102,MIDI_GESTURE_START+rowNum);var y=100+parseFloat(document.getElementById("row"+rowNum).value);version<4?(sendToWARBL(MIDI_CC_102,y),sendMIDIrow(rowNum)):sendToWARBL(MIDI_CC_106,y),rowNum<3&&sendMomentary(rowNum)}function sendMIDIrow(MIDIrowNum){blink(1),updateCells(),sendToWARBL(MIDI_CC_102,MIDI_GESTURE_START+MIDIrowNum);var y=112+parseFloat(document.getElementById("MIDIrow"+MIDIrowNum).value);sendToWARBL(MIDI_CC_102,y),MIDIrowNum<3&&sendMomentary(MIDIrowNum)}function sendChannel(rowNum){blink(1),MIDIvalueChange();var y=parseFloat(document.getElementById("channel"+rowNum).value);sendToWARBL(MIDI_CC_102,MIDI_GESTURE_START+rowNum),sendToWARBL(MIDI_CC_106,y)}function sendByte2(rowNum){blink(1),MIDIvalueChange(),sendToWARBL(MIDI_CC_102,MIDI_GESTURE_START+rowNum);rowNum=parseFloat(document.getElementById("byte2_"+rowNum).value);sendToWARBL(MIDI_CC_107,rowNum)}function sendByte3(rowNum){blink(1),MIDIvalueChange(),sendToWARBL(MIDI_CC_102,MIDI_GESTURE_START+rowNum);rowNum=parseFloat(document.getElementById("byte3_"+rowNum).value);sendToWARBL(MIDI_CC_108,rowNum)}function sendMomentary(rowNum){blink(1),updateCells();var y=document.getElementById("checkbox"+rowNum).checked;sendToWARBL(MIDI_CC_102,MIDI_GESTURE_START+rowNum),0==y&&sendToWARBL(MIDI_CC_102,MIDI_MOMENTARY_OFF),1==y&&sendToWARBL(MIDI_CC_102,MIDI_MOMENTARY_ON)}function sendVented(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START),sendToWARBL(MIDI_CC_105,selection),updateSelected()}function sendBagless(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+1),sendToWARBL(MIDI_CC_105,selection)}function sendSecret(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+2),sendToWARBL(MIDI_CC_105,selection)}function sendInvert(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+3),sendToWARBL(MIDI_CC_105,selection)}function sendCustom(selection){selection=+selection,blink(1),updateCustom(),sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+4),sendToWARBL(MIDI_CC_105,selection)}function sendExpression(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_104,MIDI_ED_VARS_START),sendToWARBL(MIDI_CC_105,selection)}function sendRawPressure(selection){selection=+selection,updateCustom(),blink(1),sendToWARBL(MIDI_CC_104,MIDI_SEND_PRESSURE),sendToWARBL(MIDI_CC_105,selection)}function sendVelocity(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+5),sendToWARBL(MIDI_CC_105,selection),updateCells()}function sendAftertouch(selection,polyselection){selection=(selection=+selection)|+polyselection<<1;blink(1),sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+6),sendToWARBL(MIDI_CC_105,selection)}function sendForceVelocity(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+7),sendToWARBL(MIDI_CC_105,selection)}function sendHack1(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+8),sendToWARBL(MIDI_CC_105,selection)}function sendHack2(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+9),sendToWARBL(MIDI_CC_105,selection)}function updateExpressionCenterPressureLabel(){var slider=document.getElementById("exprfixedcenterslider"),element=document.getElementById("exprfixedcenterslider-value"),slider=parseFloat(.24*slider.value).toFixed(1);element.innerHTML=slider}function updateExpressionCurveLabel(theslider,thelabel){theslider=parseInt(theslider.value-64);thelabel.innerHTML=0==theslider?"Linear":0<theslider?(3*theslider/63+1).toFixed(2):(.75*(64+theslider)/64+.25).toFixed(3)}function updateExpressionCurveLabels(){updateExpressionCurveLabel(document.getElementById("exprcurvelowslider"),document.getElementById("exprcurvelowslider-value"));var highslider=document.getElementById("exprcurvehighslider");updateExpressionCurveLabel(highslider,document.getElementById("exprcurvehighslider-value"))}function updateExpressionSliderEnableState(){var overidden=document.getElementById("overrideExprCheck").checked,overblow=document.getElementById("sensorradio1").checked,overidden=(document.getElementById("expressionDepth").disabled=overidden&&!overblow,document.getElementById("exprfixedcenterslider").disabled=overidden||overblow,version<4.3?"none":"block");document.getElementById("exprfixedcenterslider").style.display=overidden,document.getElementById("exprfixedcenterslider-value").style.display=overidden,document.getElementById("exprcenterpresslabel").style.display=overidden,document.getElementById("overrideExprCheck").disabled=overblow}function curveValToExponent(val){return 0<=(val-=64)?3*val/63+1:.75*(64+val)/64+.25}function calculateOutExprBendFromInput(sensorValue){var lowPressureMax,highPressureMin,centsLowOffset,centsHighOffset,lowCurveExp,highCurveExp,doClamp,ratio,highPressureMax,overblow=document.getElementById("sensorradio1").checked;return!document.getElementById("overrideExprCheck").checked||overblow?0:(overblow=9*parseInt(exprlowslider.noUiSlider.get()[0])+100,lowPressureMax=9*parseInt(exprlowslider.noUiSlider.get()[1])+100,highPressureMin=9*parseInt(exprhighslider.noUiSlider.get()[0])+100,highPressureMax=9*parseInt(exprhighslider.noUiSlider.get()[1])+100,centsLowOffset=2*(parseInt(exprlowbendslider.noUiSlider.get()[0])-64),centsHighOffset=2*(parseInt(exprhighbendslider.noUiSlider.get()[0])-64),lowCurveExp=curveValToExponent(parseInt(document.getElementById("exprcurvelowslider").value)),highCurveExp=curveValToExponent(parseInt(document.getElementById("exprcurvehighslider").value)),doClamp=document.getElementById("clampExprCheck").checked,ratio=0,overblow=Math.max(lowPressureMax-overblow,1),highPressureMax=Math.max(highPressureMax-highPressureMin,1),sensorValue<=lowPressureMax?(ratio=Math.min((lowPressureMax-sensorValue)/overblow,1),centsLowOffset*(ratio=1!=lowCurveExp?Math.pow(ratio,lowCurveExp):ratio)):highPressureMin<=sensorValue?(ratio=Math.max((sensorValue-highPressureMin)/highPressureMax,0),1!=highCurveExp&&(ratio=Math.pow(ratio,highCurveExp)),centsHighOffset*(ratio=doClamp?Math.min(ratio,1):ratio)):0)}function sendOverride(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+10),sendToWARBL(MIDI_CC_105,selection),document.getElementById("overrideExprCheck").checked=selection,document.getElementById("checkbox16").checked=selection,updateExpressionSliderEnableState()}function sendBoth(selection){selection=+selection,blink(1),sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+11),sendToWARBL(MIDI_CC_105,selection)}function sendR4flatten(selection){selection=+selection,blink(1),updateCustom(),sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+12),sendToWARBL(MIDI_CC_105,selection)}function updateDoubleClick(){document.getElementById("cbDoubleClick").checked?(document.getElementById("gestureLabel0").innerHTML="Double-click 1",document.getElementById("gestureLabel1").innerHTML="Double-click 2",document.getElementById("gestureLabel2").innerHTML="Double-click 3"):(document.getElementById("gestureLabel0").innerHTML="Click 1",document.getElementById("gestureLabel1").innerHTML="Click 2",document.getElementById("gestureLabel2").innerHTML="Click 3")}function sendDoubleClick(selection){updateDoubleClick(),selection=+selection,blink(1),sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+13),sendToWARBL(MIDI_CC_105,selection)}function calibrateIMU(){blink(1),sendToWARBL(MIDI_CC_106,MIDI_CALIB_IMU)}function centerYaw(){blink(1),sendToWARBL(MIDI_CC_106,MIDI_CENTER_YAW)}function resetPitchExpressionOverride(){blink(1),sendToWARBL(MIDI_CC_106,MIDI_RESET_PITCH_EXPRESSION),setTimeout(function(){sendToWARBL(MIDI_CC_102,MIDI_ENTER_COMM_MODE),setTimeout(function(){mapPressure(),overRideExpression()},500)},500)}function WARBL2Radio(selection){blink(1),selection=parseFloat(selection),sendToWARBL(MIDI_CC_106,MIDI_WARBL2_SETTINGS_START),sendToWARBL(MIDI_CC_119,selection)}function sendHost(selection){blink(1),selection=+selection,sendToWARBL(MIDI_CC_106,MIDI_WARBL2_SETTINGS_START+1),sendToWARBL(MIDI_CC_119,selection)}function sendPoweroff(selection){selection=parseFloat(selection),blink(1),sendToWARBL(MIDI_CC_106,MIDI_WARBL2_SETTINGS_START+2),sendToWARBL(MIDI_CC_119,selection)}function saveAsDefaults(){modalclose(2),blink(3),sendToWARBL(MIDI_CC_102,MIDI_SAVE_AS_DEFAULTS_CURRENT)}function saveCalibAsFactoryDefault(){modalclose(2),blink(3),sendToWARBL(MIDI_CC_106,MIDI_SAVE_CALIB_AS_FACTORY)}function saveAsDefaultsForAll(){modalclose(3),blink(3),sendToWARBL(MIDI_CC_102,MIDI_SAVE_AS_DEFAULTS_ALL)}function restoreAll(){modalclose(4),blink(3),sendToWARBL(MIDI_CC_102,MIDI_RESTORE_FACTORY),communicationMode=0,1.9<version&&version<4&&setTimeout(connect,3e3)}function autoCalibrateBell(){communicationMode&&LEDon(),setTimeout(LEDoff,5e3),sendToWARBL(MIDI_CC_106,MIDI_CALIB_BELL_SENSOR)}function autoCalibrate(){communicationMode&&LEDon(),setTimeout(LEDoff,1e4),sendToWARBL(MIDI_CC_102,MIDI_START_CALIB)}function frequencyFromNoteNumber(note){return 440*Math.pow(2,(note-69)/12)}function modal(modalId){document.getElementById("open-modal"+modalId).classList.add("modal-window-open"),18==modalId&&clearConsole(),25==modalId&&(document.getElementById("sending").innerHTML="Sending...",document.getElementById("WARBL2CustomSuccessOkay").style.display="none")}function modalclose(modalId){document.getElementById("open-modal"+modalId).classList.remove("modal-window-open")}function blink(blinkNum){communicationMode&&(LEDon(),setTimeout(LEDoff,200),1<blinkNum&&(setTimeout(LEDon,400),setTimeout(LEDoff,600)),2<blinkNum&&(setTimeout(LEDon,800),setTimeout(LEDoff,1e3)),3<blinkNum&&(setTimeout(LEDon,1200),setTimeout(LEDoff,1400)),4<blinkNum)&&(setTimeout(LEDon,1600),setTimeout(LEDoff,1800))}function checkMax(field){var x=document.getElementById("v"+field).textContent;"MAX"==x&&(document.getElementById(2*field).disabled=!0),"MAX"!=x&&(document.getElementById(2*field).disabled=!1)}function isEven(n){return n%2==0}function isOdd(n){return 1==Math.abs(n%2)}function LEDoff(){elements=document.getElementsByClassName("leddot");for(var i=0;i<elements.length;i++)elements[i].style.visibility="hidden"}function LEDon(){elements=document.getElementsByClassName("leddot");for(var i=0;i<elements.length;i++)elements[i].style.visibility="visible"}function toggleOn(){0==(volume=+!volume)?(document.getElementById("volumeOff").style.display="block",document.getElementById("volumeOn").style.display="none",noteOff(currentNote)):(document.getElementById("volumeOff").style.display="none",document.getElementById("volumeOn").style.display="block")}function logKeys(){for(var s="Keys",i=0;i<midiNotes.length;i++)s=s+" "+midiNotes[i].pitch}function noteOn(pitch){if(noteOff(pitch),currentNote=pitch,volume){for(var i=0;i<_tone_0650_SBLive_sf2.zones.length;i++)_tone_0650_SBLive_sf2.zones[i].ahdsr=!1;var envelope=player.queueWaveTable(audioContext,audioContext.destination,_tone_0650_SBLive_sf2,0,pitch,999,.5,!0);midiNotes.push({pitch:pitch,envelope:envelope})}}function noteOff(pitch){for(var i=0;i<midiNotes.length;i++)if(midiNotes[i].pitch==pitch)return midiNotes[i].envelope&&midiNotes[i].envelope.cancel(),void midiNotes.splice(i,1)}updatePlatform(),exprlowbendslider.noUiSlider.disable(1),exprhighbendslider.noUiSlider.disable(1),window.onclick=function(event){for(var i=1;i<=30;i++)event.target==modals[i]&&modalclose(i);event.stopPropagation()},window.addEventListener("load",function(){WARBLin=WARBLout=null,updateCells();for(var i=1;i<13;i++)document.getElementById("jumpFactor"+i).dispatchEvent(new Event("input")),10==i&&document.getElementById("jumpFactor10b").dispatchEvent(new Event("input"));depth.dispatchEvent(new Event("input")),slidelimit.dispatchEvent(new Event("input")),$(".volume").click(function(){toggleOn()}),navigator.requestMIDIAccess?navigator.requestMIDIAccess({sysex:!1}).then(onMIDIInit,onMIDIReject):alert("Your browser does not support MIDI. Please use Chrome or Opera, or the free WARBL iOS app.")}),slider.noUiSlider.on("change",function(values){blink(1),0==mapSelection?(inputSliderMin[0]=parseInt(values[0]),inputSliderMax[0]=parseInt(values[1]),sendToWARBL(MIDI_CC_104,MIDI_INPUT_PRESSURE_MIN),sendToWARBL(MIDI_CC_105,parseInt(values[0])),sendToWARBL(MIDI_CC_104,MIDI_INPUT_PRESSURE_MAX)):(inputSliderMin[mapSelection]=parseInt(values[0]),inputSliderMax[mapSelection]=parseInt(values[1]),sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+4*(mapSelection-1)),sendToWARBL(MIDI_CC_105,parseInt(values[0])),sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+1+4*(mapSelection-1))),sendToWARBL(MIDI_CC_105,parseInt(values[1]))}),slider2.noUiSlider.on("change",function(values){blink(1),0==mapSelection?(outputSliderMin[0]=parseInt(values[0]),outputSliderMax[0]=parseInt(values[1]),sendToWARBL(MIDI_CC_104,MIDI_OUTPUT_PRESSURE_MIN),sendToWARBL(MIDI_CC_105,parseInt(values[0])),sendToWARBL(MIDI_CC_104,MIDI_OUTPUT_PRESSURE_MAX)):(outputSliderMin[mapSelection]=parseInt(values[0]),outputSliderMax[mapSelection]=parseInt(values[1]),sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+2+4*(mapSelection-1)),sendToWARBL(MIDI_CC_105,parseInt(values[0])),sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+3+4*(mapSelection-1))),sendToWARBL(MIDI_CC_105,parseInt(values[1]))}),exprlowslider.noUiSlider.on("change",function(values){blink(1),version<4.3?(sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MIN),sendToWARBL(MIDI_CC_105,parseInt(values[0])),sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MAX),sendToWARBL(MIDI_CC_105,parseInt(values[1]))):(sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MIN),sendToWARBL(MIDI_CC_105,parseInt(values[0])),sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MIN_HIGH),sendToWARBL(MIDI_CC_105,parseInt(values[1])),console.log("lowchange"),parseInt(values[1])>parseInt(exprhighslider.noUiSlider.get()[0])&&(console.log("  exprhigh values "+exprhighslider.noUiSlider.get()[0]+" "+exprhighslider.noUiSlider.get()[1]),exprhighslider.noUiSlider.set([parseInt(values[1]),null]),sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MAX_LOW),sendToWARBL(MIDI_CC_105,parseInt(values[1]))))}),exprhighslider.noUiSlider.on("change",function(values){blink(1),sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MAX_LOW),sendToWARBL(MIDI_CC_105,parseInt(values[0])),sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MAX),sendToWARBL(MIDI_CC_105,parseInt(values[1])),console.log("highchange"),parseInt(values[0])<parseInt(exprlowslider.noUiSlider.get()[1])&&(exprlowslider.noUiSlider.set([null,parseInt(values[0])]),console.log("  exprlow values "+exprlowslider.noUiSlider.get()[0]+" "+exprlowslider.noUiSlider.get()[1]),sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MIN_HIGH),sendToWARBL(MIDI_CC_105,parseInt(values[0])))}),exprlowbendslider.noUiSlider.on("change",function(values){blink(1),sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_OUT_LOW_CENTS),sendToWARBL(MIDI_CC_105,parseInt(values[0]))}),exprhighbendslider.noUiSlider.on("change",function(values){blink(1),sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_OUT_HIGH_CENTS),sendToWARBL(MIDI_CC_105,parseInt(values[0]))}),slider5.noUiSlider.on("change",function(values,handle){center[IMUmapSelection]&&2!=IMUmapSelection&&(values=parseFloat(values[handle]).toFixed(0),handle?0<values?slider5.noUiSlider.set([-values,null]):slider5.noUiSlider.set([0,0]):values<0?slider5.noUiSlider.set([null,-values]):slider5.noUiSlider.set([0,0])),blink(1);handle=slider5.noUiSlider.get();inputSliderMin[IMUmapSelection+3]=parseInt(handle[0]),inputSliderMax[IMUmapSelection+3]=parseInt(handle[1]),sendToWARBL(MIDI_CC_109,4*IMUmapSelection+1),sendToWARBL(MIDI_CC_105,(parseInt(handle[0])+90)/5),sendToWARBL(MIDI_CC_109,4*IMUmapSelection+2),sendToWARBL(MIDI_CC_105,(parseInt(handle[1])+90)/5)}),slider4.noUiSlider.on("change",function(values,handle){outputSliderMin[IMUmapSelection+3]=parseInt(values[0]),outputSliderMax[IMUmapSelection+3]=parseInt(values[1]),sendToWARBL(MIDI_CC_109,4*IMUmapSelection+3),sendToWARBL(MIDI_CC_105,parseInt(values[0])),sendToWARBL(MIDI_CC_109,4*IMUmapSelection+4),sendToWARBL(MIDI_CC_105,parseInt(values[1]))}),slider.noUiSlider.on("update",function(values,handle){var min,marginMin=document.getElementById("slider-value-min"),marginMax=document.getElementById("slider-value-max");handle?(min=parseFloat(.24*values[handle]).toFixed(1),marginMax.innerHTML=min):(marginMax=parseFloat(.24*values[handle]).toFixed(1),marginMin.innerHTML=marginMax)}),slider2.noUiSlider.on("update",function(values,handle){var marginMin=document.getElementById("slider2-value-min"),marginMax=document.getElementById("slider2-value-max");handle?marginMax.innerHTML=parseInt(values[handle]):marginMin.innerHTML=parseInt(values[handle])}),exprlowslider.noUiSlider.on("update",function(values,handle){var min,marginMin=document.getElementById("exprlowslider-value-min"),marginMax=document.getElementById("exprlowslider-value-max");handle?(min=parseFloat(.24*values[handle]).toFixed(1),marginMax.innerHTML=min):(marginMax=parseFloat(.24*values[handle]).toFixed(1),marginMin.innerHTML=marginMax)}),exprhighslider.noUiSlider.on("update",function(values,handle){var min,marginMin=document.getElementById("exprhighslider-value-min"),marginMax=document.getElementById("exprhighslider-value-max");handle?(min=parseFloat(.24*values[handle]).toFixed(1),marginMax.innerHTML=min):(marginMax=parseFloat(.24*values[handle]).toFixed(1),marginMin.innerHTML=marginMax)}),exprlowbendslider.noUiSlider.on("update",function(values,handle){var marginMin=document.getElementById("exprlowbendslider-value"),values=parseFloat(2*(values[0]-64)).toFixed(0);marginMin.innerHTML=values}),exprhighbendslider.noUiSlider.on("update",function(values,handle){var marginMin=document.getElementById("exprhighbendslider-value"),values=parseFloat(2*(values[0]-64)).toFixed(0);marginMin.innerHTML=values}),slider4.noUiSlider.on("update",function(values,handle){var marginMin=document.getElementById("slider4-value-min"),marginMax=document.getElementById("slider4-value-max"),marginMax=(handle?marginMax.innerHTML=parseInt(values[handle]):marginMin.innerHTML=parseInt(values[handle]),slider4.noUiSlider.get());if(elements=document.getElementById("slider4").getElementsByClassName("noUi-connect"),parseInt(marginMax[0])>parseInt(marginMax[1]))for(var i=0;i<elements.length;i++)elements[i].style.backgroundColor="#f7c839";else for(i=0;i<elements.length;i++)elements[i].style.backgroundColor="#262626"}),slider5.noUiSlider.on("update",function(values,handle){var min,marginMin=document.getElementById("slider5-value-min"),marginMax=document.getElementById("slider5-value-max");3==IMUmapSelection?handle?(min=parseFloat(2*values[handle]).toFixed(0),marginMax.innerHTML=min):(min=parseFloat(2*values[handle]).toFixed(0),marginMin.innerHTML=min):handle?marginMax.innerHTML=parseInt(values[handle]):marginMin.innerHTML=parseInt(values[handle])}),slider6.noUiSlider.on("update",function(values,handle){var marginMin=document.getElementById("slider6-value-min"),marginMax=document.getElementById("slider6-value-max");handle?marginMax.innerHTML=parseInt(values[handle]):marginMin.innerHTML=parseInt(values[handle])}),slider6.noUiSlider.on("change",function(values,handle){blink(1);var handles=slider6.noUiSlider.get();inputSliderMin[IMUmapSelection+3]=parseInt(handles[0]),inputSliderMax[IMUmapSelection+3]=parseInt(handles[1]),sendToWARBL(MIDI_CC_109,MIDI_PITCH_REGISTER_INPUT_MIN),sendToWARBL(MIDI_CC_105,(parseInt(handles[0])+90)/5),sendToWARBL(MIDI_CC_109,MIDI_PITCH_REGISTER_INPUT_MAX),sendToWARBL(MIDI_CC_105,(parseInt(handles[1])+90)/5)});var output18=document.getElementById("demo18"),slideLimitSlider=document.getElementById("slidelimit");function sliderLimitChange(){output18.innerHTML=slideLimitSlider.value}slideLimitSlider.addEventListener("input",sliderLimitChange);var output14=document.getElementById("demo14"),depthSlider=document.getElementById("depth");function slider14Change(){output14.innerHTML=depthSlider.value}depthSlider.addEventListener("input",slider14Change);var output15=document.getElementById("demo15"),shakeDepthSlider=document.getElementById("shakeDepth");function slider15Change(){output15.innerHTML=shakeDepthSlider.value}shakeDepthSlider.addEventListener("input",slider15Change);var output16=document.getElementById("demo16"),autoCenterYawSlider=document.getElementById("autoCenterYawInterval");function slider16Change(){output16.innerHTML=autoCenterYawSlider.value/4}autoCenterYawSlider.addEventListener("input",slider16Change);var output17=document.getElementById("demo17"),pitchRegisterSlider=document.getElementById("pitchRegisterNumber");function slider17Change(){output17.innerHTML=pitchRegisterSlider.value}pitchRegisterSlider.addEventListener("input",slider17Change);var output1=document.getElementById("demo1"),jumpSlider1=document.getElementById("jumpFactor1");function slider1Change(){output1.innerHTML=jumpSlider1.value}jumpSlider1.addEventListener("input",slider1Change);var output2=document.getElementById("demo2"),jumpSlider2=document.getElementById("jumpFactor2");function slider2Change(){output2.innerHTML=jumpSlider2.value}jumpSlider2.addEventListener("input",slider2Change);var output3=document.getElementById("demo3"),jumpSlider3=document.getElementById("jumpFactor3");function slider3Change(){output3.innerHTML=jumpSlider3.value}jumpSlider3.addEventListener("input",slider3Change);var output4=document.getElementById("demo4"),jumpSlider4=document.getElementById("jumpFactor4");function slider4Change(){output4.innerHTML=jumpSlider4.value}jumpSlider4.addEventListener("input",slider4Change);var output5=document.getElementById("demo5"),jumpSlider5=document.getElementById("jumpFactor5");function slider5Change(){output5.innerHTML=jumpSlider5.value}jumpSlider5.addEventListener("input",slider5Change);var output6=document.getElementById("demo6"),jumpSlider6=document.getElementById("jumpFactor6");function slider6Change(){output6.innerHTML=jumpSlider6.value}jumpSlider6.addEventListener("input",slider6Change);var output7=document.getElementById("demo7"),jumpSlider7=document.getElementById("jumpFactor7");function slider7Change(){output7.innerHTML=jumpSlider7.value}jumpSlider7.addEventListener("input",slider7Change);var output8=document.getElementById("demo8"),jumpSlider8=document.getElementById("jumpFactor8");function slider8Change(){output8.innerHTML=jumpSlider8.value}jumpSlider8.addEventListener("input",slider8Change);var output9=document.getElementById("demo9"),jumpSlider9=document.getElementById("jumpFactor9");function slider9Change(){output9.innerHTML=jumpSlider9.value}jumpSlider9.addEventListener("input",slider9Change);var output10=document.getElementById("demo10"),jumpSlider10=document.getElementById("jumpFactor10");function slider10Change(){output10.innerHTML=jumpSlider10.value}jumpSlider10.addEventListener("input",slider10Change);var output10b=document.getElementById("demo10b"),jumpSlider10b=document.getElementById("jumpFactor10b");function slider10bChange(){output10b.innerHTML=jumpSlider10b.value}jumpSlider10b.addEventListener("input",slider10bChange);var output11=document.getElementById("demo11"),jumpSlider11=document.getElementById("jumpFactor11");function slider11Change(){output11.innerHTML=jumpSlider11.value}jumpSlider11.addEventListener("input",slider11Change);var output12=document.getElementById("demo12"),jumpSlider12=document.getElementById("jumpFactor12");function slider12Change(){output12.innerHTML=jumpSlider12.value}jumpSlider12.addEventListener("input",slider12Change);var outputPoweroff=document.getElementById("poweroffValue"),poweroffSlider=document.getElementById("poweroffSlider");function poweroffSliderChange(){outputPoweroff.innerHTML=poweroffSlider.value}function clearConsole(){document.getElementById("console").innerHTML="",consoleEntries=0}function updateCells(){1.6<version&&(1==document.getElementById("checkbox10").checked?(document.getElementById("checkbox12").disabled=!0,document.getElementById("switch12").style.cursor="default"):(document.getElementById("checkbox12").disabled=!1,document.getElementById("switch12").style.cursor="pointer"));var q=document.getElementById("checkbox0").checked,r=(document.getElementById("row5").disabled=1==q,document.getElementById("checkbox1").checked),s=(document.getElementById("row6").disabled=1==r,document.getElementById("row3").disabled=1==q||1==r,document.getElementById("checkbox2").checked);document.getElementById("row7").disabled=1==s,document.getElementById("row4").disabled=1==r||1==s;for(var i=0;i<numberOfGestures;i++){var x=document.getElementById("row"+i).value,t=document.getElementById("row"+i).disabled,t=(1!=x||1==t?(document.getElementById("MIDIrow"+i).disabled=!0,document.getElementById("channel"+i).disabled=!0,document.getElementById("byte2_"+i).disabled=!0,document.getElementById("byte3_"+i).disabled=!0):(document.getElementById("MIDIrow"+i).disabled=!1,document.getElementById("channel"+i).disabled=!1,document.getElementById("byte2_"+i).disabled=!1,document.getElementById("byte3_"+i).disabled=!1),document.getElementById("MIDIrow"+i).value),z=(2==t&&(document.getElementById("byte3_"+i).disabled=!0),2<t&&(document.getElementById("byte2_"+i).disabled=!0,document.getElementById("byte3_"+i).disabled=!0),document.getElementById("row"+i).value),q=(((0==t||4.1<version&&1==t)&&i<3&&1==x||(1.4<version||"Unknown"==version)&&i<3&&(5==z||6==z||10==z||11==z))&&(document.getElementById("checkbox"+i).disabled=!1,document.getElementById("switch"+i).style.cursor="pointer"),!((0!=t&&version<=4.1||4.1<version&&1<t)&&i<3||i<3&&(0==x||1<x))||(1.4<version||"Unknown"==version)&&i<3&&(5==z||6==z||10==z||11==z)||(document.getElementById("checkbox"+i).disabled=!0,document.getElementById("switch"+i).style.cursor="default",document.getElementById("checkbox"+i).checked=!1),document.getElementById("checkbox0").checked),r=(document.getElementById("row5").disabled=1==q,document.getElementById("checkbox1").checked),s=(document.getElementById("row6").disabled=1==r,document.getElementById("row3").disabled=1==q||1==r,document.getElementById("checkbox2").checked);document.getElementById("row7").disabled=1==s,document.getElementById("row4").disabled=1==r||1==s}z=$("#fingeringSelect0 option:selected").text(),document.getElementById("fingeringLabel1").innerHTML=z,z=$("#fingeringSelect1 option:selected").text(),document.getElementById("fingeringLabel2").innerHTML=z,z=$("#fingeringSelect2 option:selected").text();document.getElementById("fingeringLabel3").innerHTML=z}function MIDIvalueChange(){for(var i=0;i<numberOfGestures;i++)((x=document.getElementById("channel"+i).value)<0||16<x||isNaN(x))&&!document.getElementById("channel"+i).disabled&&(alert("Value must be 1-16."),document.getElementById("channel"+i).value=null);for(var j=0;j<numberOfGestures;j++){var y=document.getElementById("channel"+j).value;((x=document.getElementById("byte2_"+j).value)<0||127<x||isNaN(x))&&(alert("Value must be 0-127."),document.getElementById("byte2_"+j).value=null),7==y&&101<x&&x<120&&(alert("This CC range on channel 7 is reserved for the Configuration Tool."),document.getElementById("byte2_"+j).value=null)}for(var x,k=0;k<numberOfGestures;k++)((x=document.getElementById("byte3_"+k).value)<0||127<x||isNaN(x))&&(alert("Value must be 0-127."),document.getElementById("byte3_"+k).value=null)}poweroffSlider.addEventListener("input",poweroffSliderChange);var AudioContextFunc=window.AudioContext||window.webkitAudioContext,audioContext=new AudioContextFunc,player=new WebAudioFontPlayer;function topNavFunction(){var x=document.getElementById("myTopnav");"topnav"===x.className?x.className+=" responsive":x.className="topnav"}function sleep(ms){return new Promise(resolve=>setTimeout(resolve,ms))}function importPreset(context){var reader;WARBLout?context.files&&0!=context.files.length&&(context.files[0].name.replace(".warbl","").replace(".WARBL",""),document.getElementById("modal14-title").innerHTML="Importing: "+context.files[0].name,document.getElementById("modal14-ok").style.opacity=.001,modal(14),(reader=new FileReader).onload=async function(){try{var theImportObject=JSON.parse(reader.result)}catch(e){return void(document.getElementById("modal14-title").innerHTML="Error: File is not a WARBL Preset")}if(theImportObject)if(theImportObject.signature&&"WARBL"==theImportObject.signature)if(theImportObject.version)if(1<theImportObject.version)document.getElementById("modal14-title").innerHTML="Error: WARBL Preset Version "+theImportObject.version+" not supported by this version of the configuration tool",document.getElementById("modal14-ok").style.opacity=1;else if(40<theImportObject.messages[0][2]&&version<4||theImportObject.messages[0][2]<40&&4<version)document.getElementById("modal14-title").innerHTML="Sorry, it is not possible to import settings from the original WARBL to WARBL2 or vice versa.",document.getElementById("modal14-ok").style.opacity=1;else{var i,nMessages=theImportObject.messages.length,byte1=(theImportObject.messages[0][0],theImportObject.messages[0][1]),byte2=theImportObject.messages[0][2],exportedInstrument=(sendToWARBL(byte1,byte2),await sleep(10),theImportObject.messages[10][2]-60),targetInstrument=30+instrument,targetKey=111+instrument;switch(exportedInstrument){case 0:theImportObject.messages[1][0],sendToWARBL(byte1=theImportObject.messages[1][2],byte2=targetInstrument),await sleep(10),theImportObject.messages[2][0],sendToWARBL(byte1=theImportObject.messages[2][1],byte2=theImportObject.messages[2][2]),await sleep(10),theImportObject.messages[3][0],sendToWARBL(byte1=targetKey,byte2=theImportObject.messages[3][2]),await sleep(10);break;case 1:theImportObject.messages[4][0],sendToWARBL(byte1=theImportObject.messages[4][1],byte2=targetInstrument),await sleep(10),theImportObject.messages[5][0],sendToWARBL(byte1=theImportObject.messages[5][1],byte2=theImportObject.messages[5][2]),await sleep(10),theImportObject.messages[6][0],sendToWARBL(byte1=targetKey,byte2=theImportObject.messages[6][2]),await sleep(10);break;case 2:theImportObject.messages[7][0],sendToWARBL(byte1=theImportObject.messages[7][1],byte2=targetInstrument),await sleep(10),theImportObject.messages[8][0],sendToWARBL(byte1=theImportObject.messages[8][1],byte2=theImportObject.messages[8][2]),await sleep(10),theImportObject.messages[9][0],sendToWARBL(byte1=targetKey,byte2=theImportObject.messages[9][2]),await sleep(10)}for(i=12;i<nMessages;++i)theImportObject.messages[i][0],sendToWARBL(byte1=theImportObject.messages[i][1],byte2=theImportObject.messages[i][2]),await sleep(10);setTimeout(function(){sendToWARBL(MIDI_CC_102,MIDI_ENTER_COMM_MODE),document.getElementById("modal14-title").innerHTML="Preset Import Complete!",document.getElementById("modal14-ok").style.opacity=1,setTimeout(function(){$("#importPreset").val("")},1e3)},500)}else document.getElementById("modal14-title").innerHTML="Error: File is not a WARBL Preset";else document.getElementById("modal14-title").innerHTML="Error: File is not a WARBL Preset";else document.getElementById("modal14-title").innerHTML="Error: File is not a WARBL Preset"},reader.readAsText(context.files[0])):(document.getElementById("modal14-title").innerHTML="Preset import only allowed when WARBL is connected",document.getElementById("modal14-ok").style.opacity=1,modal(14))}function exportPreset(){var nMessages,theExportObject;WARBLout?(nMessages=0,theExportObject={signature:"WARBL",version:1,messages:[]},gExportProxy=function(byte0,byte1,byte2){var a;theExportObject.messages.push([byte0,byte1,byte2]),135==++nMessages&&(byte0=JSON.stringify(theExportObject),gExportProxy=null,byte1=byte0,byte2="WARBL_Preset.warbl",byte0="text/plain",a=document.createElement("a"),byte1=new Blob([byte1],{type:byte0}),a.href=URL.createObjectURL(byte1),a.download=byte2,a.click(),URL.revokeObjectURL(a.href),document.getElementById("modal14-title").innerHTML="Preset Export Complete!",document.getElementById("modal14-ok").style.opacity=1,modal(14))},sendToWARBL(MIDI_CC_102,MIDI_ENTER_COMM_MODE)):(document.getElementById("modal14-title").innerHTML="Preset export only allowed when WARBL is connected",document.getElementById("modal14-ok").style.opacity=1,modal(14))}function capturePressure(val){gCurrentPressure=val}function graphPressure(){gPressureReadings.pop(),gPressureReadings.unshift(gCurrentPressure),$("#d3PressureGraph").empty();var margin_top=10,margin_right=10,margin_bottom=100,margin_left=50,height=320-margin_top-margin_bottom,margin_right=d3.select("#d3PressureGraph").append("svg").attr("width",390+margin_left+margin_right).attr("height",height+margin_top+margin_bottom).append("g").attr("transform","translate("+margin_left+","+margin_top+")"),margin_bottom=d3.scaleLinear().domain([0,390]).range([0,390]),margin_top=(margin_right.append("g").attr("transform","translate(0,"+height+")").call(d3.axisBottom(margin_bottom).tickSize(0).tickFormat("")),d3.scaleLinear().domain([0,gMaxPressure]).range([height,0])),xScale=(margin_right.append("g").call(d3.axisLeft(margin_top)),margin_right.append("text").attr("y",4+height).attr("x",195-margin_left/2+10).attr("dy","1em").style("text-anchor","middle").style("fill","white").text("Time"),margin_right.append("text").attr("transform","rotate(-90)").attr("y",0-(margin_left-5)).attr("x",0-height/2).attr("dy","1em").style("text-anchor","middle").style("fill","white").text("Inches of HO"),d3.scaleLinear().domain([0,gNPressureReadings-1]).range([0,390])),yScale=d3.scaleLinear().domain([0,gMaxPressure]).range([height,0]),margin_bottom=d3.line().x(function(d,i){return xScale(i)}).y(function(d){return yScale(d.y)}).curve(d3.curveMonotoneX),margin_top=d3.range(gNPressureReadings).map(function(d){return{y:gPressureReadings[d]}});margin_right.append("path").datum(margin_top).attr("class","pressureline").attr("d",margin_bottom)}function startPressureGraph(){var i;for(gPressureGraphEnabled=!0,gPressureReadings=[],i=gCurrentPressure=0;i<gNPressureReadings;++i)gPressureReadings.push(0);gGraphInterval=setInterval(graphPressure,100)}function stopPressureGraph(){gPressureGraphEnabled=!1,clearInterval(gGraphInterval),$("#d3PressureGraph").empty()}player.loader.decodeAfterLoading(audioContext,"_tone_0650_SBLive_sf2");

var sendDelay=15
var mapSelection;var IMUmapSelection;var IMUpitchSelection;var center=[1,1,1,1];var IMUchannel=[1,1,1];var IMUnumber=[2,2,2];var curve=[0,0,0,0];var pressureShakeMod=[0,0,0];var pressureShakeDepth=[0,0,0];var pressureShakeModMode=[0,0,0];var inputSliderMin=[0,0,0,0,-90,-90,-90];var inputSliderMax=[100,100,100,100,90,90,90];var outputSliderMin=[0,0,0,0,0,0,0];var outputSliderMax=[127,127,127,127,127,127,127];var halfHoles=255;var halfholesLow4bits;var halfholesHigh4bits;var IMURolltoPitchSettingsDefaults=[11,25,16,20,14,114,1,64,64];var IMUElevationtoPitchSettingsDefaults=[4,19,9,14,14,114,1,64,64];var IMUYawtoPitchSettingsDefaults=[14,22,17,19,14,114,1,64,64];var IMUtoPitchSettingsRoll=[0,36,9,27,39,114,0,64,64];var IMUtoPitchSettingsPitch=[0,36,9,27,39,114,0,64,64];var IMUtoPitchSettingsYaw=[0,36,9,27,39,114,0,64,64];var consoleEntries=0;var customFingeringFills=[[null,null,null,null,null,null,null,null,null,null,null],[0,74,73,72,71,69,67,66,64,62,61],[0,74,72,72,70,68,67,65,64,62,61],[0,74,74,72,72,69,68,67,65,62,60]];var communicationMode=!1;var noteNames=["C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C","C#","D","Eb","E","F","F#","G"];var noteNamesforKeySelect=["G#","A","Bb","B","C3","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C4","C#","D","Eb","E","F","F#","G","G#","A","Bb","B","C5","C#","D","Eb","F","F#","G","G#","A"];var notePlaying=-1;var numberOfGestures=10;var midiNotes=[];var currentVersion=45;var currentVersionOriginal=21;var previousVersion=0;var midiAccess=null;var WARBLout=null;var WARBLin=null;var midiConnecting=!1;var midiScanningOut=null;var selectedMidiOutId=0;var gExportProxy=null;var gPressureGraphEnabled=!1;var gCurrentPressure=0.0;var gGraphInterval=null;var gNPressureReadings=100;var gMaxPressure=25;var gPressureReadings=[];var on,off;var deviceName;var volume=0;var currentNote=62;var sendAllQueue=[];var sendWARBLoutQueue=[];var sendWARBLInterval=setInterval(sendQueuedWARBLoutMessages,sendDelay);var sendAllInterval=setInterval(sendAllQueuedMessages,sendDelay);var sensorValue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var buttonRowWrite;var jumpFactorWrite;var fingeringWrite;var exprlowsliderHandleSetting;var exprhighsliderHandleSetting;var WARBL2SettingsReceive;var version="Unknown";var instrument=0;var lsb=0;var connIntvlLSB=0;var defaultInstr=0;var modals=new Array();for(var w=1;w<=31;w++){modals[w]=document.getElementById("open-modal"+w)}
updatePlatform();exprlowbendslider.noUiSlider.disable(1);exprhighbendslider.noUiSlider.disable(1);IMUlowbendslider.noUiSlider.disable(1);IMUhighbendslider.noUiSlider.disable(1);window.onclick=function(event){for(var i=1;i<=31;i++){if(event.target==modals[i]){modalclose(i)}}
event.stopPropagation()}
window.addEventListener('load',function(){WARBLout=null;WARBLin=null;updateCells();for(var i=1;i<13;i++){var k=document.getElementById("jumpFactor"+(i));k.dispatchEvent(new Event('input'));if(i==10){var k=document.getElementById("jumpFactor10b");k.dispatchEvent(new Event('input'))}}
depth.dispatchEvent(new Event('input'));slidelimit.dispatchEvent(new Event('input'));$(".volume").click(function(){toggleOn()});if(navigator.requestMIDIAccess)
navigator.requestMIDIAccess({sysex:!1}).then(onMIDIInit,onMIDIReject);else alert("Your browser does not support MIDI. Please use Chrome or Opera, or the free WARBL iOS app.")});function updatePlatform(){let newdisp=(platform=="app"||platform=="app2")?"none":"block";document.getElementById("myTopnav").style.display=newdisp;document.getElementById("topLogo").style.display=newdisp;document.getElementById("importExportTopWrapper").style.display=newdisp;if(platform=="app"){document.getElementById("headerbuttonwrapper").style.top="280px";document.getElementById("headerbuttonwrapper2").style.top="280px";document.getElementById("headerbuttonwrapper3").style.top="280px"}
let newdispleg=(platform=="app")?"none":"block";document.getElementById("midiSelector").style.display=newdispleg;document.getElementById("tinyDeviceLabel").style.display=newdispleg}
function showWARBLNotDetected(){communicationMode=!1;document.getElementById("status").innerHTML="WARBL not detected.";document.getElementById("status").style.color="#F78339";document.getElementById("version").style.color="#F78339";document.getElementById("connect").innerHTML="Connect to WARBL";document.getElementById("pressure").innerHTML="";document.getElementById("connLabel").innerHTML="BLE not connected";document.getElementById("connLabel").style.left="95px";for(var m=0;m<9;m++){document.getElementById("dot"+m).style.backgroundColor="#333";if(m==0){document.getElementById("dot0").style.opacity="0"}}}
function showWARBLUnknown(){document.getElementById("version").innerHTML="Unknown";document.getElementById("current").style.visibility="hidden";document.getElementById("status").style.visibility="visible";document.getElementById("connect").innerHTML="Connect to WARBL"}
function updateMidiDeviceSelector(){if(midiAccess){var selector=document.getElementById("midiDeviceSelector");selector.length=0;var autoelement=document.createElement("option");autoelement.value=0;autoelement.text="Auto";selector.append(autoelement);var iter=midiAccess.outputs.values();var currSelectionExists=!1;for(var o=iter.next();!o.done;o=iter.next()){if(o.value){var element=document.createElement("option");if(o.value.id){element.value=o.value.id;if(o.value.id==selectedMidiOutId){currSelectionExists=!0}}
element.text=o.value.name;selector.append(element)}}
if(WARBLout){selector.value=WARBLout.id}else if(currSelectionExists){selector.value=selectedMidiOutId}else{selector.value=0}}}
function midiDeviceSelected(value){console.log("Midi device selected: "+value);selectedMidiOutId=value;startMidiConnect()}
function enableMidiInputForOnly(portid){if(midiAccess){var inputs=midiAccess.inputs.values();for(var input=inputs.next();input&&!input.done;input=inputs.next()){if(input.value.id==portid){input.value.onmidimessage=WARBL_Receive}else{input.value.onmidimessage=null}}}}
function enableMidiInputsForAll(){if(midiAccess){var inputs=midiAccess.inputs.values();for(var input=inputs.next();input&&!input.done;input=inputs.next()){input.value.onmidimessage=WARBL_Receive;if(platform=="app"){input.value.onstatechange=function(event){var port=event.port;console.log("MIDIInputPort onstatechange name:"+port.name+" connection:"+port.connection+" state:"+port.state);if(port.state=="disconnected"){setToDisconnected()}}}}
console.log("Number midi inputs: "+midiAccess.inputs.size);return midiAccess.inputs.size>0}else{return!1}}
function connect(){if(communicationMode&&version>2.0){console.log("DISCONNECTING");if(version<4.1){var cc=buildMessage(MIDI_CC_102,MIDI_CC_102_VALUE_99)}else{var cc=buildMessage(MIDI_CC_102,MIDI_CC_102_VALUE_104)}
if(WARBLout&&WARBLout!=1){WARBLout.send(cc)}
setToDisconnected();enableMidiInputForOnly(0)}else{startMidiConnect()}}
async function startMidiConnect(){setToDisconnected();console.log("startMidiConnect");var outputId=document.getElementById("midiDeviceSelector").value;var isAutoMode=outputId==0;enableMidiInputsForAll();var cc=buildMessage(MIDI_CC_102,MIDI_ENTER_COMM_MODE);midiConnecting=!0;var iter=midiAccess.outputs.values();for(var o=iter.next();!o.done;o=iter.next()){if(!communicationMode){if((outputId==0||o.value.id==outputId)&&o.value.name.includes("WARBL")){console.log("Attempting connect to "+o.value.name+" id: "+o.value.id)
midiScanningOut=o.value;o.value.send(cc)}else{continue}}else{break}
await sleep(250)}
if(!communicationMode){var iter=midiAccess.outputs.values();for(var o=iter.next();!o.done;o=iter.next()){if(!communicationMode){if((outputId==0||o.value.id==outputId)&&!o.value.name.includes("WARBL")){console.log("Attempting connect to "+o.value.name+" id: "+o.value.id)
midiScanningOut=o.value;o.value.send(cc)}else{continue}}else{break}
await sleep(250)}}
midiScanningOut=null;midiConnecting=!1;if(!communicationMode){console.log("Could not detect any connected WARBLs");enableMidiInputForOnly(0);showWARBLNotDetected()}}
async function onMIDIInit(midi){midiAccess=midi;midi.onstatechange=midiOnStateChange;WARBLout=null;WARBLin=null;var foundMIDIInputDevice=enableMidiInputsForAll();updateMidiDeviceSelector();if(foundMIDIInputDevice){console.log("trying initial connect");startMidiConnect()}else{console.log("no inputs");showWARBLNotDetected()}}
function onMIDIReject(err){alert("The MIDI system failed to start. Please refresh the page.")}
function setToDisconnected(){showWARBLNotDetected();showWARBLUnknown();WARBLout=null;WARBLin=null;communicationMode=!1;document.getElementById("connect").innerHTML="Connect to WARBL"}
function midiOnStateChange(event){console.log("midi state change");if(WARBLout){var iter=midiAccess.outputs.values();var foundit=!1;for(var o=iter.next();!o.done;o=iter.next()){console.log("Searching out "+o.value.id+"  wout: "+WARBLout.id);if(o.value==WARBLout){foundit=!0;break}}
if(!foundit){selectedMidiOutId=0;setToDisconnected();enableMidiInputForOnly(0)}}
updateMidiDeviceSelector()}
function setPing(){setTimeout(function(){ping=1},3000)}
function buildMessage(byte2,byte3){if(!(byte2==MIDI_CC_102&&byte3==MIDI_START_CALIB)&&!(byte2==MIDI_CC_106&&byte3==MIDI_CALIB_BELL_SENSOR)){blink(1)}
if(byte2==MIDI_CC_102){if(byte3==MIDI_SAVE_CALIB){blink(3);for(var i=1;i<10;i++){document.getElementById("v"+(i)).innerHTML="0"}
for(var i=0;i<19;i++){sensorValue[i]=0}}
if(isEven(byte3)&&byte3<=MIDI_CALIB_MSGS_END){sensorValue[byte3-2]++;document.getElementById("v"+(byte3>>1)).innerHTML=sensorValue[byte3-2]}
if(isOdd(byte3)&&byte3<=MIDI_CALIB_MSGS_END){sensorValue[byte3-1]--;document.getElementById("v"+((byte3+1)>>1)).innerHTML=sensorValue[byte3-1];checkMax((byte3+1)>>1)}}
cc=[0xB6,byte2,byte3];return cc}
function sendToAll(byte2,byte3){var cc=buildMessage(byte2,byte3);sendAllQueue.push(cc);if(!sendAllInterval){sendAllInterval=setInterval(sendAllQueuedMessages,sendDelay)}}
function sendToWARBL(byte2,byte3){if(communicationMode){if(platform=="app"){var cc=buildMessage(byte2,byte3);sendAllQueue.push(cc);if(!sendAllInterval){sendAllInterval=setInterval(sendAllQueuedMessages,sendDelay)}}else{if(!WARBLout){console.error("sendToWARBL: No MIDI port selected!")
return}
var cc=buildMessage(byte2,byte3);if(MIDI_DEBUG){console.log("sendToWARBL",byte2,byte3)}
sendWARBLoutQueue.push(cc);if(!sendWARBLInterval){sendWARBLInterval=setInterval(sendQueuedWARBLoutMessages,sendDelay)}}}}
function sendQueuedWARBLoutMessages(){if(sendWARBLoutQueue.length>0){var cc=sendWARBLoutQueue.shift();WARBLout.send(cc)}else{clearInterval(sendWARBLInterval);sendWARBLInterval=null}}
function sendAllQueuedMessages(){if(sendAllQueue.length>0){var cc=sendAllQueue.shift();var iter=midiAccess.outputs.values();for(var o=iter.next();!o.done;o=iter.next()){o.value.send(cc)}}else{clearInterval(sendAllInterval);sendAllInterval=null}}
function WARBL_Receive(event,source){var data0=event.data[0];var data1=event.data[1];var data2=event.data[2];if(gExportProxy){gExportProxy(data0,data1,data2);return}
source=event.target!=null?event.target:source;if((!WARBLout||!WARBLin)&&((data0&0x0F)==MIDI_CONFIG_TOOL_CHANNEL-1)&&((data0&0xf0)==176)&&(data1==MIDI_CC_110)){console.log("Platform: "+platform);if(platform=="app"){console.log("Legacy app connection");WARBLout=1;WARBLin=source}else{console.log("midiScanningOut: "+midiScanningOut+" id: "+midiScanningOut.id);if(!WARBLout&&midiScanningOut){WARBLout=midiScanningOut;selectedMidiOutId=WARBLout.id}
WARBLin=source;if(WARBLout&&WARBLin){console.log("Connected WARBL!")
console.log(WARBLin);enableMidiInputForOnly(WARBLin.id);updateMidiDeviceSelector()}}}
if(WARBLout!=1&&(!WARBLin||WARBLin!=source)){console.log("Ignoring midi message from unconnected device");return}
var e;var f;var g;if(isNaN(data2)){f=" "}else{f=data2}
if((data0&0xf0)==144){e="On"}
if((data0&0xf0)==128){e="Off"}
if((data0&0xf0)==176){e="CC"}
if((data0&0xf0)==224){e="PB"}
if((data0&0xf0)==192){e="PC"}
if((data0&0xf0)==208){e="CP"}
if((data0&0xf0)==160){e="KP"}
if(e=="PB"){var pitch=((data1+(data2<<7)))-8192;document.getElementById('receivedPB').innerHTML=pitch;var pitchcents=100*(pitch/8192.0)*document.getElementById("midiBendRange").value;document.getElementById('receivedPBCents').innerHTML=(pitchcents>0?"+":"")+pitchcents.toFixed(0);var barHeight=pitch/81.92;var heightPixels=65-(barHeight/100*65)+"px";var markerTopPixels=65-(barHeight/100*65)+90+"px";document.getElementById("PBmarker").style.top=markerTopPixels;if(pitch<0){document.getElementById("PBlevel").style.height=-barHeight+"%";document.getElementById("topPBlevel").style.height=0+"%"}else if(pitch>0){document.getElementById("PBlevel").style.height=0+"%";document.getElementById("topPBlevel").style.height=barHeight+"%";document.getElementById("topPBlevel").style.top=heightPixels}else{document.getElementById("PBlevel").style.height=0+"%";document.getElementById("topPBlevel").style.height=0+"%"}}
var IMUchan=document.getElementById('IMUChannelInput').value;var IMUCC=document.getElementById('IMUCC').value;if(e=="CC"&&(parseFloat(data0&0x0f)+1==IMUchan)&&data1==IMUCC){document.getElementById('receivedCC').innerHTML=data2;var barWidth=data2/1.27;document.getElementById("CClevel").style.width=barWidth+"%"}
if(mapSelection==0){var IMUchan=document.getElementById('pressureChannel').value;var IMUCC=document.getElementById('pressureCC').value;if(e=="CC"&&(parseFloat(data0&0x0f)+1==IMUchan)&&data1==IMUCC){document.getElementById('receivedpressureCC').innerHTML=data2;var barWidth=data2/1.27;document.getElementById("CCpressurelevel").style.width=barWidth+"%"}}
if(mapSelection==1){if(e=="On"){document.getElementById('receivedpressureCC').innerHTML=data2;var barWidth=data2/1.27;document.getElementById("CCpressurelevel").style.width=barWidth+"%"}}
if(mapSelection==2){if(e=="CP"){document.getElementById('receivedpressureCC').innerHTML=data1;var barWidth=data1/1.27;document.getElementById("CCpressurelevel").style.width=barWidth+"%"}}
if(mapSelection==3){if(e=="KP"){document.getElementById('receivedpressureCC').innerHTML=data2;var barWidth=data2/1.27;document.getElementById("CCpressurelevel").style.width=barWidth+"%"}}
if(!(e=="CC"&&(parseFloat(data0&0x0f)==MIDI_CONFIG_TOOL_CHANNEL-1))){consoleEntries++;if(consoleEntries<301){document.getElementById("console").innerHTML+=(e+" "+((data0&0x0f)+1)+" "+data1+" "+f);document.getElementById("console").innerHTML+="<br>"}else if(consoleEntries==301){document.getElementById("console").innerHTML+="max lines reached"}
var elem2=document.getElementById("console");elem2.scrollTop=elem2.scrollHeight}
switch(data0&0xf0){case 0x90:if(data2!=0){noteOn(data1);notePlaying=data1;logKeys;document.getElementById("tinyConsole").value=noteNames[data1-1]+" "+data1;return}
case 0x80:noteOff(data1);logKeys;if(notePlaying==data1){document.getElementById("tinyConsole").value="";notePlaying=-1}
return;case 0xB0:if(MIDI_DEBUG){console.log("From WARBL",data1,data2)}
if(parseFloat(data0&0x0f)==MIDI_CONFIG_TOOL_CHANNEL-1){if(data1==MIDI_CC_115){var byteA=data2;for(var m=0;m<7;m++){if(bit_test(byteA,m)==1){document.getElementById("dot"+m).style.backgroundColor="blue";if(m==0){document.getElementById("dot0").style.opacity="0.8"}}else{document.getElementById("dot"+m).style.backgroundColor="#333";if(m==0){document.getElementById("dot0").style.opacity="0"}}}}
if(data1==MIDI_CC_114){for(var n=0;n<2;n++){var byteB=data2;if(bit_test(byteB,n)==1){document.getElementById("dot"+(7+n)).style.backgroundColor="blue"}else{if(n==1){document.getElementById("dot"+(7+n)).style.backgroundColor="#181818"}
if(n==0){document.getElementById("dot"+(7+n)).style.backgroundColor="#333"}}}}else if(data1==MIDI_CC_102){if(data2>=MIDI_MAX_CALIB_MSGS_START&&data2<=MIDI_MAX_CALIB_MSGS_END){document.getElementById("v"+(data2-MIDI_MAX_CALIB_MSGS_START-1)).innerHTML="MAX";checkMax((data2-MIDI_MAX_CALIB_MSGS_START-1))}
for(var i=0;i<3;i++){if(data2==MIDI_FINGERING_PATTERN_MODE_START+i){fingeringWrite=i}
if((data2>=MIDI_FINGERING_PATTERN_START&&data2<=MIDI_FINGERING_PATTERN_END)){if(fingeringWrite==i){document.getElementById("fingeringSelect"+i).value=data2-MIDI_FINGERING_PATTERN_START}
updateCells()}
if((data2>=MIDI_CUST_FINGERING_PATTERN_START&&data2<=MIDI_CUST_FINGERING_PATTERN_END)&&version>3.9){if(fingeringWrite==i){document.getElementById("fingeringSelect"+i).value=data2-MIDI_FINGERING_PATTERN_START}
updateCells()}}
if(data2==MIDI_CURRENT_MODE_START){document.getElementById("fingering0").checked=!0;instrument=0;document.getElementById("instrument0").style.display="block";document.getElementById("instrument1").style.display="none";document.getElementById("instrument2").style.display="none";document.getElementById("key0").style.display="block";document.getElementById("key1").style.display="none";document.getElementById("key2").style.display="none";advancedOkay();pressureOkay();updateCells();advancedOkayPB();okayCCmap();okayIMUmap();okayPitchRegistermap();okayOverride();okayIMUPitchbend();backIMU();backPressure();handleDefault();customFingeringOkay()}
if(data2==MIDI_CURRENT_MODE_START+1){document.getElementById("fingering1").checked=!0;instrument=1;document.getElementById("instrument0").style.display="none";document.getElementById("instrument1").style.display="block";document.getElementById("instrument2").style.display="none";document.getElementById("key0").style.display="none";document.getElementById("key1").style.display="block";document.getElementById("key2").style.display="none";advancedOkay();pressureOkay();updateCells();advancedOkayPB();okayCCmap();okayIMUmap();okayPitchRegistermap();okayOverride();okayIMUPitchbend();backIMU();backPressure();handleDefault();customFingeringOkay()}
if(data2==MIDI_CURRENT_MODE_START+2){document.getElementById("fingering2").checked=!0;instrument=2;document.getElementById("instrument0").style.display="none";document.getElementById("instrument1").style.display="none";document.getElementById("instrument2").style.display="block";document.getElementById("key0").style.display="none";document.getElementById("key1").style.display="none";document.getElementById("key2").style.display="block";advancedOkay();pressureOkay();updateCells();advancedOkayPB();okayCCmap();okayIMUmap();okayPitchRegistermap();okayOverride();okayIMUPitchbend();backIMU();backPressure();handleDefault();customFingeringOkay()}
for(var i=0;i<3;i++){if(data2==MIDI_DEFAULT_MODE_START+i){defaultInstr=i;handleDefault()}}
for(var i=0;i<4;i++){if(data2==MIDI_PB_MODE_START+i){document.getElementById("pitchbendradio"+i.toString()).checked=!0;updateCustom();updateCustom()}}
for(var i=0;i<4;i++){if(data2==MIDI_BREATH_MODE_START+i){document.getElementById("sensorradio"+i.toString()).checked=!0;if(i==1){updateExpressionSliderEnableState()}}}
if(data2==MIDI_CC_102_VALUE_121){document.getElementById("bellSensor").style.opacity=1;document.getElementById("1").disabled=!1;document.getElementById("2").disabled=!1;document.getElementById("v1").classList.add("sensorValueEnabled")}
if(data2==MIDI_CC_102_VALUE_120){document.getElementById("bellSensor").style.opacity=0.1;document.getElementById("1").disabled=!0;document.getElementById("2").disabled=!0;document.getElementById("v1").classList.remove("sensorValueEnabled")}
for(var i=0;i<numberOfGestures;i++){if(data2==MIDI_GESTURE_START+i){buttonRowWrite=i}}
for(var j=0;j<numberOfGestures;j++){if(buttonRowWrite==j){if(data2==119){document.getElementById("row"+(buttonRowWrite)).value=19}
for(var k=0;k<12;k++){if(data2==(100+k)&&version<4.0){document.getElementById("row"+(buttonRowWrite)).value=k}
if(k<7&&data2==MIDI_ACTION_MIDI_START+k){document.getElementById("MIDIrow"+(buttonRowWrite)).value=k;updateCells()}}}}
for(var l=0;l<3;l++){if(buttonRowWrite==l){if(data2==MIDI_MOMENTARY_OFF){document.getElementById("checkbox"+l).checked=!1}
if(data2==MIDI_MOMENTARY_ON){document.getElementById("checkbox"+l).checked=!0}}}}else if(data1==MIDI_CC_103){document.getElementById("senseDistance").value=0-data2}else if(data1==MIDI_CC_117){document.getElementById("depth").value=data2+1;var output=document.getElementById("demo14");depth.dispatchEvent(new Event('input'));output.innerHTML=data2+1}else if(data1==MIDI_CC_104){jumpFactorWrite=data2}else if(data1==MIDI_CC_109&&data2!=MIDI_CUSTOM_CHARTS_RCVD){jumpFactorWrite=data2+MIDI_CC_109_OFFSET}else if(data1==MIDI_CC_109&&data2==MIDI_CUSTOM_CHARTS_RCVD){document.getElementById("sending").innerHTML="Success!";document.getElementById("WARBL2CustomSuccessOkay").style.display="block";document.getElementById('WARBL2customFingeringFill').value='10';document.getElementById("WARBL2CustomTextArea").value=''}else if(data1==MIDI_CC_105&&jumpFactorWrite<=MIDI_PRESS_SELECT_VARS_END){document.getElementById("jumpFactor"+jumpFactorWrite).value=data2;if(jumpFactorWrite==MIDI_CC_104_VALUE_10){document.getElementById("jumpFactor10b").value=data2}
for(var i=1;i<=MIDI_PRESS_SELECT_VARS_END;i++){var k=document.getElementById("jumpFactor"+(i));k.dispatchEvent(new Event('input'));if(i==MIDI_CC_104_VALUE_10){var k=document.getElementById("jumpFactor10b");k.dispatchEvent(new Event('input'))}}}
if(data1==MIDI_CC_105){if(jumpFactorWrite==MIDI_ED_VARS_START){document.getElementById("checkbox6").checked=data2}else if(jumpFactorWrite==MIDI_ED_VARS_START+1){document.getElementById("expressionDepth").value=data2}else if(jumpFactorWrite==MIDI_ED_VARS_START+2){document.getElementById("checkbox7").checked=data2;updateCustom()}else if(jumpFactorWrite==MIDI_ED_VARS_START+3){curve[0]=data2}else if(jumpFactorWrite==MIDI_ED_VARS_START+4){document.getElementById("pressureChannel").value=data2}else if(jumpFactorWrite==MIDI_ED_VARS_START+5){document.getElementById("pressureCC").value=data2}else if(jumpFactorWrite==MIDI_ED_VARS_START+6){inputSliderMin[0]=data2;slider.noUiSlider.set([data2,null])}else if(jumpFactorWrite==MIDI_ED_VARS_START+7){inputSliderMax[0]=data2;slider.noUiSlider.set([null,data2])}else if(jumpFactorWrite==MIDI_ED_VARS_START+8){outputSliderMin[0]=data2;slider2.noUiSlider.set([data2,null])}else if(jumpFactorWrite==MIDI_ED_VARS_START+9){outputSliderMax[0]=data2;slider2.noUiSlider.set([null,data2])}else if(jumpFactorWrite==MIDI_ED_VARS_START+10){document.getElementById("dronesOnCommand").value=data2}else if(jumpFactorWrite==MIDI_ED_VARS_START+11){document.getElementById("dronesOnChannel").value=data2}else if(jumpFactorWrite==MIDI_ED_VARS_START+12){document.getElementById("dronesOnByte2").value=data2}else if(jumpFactorWrite==MIDI_ED_VARS_START+13){document.getElementById("dronesOnByte3").value=data2}else if(jumpFactorWrite==MIDI_ED_VARS_START+14){document.getElementById("dronesOffCommand").value=data2}else if(jumpFactorWrite==MIDI_ED_VARS_START+15){document.getElementById("dronesOffChannel").value=data2}else if(jumpFactorWrite==MIDI_ED_VARS_START+16){document.getElementById("dronesOffByte2").value=data2}else if(jumpFactorWrite==MIDI_ED_VARS_START+17){document.getElementById("dronesOffByte3").value=data2}else if(jumpFactorWrite==MIDI_ED_VARS_START+18&&data2==0){document.getElementById("dronesRadio0").checked=!0}else if(jumpFactorWrite==MIDI_ED_VARS_START+18&&data2==1){document.getElementById("dronesRadio1").checked=!0}else if(jumpFactorWrite==MIDI_ED_VARS_START+18&&data2==2){document.getElementById("dronesRadio2").checked=!0}else if(jumpFactorWrite==MIDI_ED_VARS_START+18&&data2==3){document.getElementById("dronesRadio3").checked=!0}else if(jumpFactorWrite==MIDI_ED_VARS_START+19){lsb=data2}else if(jumpFactorWrite==MIDI_ED_VARS_START+20){var x=parseInt((data2<<7)|lsb);x=(x-100)*24/900;var p=x.toFixed(1);p=Math.min(Math.max(p,0),24);document.getElementById("dronesPressureInput").value=p}else if(jumpFactorWrite==MIDI_LEARNED_PRESS_LSB){lsb=data2}else if(jumpFactorWrite==MIDI_LEARNED_PRESS_MSB){var x=parseInt((data2<<7)|lsb);x=(x-100)*24/900;var p=x.toFixed(1);p=Math.min(Math.max(p,0),24);document.getElementById("octavePressureInput").value=p}else if(jumpFactorWrite==MIDI_SWITCHES_VARS_START+3){document.getElementById("checkbox9").checked=data2}else if(jumpFactorWrite==MIDI_SWITCHES_VARS_START+4){document.getElementById("checkbox5").checked=data2;updateCustom()}else if(jumpFactorWrite==MIDI_SWITCHES_VARS_START+2){document.getElementById("checkbox3").checked=data2}else if(jumpFactorWrite==MIDI_SWITCHES_VARS_START){updateSelected();document.getElementById("checkbox4").checked=data2;if(data2==0){document.getElementById("bagBreath0").checked=!0}else{document.getElementById("bagBreath1").checked=!0}}else if(jumpFactorWrite==MIDI_SWITCHES_VARS_START+1){document.getElementById("checkbox8").checked=data2}else if(jumpFactorWrite==MIDI_SWITCHES_VARS_START+5){document.getElementById("checkbox10").checked=data2}else if(jumpFactorWrite==MIDI_SWITCHES_VARS_START+6){document.getElementById("checkbox11").checked=(data2&0x1);document.getElementById("checkbox13").checked=(data2&0x2)}else if(jumpFactorWrite==MIDI_SWITCHES_VARS_START+7){document.getElementById("checkbox12").checked=data2}else if(jumpFactorWrite==MIDI_SWITCHES_VARS_START+8){document.getElementById("checkbox14").checked=data2}else if(jumpFactorWrite==MIDI_SWITCHES_VARS_START+9){document.getElementById("checkbox15").checked=data2}else if(jumpFactorWrite==MIDI_SWITCHES_VARS_START+10){document.getElementById("checkbox16").checked=data2;document.getElementById("overrideExprCheck").checked=data2;updateExpressionSliderEnableState()}else if(jumpFactorWrite==MIDI_SWITCHES_VARS_START+11){document.getElementById("checkbox17").checked=data2}else if(jumpFactorWrite==MIDI_SWITCHES_VARS_START+12){document.getElementById("checkbox18").checked=data2;updateCustom()}else if(jumpFactorWrite==MIDI_SWITCHES_VARS_START+13){document.getElementById("cbDoubleClick").checked=data2;updateDoubleClick()}else if(jumpFactorWrite==MIDI_BEND_RANGE){document.getElementById("midiBendRange").value=data2}else if(jumpFactorWrite==MIDI_MIDI_CHANNEL){document.getElementById("noteChannel").value=data2}else if(jumpFactorWrite==MIDI_ED_VARS2_START){inputSliderMin[1]=data2;slider.noUiSlider.set([data2,null])}else if(jumpFactorWrite==MIDI_ED_VARS2_START+1){inputSliderMax[1]=data2;slider.noUiSlider.set([null,data2])}else if(jumpFactorWrite==MIDI_ED_VARS2_START+2){outputSliderMin[1]=data2;slider2.noUiSlider.set([data2,null])}else if(jumpFactorWrite==MIDI_ED_VARS2_START+3){outputSliderMax[1]=data2;slider2.noUiSlider.set([null,data2])}else if(jumpFactorWrite==MIDI_ED_VARS2_START+4){inputSliderMin[2]=data2;slider.noUiSlider.set([data2,null])}else if(jumpFactorWrite==MIDI_ED_VARS2_START+5){inputSliderMax[2]=data2;slider.noUiSlider.set([null,data2])}else if(jumpFactorWrite==MIDI_ED_VARS2_START+6){outputSliderMin[2]=data2;slider2.noUiSlider.set([data2,null])}else if(jumpFactorWrite==MIDI_ED_VARS2_START+7){outputSliderMax[2]=data2;slider2.noUiSlider.set([null,data2])}else if(jumpFactorWrite==MIDI_ED_VARS2_START+8){inputSliderMin[3]=data2;slider.noUiSlider.set([data2,null])}else if(jumpFactorWrite==MIDI_ED_VARS2_START+9){inputSliderMax[3]=data2;slider.noUiSlider.set([null,data2])}else if(jumpFactorWrite==MIDI_ED_VARS2_START+10){outputSliderMin[3]=data2;slider2.noUiSlider.set([data2,null])}else if(jumpFactorWrite==MIDI_ED_VARS2_START+11){outputSliderMax[3]=data2;slider2.noUiSlider.set([null,data2])}else if(jumpFactorWrite==MIDI_ED_VARS2_START+12){curve[1]=data2}else if(jumpFactorWrite==MIDI_ED_VARS2_START+13){curve[2]=data2}else if(jumpFactorWrite==MIDI_ED_VARS2_START+14){curve[3]=data2}else if(jumpFactorWrite==MIDI_ED_VARS2_START+15){exprlowsliderHandleSetting=data2}else if(jumpFactorWrite==MIDI_ED_VARS2_START+16){if(version<4.3){exprlowslider.noUiSlider.set([exprlowsliderHandleSetting,data2])}else{exprhighsliderHandleSetting=data2}}else if(version<4.0&&jumpFactorWrite>=MIDI_CC_104_VALUE_87&&jumpFactorWrite<=MIDI_ED_VARS2_END){document.getElementById("fingeringInput"+(jumpFactorWrite-86)).value=data2}else if(jumpFactorWrite==MIDI_ED_VARS2_START+17){document.getElementById("slidelimit").value=data2;var output=document.getElementById("demo18");depth.dispatchEvent(new Event('input'));output.innerHTML=data2}else if(jumpFactorWrite==MIDI_ED_VARS2_START+18){if(version>=4.3){exprlowslider.noUiSlider.set([exprlowsliderHandleSetting,data2])}}else if(jumpFactorWrite==MIDI_ED_VARS2_START+19){exprhighslider.noUiSlider.set([data2,exprhighsliderHandleSetting])}else if(jumpFactorWrite==MIDI_ED_VARS2_START+20){exprlowbendslider.noUiSlider.set([data2])}else if(jumpFactorWrite==MIDI_ED_VARS2_START+21){exprhighbendslider.noUiSlider.set([data2])}else if(jumpFactorWrite==MIDI_ED_VARS2_START+22){document.getElementById("exprfixedcenterslider").value=data2;updateExpressionCenterPressureLabel()}else if(jumpFactorWrite==MIDI_ED_VARS2_START+23){document.getElementById("clampExprCheck").checked=data2}else if(jumpFactorWrite==MIDI_ED_VARS2_START+24){document.getElementById("exprcurvelowslider").value=data2;updateExpressionCurveLabels()}else if(jumpFactorWrite==MIDI_ED_VARS2_START+25){document.getElementById("exprcurvehighslider").value=data2;updateExpressionCurveLabels()}else if(jumpFactorWrite==MIDI_ED_VARS2_START+26){document.getElementById("pressureMPEplusCheck").checked=data2>0}else if(jumpFactorWrite==MIDI_ED_VARS2_START+28){document.getElementById("overblowSemitonesInput").value=data2}else if(jumpFactorWrite==MIDI_ED_VARS2_START+29){document.getElementById("checkbox31").checked=data2}else if(jumpFactorWrite==MIDI_ED_VARS2_START+30){document.getElementById("halfholeOffset").value=data2;var k=document.getElementById("halfholeOffset");k.dispatchEvent(new Event('input'))}else if(jumpFactorWrite==MIDI_ED_VARS2_START+31){document.getElementById("halfholeSize").value=data2;var k=document.getElementById("halfholeSize");k.dispatchEvent(new Event('input'))}else if(jumpFactorWrite==MIDI_ED_VARS2_START+32){document.getElementById("halfholeRate").value=data2;var k=document.getElementById("halfholeRate");k.dispatchEvent(new Event('input'))}else if(jumpFactorWrite==MIDI_ED_VARS2_START+33){halfholesLow4bits=data2}else if(jumpFactorWrite==MIDI_ED_VARS2_START+34){halfholesHigh4bits=data2;const sanitizedHigherNibble=halfholesHigh4bits&0xF;const sanitizedLowerNibble=halfholesLow4bits&0xF;const shiftedHigherNibble=sanitizedHigherNibble<<4;halfholes=shiftedHigherNibble|sanitizedLowerNibble;document.getElementById("halfHolesCheckbox0").checked=(halfholes>>0)&1;document.getElementById("halfHolesCheckbox1").checked=(halfholes>>1)&1;document.getElementById("halfHolesCheckbox2").checked=(halfholes>>2)&1;document.getElementById("halfHolesCheckbox3").checked=(halfholes>>3)&1;document.getElementById("halfHolesCheckbox4").checked=(halfholes>>4)&1;document.getElementById("halfHolesCheckbox5").checked=(halfholes>>5)&1;document.getElementById("halfHolesCheckbox6").checked=(halfholes>>6)&1;document.getElementById("halfHolesCheckbox7").checked=(halfholes>>7)&1}else if(jumpFactorWrite==MIDI_ED_VARS2_START+35){document.getElementById("checkbox32").checked=data2}else if(jumpFactorWrite==MIDI_ED_VARS2_START+36){document.getElementById("checkbox33").checked=data2}else if(jumpFactorWrite==MIDI_ED_VARS2_START+37){document.getElementById("checkbox34").checked=data2}else if(jumpFactorWrite>=MIDI_CC_109_OFFSET){if(jumpFactorWrite==MIDI_CC_109_OFFSET){document.getElementById("checkbox20").checked=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+1){document.getElementById("checkbox21").checked=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+2){document.getElementById("checkbox22").checked=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+3){center[1]=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+4){center[3]=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+5){inputSliderMin[4]=(data2*5)-90}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+6){inputSliderMax[4]=(data2*5)-90}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+7){outputSliderMin[4]=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+8){outputSliderMax[4]=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+9){inputSliderMin[5]=(data2*5)-90}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+10){inputSliderMax[5]=(data2*5)-90}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+11){outputSliderMin[5]=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+12){outputSliderMax[5]=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+13){inputSliderMin[6]=(data2*5)-90}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+14){inputSliderMax[6]=(data2*5)-90}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+15){outputSliderMin[6]=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+16){outputSliderMax[6]=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+17){IMUchannel[0]=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+18){IMUchannel[1]=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+19){IMUchannel[2]=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+20){IMUnumber[0]=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+21){IMUnumber[1]=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+22){IMUnumber[2]=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+23){document.getElementById("checkbox25").checked=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+24){document.getElementById("checkbox24").checked=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+25){document.getElementById("autoCenterYawInterval").value=data2;var output=document.getElementById("demo16");autoCenterYawInterval.dispatchEvent(new Event('input'));output.innerHTML=data2/4}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+26){document.getElementById("checkbox27").checked=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+27){document.getElementById("shakeDepth").value=data2;var output=document.getElementById("demo15");shakeDepth.dispatchEvent(new Event('input'));output.innerHTML=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+28){slider6.noUiSlider.set([(data2*5)-90,null])}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+29){slider6.noUiSlider.set([null,(data2*5)-90])}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+30){document.getElementById("pitchRegisterNumber").value=data2;var output=document.getElementById("demo17");pitchRegisterNumber.dispatchEvent(new Event('input'));output.innerHTML=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+31){document.getElementById("shakeVibModeCommand").value=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+33){pressureShakeMod[0]=data2;if(mapSelection==0){document.getElementById("pressureShakeModCheck").checked=data2>0}}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+34){pressureShakeMod[2]=data2;if(mapSelection==2){document.getElementById("pressureShakeModCheck").checked=data2>0}}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+35){pressureShakeMod[3]=data2;if(mapSelection==3){document.getElementById("pressureShakeModCheck").checked=data2>0}}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+36){pressureShakeDepth[0]=data2;if(mapSelection==0){document.getElementById("pressureShakeModDepth").value=data2;var output=document.getElementById("pressureShakeModDepthValue")}}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+37){pressureShakeDepth[2]=data2;if(mapSelection==2){document.getElementById("pressureShakeModDepth").value=data2;var output=document.getElementById("pressureShakeModDepthValue")}}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+38){pressureShakeDepth[3]=data2;if(mapSelection==3){document.getElementById("pressureShakeModDepth").value=data2;var output=document.getElementById("pressureShakeModDepthValue")}}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+39){pressureShakeModMode[0]=data2;if(mapSelection==0){document.getElementById("shakePressureModMode").value=data2}}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+40){pressureShakeModMode[2]=data2;if(mapSelection==2){document.getElementById("shakePressureModMode").value=data2}}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+41){pressureShakeModMode[3]=data2;if(mapSelection==3){document.getElementById("shakePressureModMode").value=data2}}else if((jumpFactorWrite>=MIDI_CC_109_OFFSET+42)&&(jumpFactorWrite<=MIDI_CC_109_OFFSET+50)){IMUtoPitchSettingsRoll[jumpFactorWrite-MIDI_CC_109_OFFSET-42]=data2}else if((jumpFactorWrite>=MIDI_CC_109_OFFSET+51)&&(jumpFactorWrite<=MIDI_CC_109_OFFSET+59)){IMUtoPitchSettingsPitch[jumpFactorWrite-MIDI_CC_109_OFFSET-42-9]=data2}else if((jumpFactorWrite>=MIDI_CC_109_OFFSET+60)&&(jumpFactorWrite<=MIDI_CC_109_OFFSET+68)){IMUtoPitchSettingsYaw[jumpFactorWrite-MIDI_CC_109_OFFSET-42-18]=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+69){document.getElementById("checkbox28").checked=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+70){document.getElementById("checkbox29").checked=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+71){document.getElementById("checkbox30").checked=data2}else if(jumpFactorWrite==MIDI_CC_109_OFFSET+MIDI_CC_109_VALUE_127){var gesture=document.getElementById("gestureLabel"+(data2));gesture.style.color="#f7c839";gesture.style.scale="1.1"
setTimeout(function(){contract(gesture)},150)}}}else if(data1==MIDI_CC_109&&data2<=MIDI_IMU_SETTINGS_END){jumpFactorWrite=data2+MIDI_CC_109_OFFSET}else if(data1==MIDI_CC_110){version=data2;console.log("Previous version = "+previousVersion);console.log("Version = "+version);if(previousVersion!=0&&version!=previousVersion){document.location.reload(!1);console.log("Firmware version has changed, refreshing page")}
communicationMode=!0;if(version!=0){previousVersion=version};if((version>=40&&version>=currentVersion)||(version<40&&version>=currentVersionOriginal)){document.getElementById("current").innerHTML="Your firmware is up to date.";document.getElementById("current").style.left="710px";document.getElementById("current").style.visibility="visible";document.getElementById("status").style.visibility="hidden";document.getElementById("current").style.color="#f7c839"}else{document.getElementById("current").innerHTML="There is a firmware update available.";document.getElementById("current").style.left="690px";document.getElementById("current").style.visibility="visible";document.getElementById("status").style.visibility="hidden";document.getElementById("current").style.color="#F78339"}
version=version/10;var n=version.toFixed(1)
document.getElementById("version").innerHTML=n;document.getElementById("version").style.color="#f7c839";document.getElementById("status").innerHTML="WARBL Connected.";document.getElementById("status").style.color="#f7c839";if(version>2.0){document.getElementById("connect").innerHTML="Disconnect"}
if(version<4.5){for(i=0;i<8;++i){document.getElementById("row"+i).options[16].disabled=!0}
document.getElementById("fingeringSelect0").options[22].disabled=!0;document.getElementById("fingeringSelect0").options[23].disabled=!0;document.getElementById("fingeringSelect1").options[22].disabled=!0;document.getElementById("fingeringSelect1").options[23].disabled=!0;document.getElementById("fingeringSelect2").options[22].disabled=!0;document.getElementById("fingeringSelect2").options[23].disabled=!0;document.getElementById("topcontrolbox").style.height="1855px";document.getElementById("buttonBox").style.top="1390px";document.getElementById("halfHoleSetupBox").style.display="none";document.getElementById("box9").style.display="block";document.getElementById("box3").style.top="900px";document.getElementById("box3").style.height="405px";document.getElementById("box10").style.display="none";document.getElementById("box10").style.left="30px";document.getElementById("box11").style.left="30px";document.getElementById("box13").style.left="30px";document.getElementById("box12").style.left="30px";document.getElementById("backPressureButton").style.display="block";document.getElementById("backIMUButton").style.display="block";document.getElementById("switch34").style.display="none";document.getElementById("useThumbLabel").style.display="none";document.getElementById("expressionPressureBox").style.display="none"}
if(version<4.4){document.getElementById("IMUpitchMappingControls").style.display="none";document.getElementById("IMUCCMappingControls").style.top="-80px";document.getElementById("IMUbottomControls").style.top="-160px";document.getElementById("overblowSemitonesInput").style.display="none";document.getElementById("overblowSemitonesLabel").style.display="none"}
if(version<4.3){document.getElementById("exprOutputBendLevelContainer").style.display="none";document.getElementById("advancedOkayPB").style.top="275px";document.getElementById("advancedOkayPB").style.left="205px"}
if(version<4.2){document.getElementById("switchDoubleClick").style.display="none";document.getElementById("doubleClickLabel").style.display="none"}
if(version<3.9){numberOfGestures=8;for(let element of document.getElementsByClassName("WARBL2Elements")){element.style.display="none"}
document.getElementById("box9").style.display="none";document.getElementById("expressionPressureBox").style.display="block";document.getElementById("demo18").style.display="none";document.getElementById("slideLimitContainer").style.display="none";document.getElementById("slidelimitlabel").style.display="none";document.getElementById("advancedPBsliders").style.top="50px";document.getElementById("backPressureButton").style.display="none";document.getElementById("fingeringSelect0").options[24].disabled=!0;document.getElementById("fingeringSelect0").options[25].disabled=!0;document.getElementById("fingeringSelect0").options[26].disabled=!0;document.getElementById("fingeringSelect0").options[27].disabled=!0;document.getElementById("fingeringSelect1").options[24].disabled=!0;document.getElementById("fingeringSelect1").options[25].disabled=!0;document.getElementById("fingeringSelect1").options[26].disabled=!0;document.getElementById("fingeringSelect1").options[27].disabled=!0;document.getElementById("fingeringSelect2").options[24].disabled=!0;document.getElementById("fingeringSelect2").options[25].disabled=!0;document.getElementById("fingeringSelect2").options[26].disabled=!0;document.getElementById("fingeringSelect2").options[27].disabled=!0;document.getElementById("keyLabel").innerHTML="Key";document.getElementById("keyLabel").style.left="305px";for(i=0;i<37;++i){document.getElementsByName('keySelect')[0].options[i].innerHTML=noteNamesforKeySelect[i];document.getElementsByName('keySelect')[1].options[i].innerHTML=noteNamesforKeySelect[i];document.getElementsByName('keySelect')[2].options[i].innerHTML=noteNamesforKeySelect[i]}
for(i=0;i<document.getElementById("fingeringSelect0").length;++i){if(document.getElementById("fingeringSelect0").options[i].value=="19"){var a=1}}
if(a!=1){var x=document.getElementById("fingeringSelect0");var option=document.createElement("option");option.text="Custom (original WARBL)";option.value=19;x.add(option);var y=document.getElementById("fingeringSelect1");var option=document.createElement("option");option.text="Custom (original WARBL)";option.value=19;y.add(option);var z=document.getElementById("fingeringSelect2");var option=document.createElement("option");option.text="Custom (original WARBL)";option.value=19;z.add(option)}
for(i=0;i<8;++i){document.getElementById("row"+i).options[13].disabled=!0;document.getElementById("row"+i).options[14].disabled=!0;document.getElementById("row"+i).options[15].disabled=!0;var opt=document.getElementById("autoCal"+i);opt.value='19'}
document.getElementById("WARBL2Settings").style.display="none";document.getElementById("bellSensor").style.display="block";document.getElementById("dot0").style.left="935px";document.getElementById("1").style.left="900px";document.getElementById("2").style.left="900px";document.getElementById("v1").style.left="900px"}else{for(i=0;i<8;++i){document.getElementById("row"+i).options[13].disabled=!1;document.getElementById("row"+i).options[14].disabled=!1;document.getElementById("row"+i).options[15].disabled=!1;var opt=document.getElementById("autoCal"+i);opt.value='12'}
document.getElementById("WARBL2Settings").style.display="block";document.getElementById("bellSensor").style.display="none";document.getElementById("dot0").style.left="870px";document.getElementById("1").style.left="870px";document.getElementById("2").style.left="870px";document.getElementById("v1").style.left="870px"}
if(version<2.2){document.getElementById("fingeringSelect0").options[20].disabled=!0;document.getElementById("fingeringSelect1").options[20].disabled=!0;document.getElementById("fingeringSelect2").options[20].disabled=!0;document.getElementById("fingeringSelect0").options[21].disabled=!0;document.getElementById("fingeringSelect1").options[21].disabled=!0;document.getElementById("fingeringSelect2").options[21].disabled=!0}
if(version<2.1){document.getElementById("jumpfactor10Container").style.visibility="visible";document.getElementById("jumpfactor4Container").style.visibility="visible";document.getElementById("jumpValue4").style.visibility="visible";document.getElementById("jumpValue10").style.visibility="visible";document.getElementById("jumpfactor10bContainer").style.visibility="hidden";document.getElementById("jumpLabel8").style.visibility="hidden";document.getElementById("jumpLabel5").style.visibility="visible";document.getElementById("demo10b").style.visibility="hidden";document.getElementById("jumpLabel4").innerHTML="Jump";document.getElementById("jumpfactor5Container").style.top="240px";document.getElementById("jumpfactor6Container").style.top="275px";document.getElementById("jumpfactor11Container").style.top="240px";document.getElementById("jumpfactor12Container").style.top="275px";document.getElementById("jumplabel6").style.top="242px";document.getElementById("jumplabel7").style.top="277px";document.getElementById("jumpValue5").style.top="225px";document.getElementById("jumpValue6").style.top="260px";document.getElementById("jumpValue11").style.top="225px";document.getElementById("jumpValue12").style.top="260px";document.getElementById("jumpFactor3").min="1";document.getElementById("jumpFactor3").max="175";document.getElementById("jumpFactor9").min="1";document.getElementById("jumpFactor9").max="175";document.getElementById("jumpFactor5").min="1";document.getElementById("jumpFactor6").min="1";document.getElementById("jumpFactor11").min="1";document.getElementById("jumpFactor12").min="1";document.getElementById("breathSlider").classList.remove('slider2');document.getElementById("breathSlider").classList.add('slider');document.getElementById("pressureGroup").style.top="0px";document.getElementById("ventedLabel").style.visibility="visible";document.getElementById("switch4").style.visibility="visible";document.getElementById("radioGroup10").style.visibility="hidden";document.getElementById("jumplabel10").innerHTML="Closed";document.getElementById("jumplabel11").innerHTML="Vented";document.getElementById("jumplabel10").style.left="170px";document.getElementById("jumplabel11").style.left="340px";document.getElementById("advancedSliders").style.top="-125px";document.getElementById("selectedSettings").style.visibility="hidden";document.getElementById("fingeringSelect0").options[19].disabled=!0;document.getElementById("fingeringSelect1").options[19].disabled=!0;document.getElementById("fingeringSelect2").options[19].disabled=!0;document.getElementById("fingeringSelect0").options[20].disabled=!0;document.getElementById("fingeringSelect1").options[20].disabled=!0;document.getElementById("fingeringSelect2").options[20].disabled=!0}
if(version<2.0){document.getElementById("overrideExpression").disabled=!0;document.getElementById("polyMapButton").disabled=!0;document.getElementById("velocityMapButton").disabled=!0;document.getElementById("aftertouchMapButton").disabled=!0;document.getElementById("noteChannel").disabled=!0;document.getElementById("checkbox13").disabled=!0;document.getElementById("switch13").style.cursor="default";document.getElementById("advancedPBbutton").disabled=!0;document.getElementById("pitchbendradio3").disabled=!0;document.getElementById("configureCustomFingering").disabled=!0}
if(version<1.5){document.getElementById("fingeringSelect0").options[2].disabled=!0;document.getElementById("fingeringSelect1").options[2].disabled=!0;document.getElementById("fingeringSelect2").options[2].disabled=!0;document.getElementById("checkbox10").disabled=!0;for(var i=0;i<8;i++){document.getElementById("row"+i).options[7].disabled=!0;document.getElementById("row"+i).options[8].disabled=!0}}
if(version<1.6){for(var i=0;i<8;i++){document.getElementById("row"+i).options[12].disabled=!0}
document.getElementById("fingeringSelect0").options[6].disabled=!0;document.getElementById("fingeringSelect1").options[6].disabled=!0;document.getElementById("fingeringSelect2").options[6].disabled=!0;document.getElementById("fingeringSelect0").options[11].disabled=!0;document.getElementById("fingeringSelect1").options[11].disabled=!0;document.getElementById("fingeringSelect2").options[11].disabled=!0}
if(version<1.7){document.getElementById("checkbox11").disabled=!0;document.getElementById("checkbox12").disabled=!0;document.getElementById("fingeringSelect0").options[12].disabled=!0;document.getElementById("fingeringSelect1").options[12].disabled=!0;document.getElementById("fingeringSelect2").options[12].disabled=!0;document.getElementById("fingeringSelect0").options[13].disabled=!0;document.getElementById("fingeringSelect1").options[13].disabled=!0;document.getElementById("fingeringSelect2").options[13].disabled=!0;document.getElementById("fingeringSelect0").options[14].disabled=!0;document.getElementById("fingeringSelect1").options[14].disabled=!0;document.getElementById("fingeringSelect2").options[14].disabled=!0;document.getElementById("fingeringSelect0").options[15].disabled=!0;document.getElementById("fingeringSelect1").options[15].disabled=!0;document.getElementById("fingeringSelect2").options[15].disabled=!0}
if(version<2.0){document.getElementById("fingeringSelect0").options[16].disabled=!0;document.getElementById("fingeringSelect1").options[16].disabled=!0;document.getElementById("fingeringSelect2").options[16].disabled=!0;document.getElementById("fingeringSelect0").options[17].disabled=!0;document.getElementById("fingeringSelect1").options[17].disabled=!0;document.getElementById("fingeringSelect2").options[17].disabled=!0;document.getElementById("fingeringSelect0").options[18].disabled=!0;document.getElementById("fingeringSelect1").options[18].disabled=!0;document.getElementById("fingeringSelect2").options[18].disabled=!0}}else if(data1==MIDI_CC_111){document.getElementById("keySelect0").value=data2}else if(data1==MIDI_CC_112){document.getElementById("keySelect1").value=data2}else if(data1==MIDI_CC_113){document.getElementById("keySelect2").value=data2}else if(data1==MIDI_CC_116){lsb=data2}else if(data1==MIDI_CC_118){let sensorVal=parseInt((data2<<7)|lsb);var x=(sensorVal-100)*24/900;p=Math.min(Math.max(p,0),24);var p=x.toFixed(1);if(p<0.2){p=0};if(gPressureGraphEnabled){capturePressure(p)}else{document.getElementById("pressure").innerHTML=(p);document.getElementById("pressure1").innerHTML=(p);if(document.getElementById("box8").style.display=="block"){var barWidth=(p/24)*100;let pressbar=document.getElementById("exprInputPressureLevel");if(barWidth>100){barWidth=101;pressbar.style.background="var(--gauge-over-color)"}else{pressbar.style.background="var(--gauge-color)"}
pressbar.style.width=barWidth+"%";let cents=calculateOutExprBendFromInput(sensorVal);var centsBarWidth=cents/256.0;var outofbounds=!1;if(centsBarWidth>0.5){centsBarWidth=0.51;outofbounds=!0}else if(centsBarWidth<-0.5){centsBarWidth=-0.51;outofbounds=!0}
let bendbar=document.getElementById("exprOutputBendLevel")
var iscenter=!1;if(Math.abs(cents)<0.5){bendbar.style.left="49%";bendbar.style.width="2%";iscenter=!0}else if(cents>0){bendbar.style.left="50%";bendbar.style.width=(centsBarWidth*100).toFixed(0)+"%"}else{bendbar.style.left=(50+centsBarWidth*100).toFixed(0)+"%";bendbar.style.width=(-centsBarWidth*100).toFixed(0)+"%"}
if(iscenter){bendbar.style.background="var(--gauge-center-color)"}else if(outofbounds){bendbar.style.background="var(--gauge-over-color)"}else{bendbar.style.background="var(--gauge-color)"}}}}
for(var i=0;i<numberOfGestures;i++){if(buttonRowWrite==i){if(data1==MIDI_CC_106&&data2<=MIDI_ACTION_MIDI_CHANNEL_END){document.getElementById("channel"+(buttonRowWrite)).value=data2}
if(data1==MIDI_CC_107){document.getElementById("byte2_"+(buttonRowWrite)).value=data2}
if(data1==MIDI_CC_108){document.getElementById("byte3_"+(buttonRowWrite)).value=data2}}}
if(data1==MIDI_CC_106&&data2>MIDI_ACTION_MIDI_CHANNEL_END){if(data2>=MIDI_ENA_VIBRATO_HOLES_START&&data2<=MIDI_ENA_VIBRATO_HOLES_END){document.getElementById("vibratoCheckbox"+(data2-MIDI_ENA_VIBRATO_HOLES_START)).checked=!0}
if(data2>=MIDI_DIS_VIBRATO_HOLES_START&&data2<=MIDI_DIS_VIBRATO_HOLES_END){document.getElementById("vibratoCheckbox"+(data2-MIDI_DIS_VIBRATO_HOLES_START)).checked=!1}
if(data2==MIDI_STARTUP_CALIB){document.getElementById("calibrateradio0").checked=!0}
if(data2==MIDI_USE_LEARNED_CALIB){document.getElementById("calibrateradio1").checked=!0}
if(data2==MIDI_CC_106_VALUE_53){for(i=0;i<document.getElementById("fingeringSelect0").length;++i){if(document.getElementById("fingeringSelect0").options[i].value=="9"){var a=1}}
if(a!=1){var x=document.getElementById("fingeringSelect0");var option=document.createElement("option");option.text="Uilleann regulators";option.value=9;x.add(option);var y=document.getElementById("fingeringSelect1");var option=document.createElement("option");option.text="Uilleann regulators";option.value=9;y.add(option);var z=document.getElementById("fingeringSelect2");var option=document.createElement("option");option.text="Uilleann regulators";option.value=9;z.add(option)}}
if(data2>=MIDI_WARBL2_SETTINGS_START&&data2<=MIDI_WARBL2_SETTINGS_END){WARBL2SettingsReceive=data2-MIDI_WARBL2_SETTINGS_START}
if(data2>=MIDI_BUTTON_ACTIONS_START&&version>3.9){for(var j=0;j<numberOfGestures;j++){if(buttonRowWrite==j){for(var k=0;k<27;k++){if(data2==MIDI_BUTTON_ACTIONS_START+k){document.getElementById("row"+(buttonRowWrite)).value=k}}}}}}
if(data1==MIDI_CC_119){if(WARBL2SettingsReceive==0){document.getElementById("WARBL2Radio"+data2).checked=!0}else if(WARBL2SettingsReceive==1){document.getElementById("checkbox19").checked=data2}else if(WARBL2SettingsReceive==2){document.getElementById("poweroffSlider").value=data2;var value=data2;if(version>4.4&&value==25){value=""}
document.getElementById("poweroffValue").innerHTML=value}else if(WARBL2SettingsReceive==15){var x=(data2+50)/100;var p=x.toFixed(2);document.getElementById("voltage").innerHTML=p}else if(WARBL2SettingsReceive==16){if(data2==0){document.getElementById("charging").style.display="none"}
if(data2==1){document.getElementById("charging").style.display="block"}
if(data2==2){document.getElementById("chargingLabel").innerHTML="Battery fault detected";document.getElementById("chargingLabel").style.display="block";setTimeout(turnOffFault,20000)}}else if(WARBL2SettingsReceive==17){connIntvlLSB=data2}else if(WARBL2SettingsReceive==18){var x=parseInt((data2<<7)|connIntvlLSB);x=x/100;x=parseFloat(x.toFixed(4));if(x==0){document.getElementById("connLabel").innerHTML="BLE not connected";document.getElementById("connLabel").style.left="95px"}else{document.getElementById("connLabel").innerHTML="BLE connected at "+x+" mS interval";document.getElementById("connLabel").style.left="55px"}}else if(WARBL2SettingsReceive==19){var batt=data2;document.getElementById("percentage").innerHTML=batt+"%";if(batt>87){document.getElementById("battery100").style.display="block";document.getElementById("battery75").style.display="none";document.getElementById("battery50").style.display="none";document.getElementById("battery25").style.display="none";document.getElementById("battery0").style.display="none"}else if(batt>63){document.getElementById("battery100").style.display="none";document.getElementById("battery75").style.display="block";document.getElementById("battery50").style.display="none";document.getElementById("battery25").style.display="none";document.getElementById("battery0").style.display="none"}else if(batt>37){document.getElementById("battery100").style.display="none";document.getElementById("battery75").style.display="none";document.getElementById("battery50").style.display="block";document.getElementById("battery25").style.display="none";document.getElementById("battery0").style.display="none"}else if(batt>13){document.getElementById("battery100").style.display="none";document.getElementById("battery75").style.display="none";document.getElementById("battery50").style.display="none";document.getElementById("battery25").style.display="block";document.getElementById("battery0").style.display="none"}else{document.getElementById("battery100").style.display="none";document.getElementById("battery75").style.display="none";document.getElementById("battery50").style.display="none";document.getElementById("battery25").style.display="none";document.getElementById("battery0").style.display="block"}}}}}
updateCells()}
function bit_test(num,bit){return((num>>bit)%2!=0)}
function contract(gesture){gesture.style.scale="1"
gesture.style.color="#c3c0c0"}
function turnOffFault(){document.getElementById("chargingLabel").style.display="none"}
function sendCustomFingeringFill(){modalclose(22);var selection=document.getElementById("customFingeringFill").value;for(i=1;i<12;++i){document.getElementById("fingeringInput"+i).value=customFingeringFills[selection][i-1];var x=document.getElementById("fingeringInput"+i).value;sendToWARBL(MIDI_CC_104,86+i);sendToWARBL(MIDI_CC_105,x)}
document.getElementById("customFingeringFill").value="12"}
function sendWARBL2CustomFingeringFill(){modalclose(24);modal(25);var selection=document.getElementById("WARBL2customFingeringFill").value;selection=parseFloat(selection);var textArea=document.getElementById('WARBL2CustomTextArea');var lines=textArea.value.split('\n');for(var j=0;j<lines.length;j++){if(!(lines.length==257||lines.length==256)){modalclose(25);alert("There must be 256 MIDI notes. Please try again.");document.getElementById('WARBL2customFingeringFill').value='10';document.getElementById("WARBL2CustomTextArea").value='';return}
if(lines[j]<0||lines[j]>127||isNaN(lines[j])){modalclose(25);alert("Each MIDI note must be in the range of 0 to 127.");document.getElementById('WARBL2customFingeringFill').value='10';document.getElementById("WARBL2CustomTextArea").value='';return}}
sendToWARBL(MIDI_CC_109,(selection+MIDI_CUSTOM_CHARTS_START));for(var k=0;k<256;k++){sendToWARBL(MIDI_CC_105,lines[k])}}
function fingeringInput(input,selection){var x=document.getElementById("fingeringInput"+input).value;sendToWARBL(MIDI_CC_104,86+input);sendToWARBL(MIDI_CC_105,x)}
function sendFingeringSelect(row,selection){selection=parseFloat(selection);updateCells();updateCustom();blink(1);if(version<4.0){var key;if(selection==2){key=8}else if(selection==3){key=3}else if(selection==5||selection==13){key=125}else if(selection==6){key=122}else if(selection==8){key=125}else if(selection==11){key=113}else if(selection==12||selection==14||selection==15){key=123}else if(selection==17||selection==18){key=2}else if(selection==20){key=123}else if(selection==22){key=5}else{key=0}}else{key=0}
document.getElementById("keySelect"+row).value=key;sendToWARBL(MIDI_CC_102,MIDI_FINGERING_PATTERN_MODE_START+row);sendToWARBL(MIDI_CC_102,MIDI_FINGERING_PATTERN_START+selection);sendKey(row,key)}
function defaultInstrument(){defaultInstr=instrument;handleDefault();sendToWARBL(MIDI_CC_102,MIDI_DEFAULT_MODE_START)}
function handleDefault(){if(version>1.6||version=="Unknown"){if(defaultInstr!=0){document.getElementById("instrument1Label").innerHTML="Instrument 1:"}
if(defaultInstr!=1){document.getElementById("instrument2Label").innerHTML="Instrument 2:"}
if(defaultInstr!=2){document.getElementById("instrument3Label").innerHTML="Instrument 3:"}
if(defaultInstr==0){document.getElementById("instrument1Label").innerHTML="Instrument 1 (default):"}
if(defaultInstr==1){document.getElementById("instrument2Label").innerHTML="Instrument 2 (default):"}
if(defaultInstr==2){document.getElementById("instrument3Label").innerHTML="Instrument 3 (default):"}
if(defaultInstr!=instrument){document.getElementById("defaultInstrument").style.visibility="visible";if(instrument==0){document.getElementById("defaultInstrument").style.left="130px"}
if(instrument==1){document.getElementById("defaultInstrument").style.left="430px"}
if(instrument==2){document.getElementById("defaultInstrument").style.left="730px"}}else{document.getElementById("defaultInstrument").style.visibility="hidden"}}}
function sendKey(row,selection){selection=parseFloat(selection);row=parseFloat(row);updateCells();blink(1);sendToWARBL(MIDI_CC_111+row,selection)}
function sendFingeringRadio(tab){instrument=tab;updateCustom();advancedOkay();pressureOkay();okayCCmap();okayIMUmap();okayPitchRegistermap();okayOverride();okayIMUPitchbend();backIMU();backPressure();handleDefault();customFingeringOkay();if(tab==0){document.getElementById("instrument0").style.display="block";document.getElementById("instrument1").style.display="none";document.getElementById("instrument2").style.display="none";document.getElementById("key0").style.display="block";document.getElementById("key1").style.display="none";document.getElementById("key2").style.display="none";sendToWARBL(MIDI_CC_102,MIDI_CURRENT_MODE_START)}else if(tab==1){document.getElementById("instrument0").style.display="none";document.getElementById("instrument1").style.display="block";document.getElementById("instrument2").style.display="none";document.getElementById("key0").style.display="none";document.getElementById("key1").style.display="block";document.getElementById("key2").style.display="none";blink(2);sendToWARBL(MIDI_CC_102,MIDI_CURRENT_MODE_START+1)}else if(tab==2){document.getElementById("instrument0").style.display="none";document.getElementById("instrument1").style.display="none";document.getElementById("instrument2").style.display="block";document.getElementById("key0").style.display="none";document.getElementById("key1").style.display="none";document.getElementById("key2").style.display="block";blink(3);sendToWARBL(MIDI_CC_102,MIDI_CURRENT_MODE_START+2)}
updateCells();updateCustom()}
function updateSelected(){if(document.getElementById("bagBreath0").checked==!0){document.getElementById("selectedSettings").style.left="125px";document.getElementById("selectedSettings").style.width="162px"}else{document.getElementById("selectedSettings").style.left="285px";document.getElementById("selectedSettings").style.width="162px"}}
function sendSenseDistance(selection){blink(1);selection=parseFloat(selection);x=0-parseFloat(selection);sendToWARBL(MIDI_CC_103,x)}
function sendhalfholeOffset(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+30);sendToWARBL(MIDI_CC_105,selection)}
function sendhalfholeSize(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+31);sendToWARBL(MIDI_CC_105,selection)}
function sendhalfholeRate(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+32);sendToWARBL(MIDI_CC_105,selection)}
function sendDepth(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_117,selection)}
function sendSlideLimit(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_104,MIDI_SLIDE_LIMIT_MAX);sendToWARBL(MIDI_CC_105,selection)}
function sendShakeDepth(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_109,MIDI_Y_PITCHBEND_DEPTH);sendToWARBL(MIDI_CC_105,selection)}
function sendShakeVibModeOnCommand(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_109,MIDI_Y_PITCHBEND_MODE);sendToWARBL(MIDI_CC_105,selection)}
function sendAutoCenterYawInterval(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_109,MIDI_AUTOCENTER_YAW_INTERVAL);sendToWARBL(MIDI_CC_105,selection)}
function sendpitchRegisterNumber(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_109,MIDI_PITCH_REGISTER_NUMBER);sendToWARBL(MIDI_CC_105,selection)}
function sendExpressionDepth(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_DEPTH);sendToWARBL(MIDI_CC_105,selection)}
function sendExpressionCenterPressure(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_FIXED_CENTER_PRESSURE);sendToWARBL(MIDI_CC_105,selection);updateExpressionCenterPressureLabel()}
function sendExpressionCurveLow(value){blink(1);selection=parseFloat(value);sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_CURVE_LOW);sendToWARBL(MIDI_CC_105,selection);updateExpressionCurveLabels()}
function sendExpressionCurveHigh(value){blink(1);selection=parseFloat(value);sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_CURVE_HIGH);sendToWARBL(MIDI_CC_105,selection);updateExpressionCurveLabels()}
function sendIMUCurveLow(value){blink(1);selection=parseFloat(value);sendToWARBL(MIDI_CC_109,IMU_ROLL_PITCH_CURVE_LOW+((IMUpitchSelection-1)*9));sendToWARBL(MIDI_CC_105,selection);updateIMUCurveLabels();updateIMUtoPitchSettings()}
function sendIMUCurveHigh(value){blink(1);selection=parseFloat(value);sendToWARBL(MIDI_CC_109,IMU_ROLL_PITCH_CURVE_HIGH+((IMUpitchSelection-1)*9));sendToWARBL(MIDI_CC_105,selection);updateIMUCurveLabels();updateIMUtoPitchSettings()}
function resetExpressionCurveLow(){var lowslider=document.getElementById('exprcurvelowslider');lowslider.value=64;sendExpressionCurveLow(64)}
function resetExpressionCurveHigh(){var highslider=document.getElementById('exprcurvehighslider');highslider.value=64;sendExpressionCurveHigh(64)}
function resetIMUCurveLow(){var lowslider=document.getElementById('IMUcurvelowslider');lowslider.value=64;sendIMUCurveLow(64)}
function resetIMUCurveHigh(){var highslider=document.getElementById('IMUcurvehighslider');highslider.value=64;sendIMUCurveHigh(64)}
function sendPressureAftertouchMPEplus(value){blink(1);sendToWARBL(MIDI_CC_104,MIDI_AFTERTOUCH_MPEPLUS);sendToWARBL(MIDI_CC_105,value?1:0)}
function sendClampExpr(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_OUT_CLAMP);sendToWARBL(MIDI_CC_105,selection)}
function sendClampIMU(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_109,IMU_ROLL_PITCH_OUT_CLAMP+((IMUpitchSelection-1)*9));sendToWARBL(MIDI_CC_105,selection);updateIMUtoPitchSettings()}
function sendCurveRadio(selection){blink(1);selection=parseFloat(selection);curve[mapSelection]=selection;if(mapSelection==0){sendToWARBL(MIDI_CC_104,MIDI_CURVE)}else{sendToWARBL(MIDI_CC_104,MIDI_VELOCITY_CURVE+mapSelection-1)}
sendToWARBL(MIDI_CC_105,selection)}
function sendPressureChannel(selection){blink(1);var x=parseFloat(selection);if(x<1||x>16||isNaN(x)){alert("Value must be 1-16.");document.getElementById("pressureChannel").value=null}else{sendToWARBL(MIDI_CC_104,MIDI_PRESSURE_CHANNEL);sendToWARBL(MIDI_CC_105,x)}}
function sendPressureCC(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_104,MIDI_PRESSURE_CC);sendToWARBL(MIDI_CC_105,selection)}
function sendPressureShakeMod(selection){blink(1);console.log("shake mod: "+selection)
if(mapSelection==0){sendToWARBL(MIDI_CC_109,MIDI_Y_SHAKE_MOD_CC);sendToWARBL(MIDI_CC_105,selection?1:0)}else if(mapSelection==2){sendToWARBL(MIDI_CC_109,MIDI_Y_SHAKE_MOD_CHPRESS);sendToWARBL(MIDI_CC_105,selection?1:0)}else if(mapSelection==3){sendToWARBL(MIDI_CC_109,MIDI_Y_SHAKE_MOD_KEYPRESS);sendToWARBL(MIDI_CC_105,selection?1:0)}
pressureShakeMod[mapSelection]=selection}
function sendPressureShakeModMode(selection){blink(1);console.log("shake mod mode: "+selection)
if(mapSelection==0){sendToWARBL(MIDI_CC_109,MIDI_Y_SHAKE_MOD_CC_MODE);sendToWARBL(MIDI_CC_105,selection)}else if(mapSelection==2){sendToWARBL(MIDI_CC_109,MIDI_Y_SHAKE_MOD_CHPRESS_MODE);sendToWARBL(MIDI_CC_105,selection)}else if(mapSelection==3){sendToWARBL(MIDI_CC_109,MIDI_Y_SHAKE_MOD_KEYPRESS_MODE);sendToWARBL(MIDI_CC_105,selection)}
pressureShakeModMode[mapSelection]=selection;updatePressureValuesForSelection()}
function sendPressureShakeModDepth(value){blink(1);value=parseFloat(value);if(mapSelection==0){sendToWARBL(MIDI_CC_109,MIDI_Y_SHAKE_MOD_CC_DEPTH);sendToWARBL(MIDI_CC_105,value)}else if(mapSelection==2){sendToWARBL(MIDI_CC_109,MIDI_Y_SHAKE_MOD_CHPRESS_DEPTH);sendToWARBL(MIDI_CC_105,value)}else if(mapSelection==3){sendToWARBL(MIDI_CC_109,MIDI_Y_SHAKE_MOD_KEYPRESS_DEPTH);sendToWARBL(MIDI_CC_105,value)}
pressureShakeDepth[mapSelection]=value;updatePressureValuesForSelection()}
function sendBendRange(selection){blink(1);var x=parseFloat(selection);if(x<1||x>96||isNaN(x)){alert("Value must be 1-96.");document.getElementById("midiBendRange").value=null}else{sendToWARBL(MIDI_CC_104,MIDI_BEND_RANGE);sendToWARBL(MIDI_CC_105,x)}}
function sendNoteChannel(selection){blink(1);var x=parseFloat(selection);if(x<1||x>16||isNaN(x)){alert("Value must be 1-16.");document.getElementById("noteChannel").value=null}else{sendToWARBL(MIDI_CC_104,MIDI_MIDI_CHANNEL);sendToWARBL(MIDI_CC_105,x)}}
slider.noUiSlider.on('change',function(values){blink(1);if(mapSelection==0){inputSliderMin[0]=parseInt(values[0]);inputSliderMax[0]=parseInt(values[1]);sendToWARBL(MIDI_CC_104,MIDI_INPUT_PRESSURE_MIN);sendToWARBL(MIDI_CC_105,parseInt(values[0]));sendToWARBL(MIDI_CC_104,MIDI_INPUT_PRESSURE_MAX);sendToWARBL(MIDI_CC_105,parseInt(values[1]))}else{inputSliderMin[mapSelection]=parseInt(values[0]);inputSliderMax[mapSelection]=parseInt(values[1]);sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+((mapSelection-1)*4));sendToWARBL(MIDI_CC_105,parseInt(values[0]));sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+1+((mapSelection-1)*4));sendToWARBL(MIDI_CC_105,parseInt(values[1]))}});slider2.noUiSlider.on('change',function(values){blink(1);if(mapSelection==0){outputSliderMin[0]=parseInt(values[0]);outputSliderMax[0]=parseInt(values[1]);sendToWARBL(MIDI_CC_104,MIDI_OUTPUT_PRESSURE_MIN);sendToWARBL(MIDI_CC_105,parseInt(values[0]));sendToWARBL(MIDI_CC_104,MIDI_OUTPUT_PRESSURE_MAX);sendToWARBL(MIDI_CC_105,parseInt(values[1]))}else{outputSliderMin[mapSelection]=parseInt(values[0]);outputSliderMax[mapSelection]=parseInt(values[1]);sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+2+((mapSelection-1)*4));sendToWARBL(MIDI_CC_105,parseInt(values[0]));sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+3+((mapSelection-1)*4));sendToWARBL(MIDI_CC_105,parseInt(values[1]))}});exprlowslider.noUiSlider.on('change',function(values){blink(1);if(version<4.3){sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MIN);sendToWARBL(MIDI_CC_105,parseInt(values[0]));sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MAX);sendToWARBL(MIDI_CC_105,parseInt(values[1]))}else{sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MIN);sendToWARBL(MIDI_CC_105,parseInt(values[0]));sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MIN_HIGH);sendToWARBL(MIDI_CC_105,parseInt(values[1]));if(parseInt(values[1])>parseInt(exprhighslider.noUiSlider.get()[0])){console.log("  exprhigh values "+exprhighslider.noUiSlider.get()[0]+" "+exprhighslider.noUiSlider.get()[1]);exprhighslider.noUiSlider.set([parseInt(values[1]),null]);sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MAX_LOW);sendToWARBL(MIDI_CC_105,parseInt(values[1]))}}});exprhighslider.noUiSlider.on('change',function(values){blink(1);sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MAX_LOW);sendToWARBL(MIDI_CC_105,parseInt(values[0]));sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MAX);sendToWARBL(MIDI_CC_105,parseInt(values[1]));if(parseInt(values[0])<parseInt(exprlowslider.noUiSlider.get()[1])){exprlowslider.noUiSlider.set([null,parseInt(values[0])]);console.log("  exprlow values "+exprlowslider.noUiSlider.get()[0]+" "+exprlowslider.noUiSlider.get()[1]);sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_MIN_HIGH);sendToWARBL(MIDI_CC_105,parseInt(values[0]))}});exprlowbendslider.noUiSlider.on('change',function(values){blink(1);sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_OUT_LOW_CENTS);sendToWARBL(MIDI_CC_105,parseInt(values[0]))});exprhighbendslider.noUiSlider.on('change',function(values){blink(1);sendToWARBL(MIDI_CC_104,MIDI_EXPRESSION_OUT_HIGH_CENTS);sendToWARBL(MIDI_CC_105,parseInt(values[0]))});IMUlowslider.noUiSlider.on('change',function(values){console.log("change");blink(1);sendToWARBL(MIDI_CC_109,IMU_ROLL_PITCH_MIN+((IMUpitchSelection-1)*9));sendToWARBL(MIDI_CC_105,parseInt(values[0]));sendToWARBL(MIDI_CC_109,IMU_ROLL_PITCH_MIN_HIGH+((IMUpitchSelection-1)*9));sendToWARBL(MIDI_CC_105,parseInt(values[1]));if(parseInt(values[1])>parseInt(IMUhighslider.noUiSlider.get()[0])){console.log("  IMUhigh values "+IMUhighslider.noUiSlider.get()[0]+" "+IMUhighslider.noUiSlider.get()[1]);IMUhighslider.noUiSlider.set([parseInt(values[1]),null]);sendToWARBL(MIDI_CC_109,IMU_ROLL_PITCH_MAX_LOW+((IMUpitchSelection-1)*9));sendToWARBL(MIDI_CC_105,parseInt(values[1]))}
updateIMUtoPitchSettings()});IMUhighslider.noUiSlider.on('change',function(values){blink(1);sendToWARBL(MIDI_CC_109,IMU_ROLL_PITCH_MAX_LOW+((IMUpitchSelection-1)*9));sendToWARBL(MIDI_CC_105,parseInt(values[0]));sendToWARBL(MIDI_CC_109,IMU_ROLL_PITCH_MAX+((IMUpitchSelection-1)*9));sendToWARBL(MIDI_CC_105,parseInt(values[1]));if(parseInt(values[0])<parseInt(IMUlowslider.noUiSlider.get()[1])){IMUlowslider.noUiSlider.set([null,parseInt(values[0])]);console.log("  exprlow values "+IMUlowslider.noUiSlider.get()[0]+" "+IMUlowslider.noUiSlider.get()[1]);sendToWARBL(MIDI_CC_109,IMU_ROLL_PITCH_MIN_HIGH+((IMUpitchSelection-1)*9));sendToWARBL(MIDI_CC_105,parseInt(values[0]))}
updateIMUtoPitchSettings()});IMUlowbendslider.noUiSlider.on('change',function(values){blink(1);sendToWARBL(MIDI_CC_109,IMU_ROLL_PITCH_OUT_LOW_CENTS+((IMUpitchSelection-1)*9));sendToWARBL(MIDI_CC_105,parseInt(values[0]));updateIMUtoPitchSettings()});IMUhighbendslider.noUiSlider.on('change',function(values){blink(1);sendToWARBL(MIDI_CC_109,IMU_ROLL_PITCH_OUT_HIGH_CENTS+((IMUpitchSelection-1)*9));sendToWARBL(MIDI_CC_105,parseInt(values[0]));updateIMUtoPitchSettings()});function updateIMUtoPitchSettings(){if(IMUpitchSelection==1){IMUtoPitchSettingsRoll[0]=parseInt(IMUlowslider.noUiSlider.get()[0]);IMUtoPitchSettingsRoll[2]=parseInt(IMUlowslider.noUiSlider.get()[1]);IMUtoPitchSettingsRoll[3]=parseInt(IMUhighslider.noUiSlider.get()[0]);IMUtoPitchSettingsRoll[1]=parseInt(IMUhighslider.noUiSlider.get()[1]);IMUtoPitchSettingsRoll[4]=parseInt(IMUlowbendslider.noUiSlider.get()[0]);IMUtoPitchSettingsRoll[5]=parseInt(IMUhighbendslider.noUiSlider.get()[0]);IMUtoPitchSettingsRoll[6]=document.getElementById("clampIMUCheck").checked;IMUtoPitchSettingsRoll[7]=document.getElementById("IMUcurvelowslider").value;IMUtoPitchSettingsRoll[8]=document.getElementById("IMUcurvehighslider").value}else if(IMUpitchSelection==2){IMUtoPitchSettingsPitch[0]=parseInt(IMUlowslider.noUiSlider.get()[0]);IMUtoPitchSettingsPitch[2]=parseInt(IMUlowslider.noUiSlider.get()[1]);IMUtoPitchSettingsPitch[3]=parseInt(IMUhighslider.noUiSlider.get()[0]);IMUtoPitchSettingsPitch[1]=parseInt(IMUhighslider.noUiSlider.get()[1]);IMUtoPitchSettingsPitch[4]=parseInt(IMUlowbendslider.noUiSlider.get()[0]);IMUtoPitchSettingsPitch[5]=parseInt(IMUhighbendslider.noUiSlider.get()[0]);IMUtoPitchSettingsPitch[6]=document.getElementById("clampIMUCheck").checked;IMUtoPitchSettingsPitch[7]=document.getElementById("IMUcurvelowslider").value;IMUtoPitchSettingsPitch[8]=document.getElementById("IMUcurvehighslider").value}else if(IMUpitchSelection==3){IMUtoPitchSettingsYaw[0]=parseInt(IMUlowslider.noUiSlider.get()[0]);IMUtoPitchSettingsYaw[2]=parseInt(IMUlowslider.noUiSlider.get()[1]);IMUtoPitchSettingsYaw[3]=parseInt(IMUhighslider.noUiSlider.get()[0]);IMUtoPitchSettingsYaw[1]=parseInt(IMUhighslider.noUiSlider.get()[1]);IMUtoPitchSettingsYaw[4]=parseInt(IMUlowbendslider.noUiSlider.get()[0]);IMUtoPitchSettingsYaw[5]=parseInt(IMUhighbendslider.noUiSlider.get()[0]);IMUtoPitchSettingsYaw[6]=document.getElementById("clampIMUCheck").checked;IMUtoPitchSettingsYaw[7]=document.getElementById("IMUcurvelowslider").value;IMUtoPitchSettingsYaw[8]=document.getElementById("IMUcurvehighslider").value}}
slider5.noUiSlider.on('change',function(values,handle){if(center[IMUmapSelection]&&IMUmapSelection!=2){var min=parseFloat(values[handle]).toFixed(0);if(handle){if(min>0){slider5.noUiSlider.set([-min,null])}else{slider5.noUiSlider.set([0,0])}}else{if(min<0){slider5.noUiSlider.set([null,-min])}else{slider5.noUiSlider.set([0,0])}}}
blink(1);var handles=slider5.noUiSlider.get();inputSliderMin[IMUmapSelection+3]=parseInt(handles[0]);inputSliderMax[IMUmapSelection+3]=parseInt(handles[1]);sendToWARBL(MIDI_CC_109,((IMUmapSelection)*4+1));if(IMUmapSelection==3){sendToWARBL(MIDI_CC_105,(parseInt(handles[0])+90)/5)}else{sendToWARBL(MIDI_CC_105,(parseInt(handles[0])+90)/5)}
sendToWARBL(MIDI_CC_109,((IMUmapSelection)*4)+2);if(IMUmapSelection==3){sendToWARBL(MIDI_CC_105,(parseInt(handles[1])+90)/5)}else{sendToWARBL(MIDI_CC_105,(parseInt(handles[1])+90)/5)}});slider4.noUiSlider.on('change',function(values,handle){outputSliderMin[IMUmapSelection+3]=parseInt(values[0]);outputSliderMax[IMUmapSelection+3]=parseInt(values[1]);sendToWARBL(MIDI_CC_109,((IMUmapSelection)*4+3));sendToWARBL(MIDI_CC_105,parseInt(values[0]));sendToWARBL(MIDI_CC_109,((IMUmapSelection)*4+4));sendToWARBL(MIDI_CC_105,parseInt(values[1]))});slider.noUiSlider.on('update',function(values,handle){var marginMin=document.getElementById('slider-value-min'),marginMax=document.getElementById('slider-value-max');if(handle){var min=parseFloat(values[handle]*0.24).toFixed(1);marginMax.innerHTML=min}else{var max=parseFloat(values[handle]*0.24).toFixed(1);marginMin.innerHTML=max}});slider2.noUiSlider.on('update',function(values,handle){var marginMin=document.getElementById('slider2-value-min'),marginMax=document.getElementById('slider2-value-max');if(handle){marginMax.innerHTML=parseInt(values[handle])}else{marginMin.innerHTML=parseInt(values[handle])}});exprlowslider.noUiSlider.on('update',function(values,handle){var marginMin=document.getElementById('exprlowslider-value-min'),marginMax=document.getElementById('exprlowslider-value-max');if(handle){var min=parseFloat(values[handle]*0.24).toFixed(1);marginMax.innerHTML=min}else{var max=parseFloat(values[handle]*0.24).toFixed(1);marginMin.innerHTML=max}});exprhighslider.noUiSlider.on('update',function(values,handle){var marginMin=document.getElementById('exprhighslider-value-min'),marginMax=document.getElementById('exprhighslider-value-max');if(handle){var min=parseFloat(values[handle]*0.24).toFixed(1);marginMax.innerHTML=min}else{var max=parseFloat(values[handle]*0.24).toFixed(1);marginMin.innerHTML=max}});exprlowbendslider.noUiSlider.on('update',function(values,handle){var marginMin=document.getElementById('exprlowbendslider-value');var min=parseFloat(2*(values[0]-64)).toFixed(0);marginMin.innerHTML=min});exprhighbendslider.noUiSlider.on('update',function(values,handle){var marginMin=document.getElementById('exprhighbendslider-value');var min=parseFloat(2*(values[0]-64)).toFixed(0);marginMin.innerHTML=min});IMUlowslider.noUiSlider.on('update',function(values,handle){var marginMin=document.getElementById('IMUlowslider-value-min'),marginMax=document.getElementById('IMUlowslider-value-max');if(IMUpitchSelection==3){if(handle){var min=parseFloat((10*values[handle])-180).toFixed(0);marginMax.innerHTML=min}else{var max=parseFloat((10*values[handle])-180).toFixed(0);marginMin.innerHTML=max}}else{if(handle){var min=parseFloat((5*values[handle])-90).toFixed(0);marginMax.innerHTML=min}else{var max=parseFloat((5*values[handle])-90).toFixed(0);marginMin.innerHTML=max}}});IMUhighslider.noUiSlider.on('update',function(values,handle){var marginMin=document.getElementById('IMUhighslider-value-min'),marginMax=document.getElementById('IMUhighslider-value-max');if(IMUpitchSelection==3){if(handle){var min=parseFloat((10*values[handle])-180).toFixed(0);marginMax.innerHTML=min}else{var max=parseFloat((10*values[handle])-180).toFixed(0);marginMin.innerHTML=max}}else{if(handle){var min=parseFloat((5*values[handle])-90).toFixed(0);marginMax.innerHTML=min}else{var max=parseFloat((5*values[handle])-90).toFixed(0);marginMin.innerHTML=max}}});IMUlowbendslider.noUiSlider.on('update',function(values,handle){var marginMin=document.getElementById('IMUlowbendslider-value');var min=parseFloat(2*(values[0]-64)).toFixed(0);marginMin.innerHTML=min});IMUhighbendslider.noUiSlider.on('update',function(values,handle){var marginMin=document.getElementById('IMUhighbendslider-value');var min=parseFloat(2*(values[0]-64)).toFixed(0);marginMin.innerHTML=min});slider4.noUiSlider.on('update',function(values,handle){var marginMin=document.getElementById('slider4-value-min'),marginMax=document.getElementById('slider4-value-max');if(handle){marginMax.innerHTML=parseInt(values[handle])}else{marginMin.innerHTML=parseInt(values[handle])}
var handles4=slider4.noUiSlider.get();elements=document.getElementById("slider4").getElementsByClassName("noUi-connect");if(parseInt(handles4[0])>parseInt(handles4[1])){for(var i=0;i<elements.length;i++){elements[i].style.backgroundColor="#f7c839"}}else{for(var i=0;i<elements.length;i++){elements[i].style.backgroundColor="#262626"}}});slider5.noUiSlider.on('update',function(values,handle){var marginMin=document.getElementById('slider5-value-min'),marginMax=document.getElementById('slider5-value-max');if(IMUmapSelection==3){if(handle){var min=parseFloat(values[handle]*2).toFixed(0);marginMax.innerHTML=min}else{var max=parseFloat(values[handle]*2).toFixed(0);marginMin.innerHTML=max}}else{if(handle){marginMax.innerHTML=parseInt(values[handle])}else{marginMin.innerHTML=parseInt(values[handle])}}});slider6.noUiSlider.on('update',function(values,handle){var marginMin=document.getElementById('slider6-value-min'),marginMax=document.getElementById('slider6-value-max');if(handle){marginMax.innerHTML=parseInt(values[handle])}else{marginMin.innerHTML=parseInt(values[handle])}});slider6.noUiSlider.on('change',function(values,handle){blink(1);var handles=slider6.noUiSlider.get();inputSliderMin[IMUmapSelection+3]=parseInt(handles[0]);inputSliderMax[IMUmapSelection+3]=parseInt(handles[1]);sendToWARBL(MIDI_CC_109,MIDI_PITCH_REGISTER_INPUT_MIN);sendToWARBL(MIDI_CC_105,(parseInt(handles[0])+90)/5);sendToWARBL(MIDI_CC_109,MIDI_PITCH_REGISTER_INPUT_MAX);sendToWARBL(MIDI_CC_105,(parseInt(handles[1])+90)/5)});function sendRoll(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_109,MIDI_SEND_ROLL);sendToWARBL(MIDI_CC_105,selection)}
function sendPitch(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_109,MIDI_SEND_PITCH);sendToWARBL(MIDI_CC_105,selection)}
function sendYaw(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_109,MIDI_SEND_YAW);sendToWARBL(MIDI_CC_105,selection)}
function sendRollPitchbend(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_109,MAP_ROLL_TO_PITCHBEND);sendToWARBL(MIDI_CC_105,selection)}
function sendPitchPitchbend(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_109,MAP_ELEVATION_TO_PITCHBEND);sendToWARBL(MIDI_CC_105,selection)}
function sendYawPitchbend(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_109,MAP_YAW_TO_PITCHBEND);sendToWARBL(MIDI_CC_105,selection)}
function sendShake(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_109,MIDI_Y_SHAKE_PITCHBEND);sendToWARBL(MIDI_CC_105,selection)}
function sendAutoCenterYaw(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_109,MIDI_AUTOCENTER_YAW);sendToWARBL(MIDI_CC_105,selection)}
function sendPitchRegister(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_109,MIDI_PITCH_REGISTER);sendToWARBL(MIDI_CC_105,selection)}
function sendDronesOnCommand(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_104,MIDI_DRONES_ON_COMMAND);sendToWARBL(MIDI_CC_105,selection)}
function sendDronesOnChannel(selection){var x=parseFloat(selection);if(x<0||x>16||isNaN(x)){alert("Value must be 1-16.");document.getElementById("dronesOnChannel").value=null}else{blink(1);sendToWARBL(MIDI_CC_104,MIDI_DRONES_ON_CHANNEL);sendToWARBL(MIDI_CC_105,x)}}
function sendDronesOnByte2(selection){var x=parseFloat(selection);if(x<0||x>127||isNaN(x)){alert("Value must be 0 - 127.");document.getElementById("dronesOnByte2").value=null}else{blink(1);sendToWARBL(MIDI_CC_104,MIDI_DRONES_ON_BYTE2);sendToWARBL(MIDI_CC_105,x)}}
function sendDronesOnByte3(selection){var x=parseFloat(selection);if(x<0||x>127||isNaN(x)){alert("Value must be 0 - 127.");document.getElementById("dronesOnByte3").value=null}else{blink(1);sendToWARBL(MIDI_CC_104,MIDI_DRONES_ON_BYTE3);sendToWARBL(MIDI_CC_105,x)}}
function sendDronesOffCommand(selection){blink(1);var y=parseFloat(selection);sendToWARBL(MIDI_CC_104,MIDI_DRONES_OFF_COMMAND);sendToWARBL(MIDI_CC_105,y)}
function sendDronesOffChannel(selection){var x=parseFloat(selection);if(x<0||x>16||isNaN(x)){alert("Value must be 1-16.");document.getElementById("dronesOffChannel").value=null}else{blink(1);sendToWARBL(MIDI_CC_104,MIDI_DRONES_OFF_CHANNEL);sendToWARBL(MIDI_CC_105,x)}}
function sendDronesOffByte2(selection){var x=parseFloat(selection);if(x<0||x>127||isNaN(x)){alert("Value must be 0 - 127.");document.getElementById("dronesOffByte2").value=null}else{blink(1);sendToWARBL(MIDI_CC_104,MIDI_DRONES_OFF_BYTE2);sendToWARBL(MIDI_CC_105,x)}}
function sendDronesOffByte3(selection){var x=parseFloat(selection);if(x<0||x>127||isNaN(x)){alert("Value must be 0 - 127.");document.getElementById("dronesOffByte3").value=null}else{blink(1);sendToWARBL(MIDI_CC_104,MIDI_DRONES_OFF_BYTE3);sendToWARBL(MIDI_CC_105,x)}}
function sendDronesRadio(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_104,MIDI_DRONES_CONTROL_MODE);sendToWARBL(MIDI_CC_105,selection)}
function learnDrones(){blink(1);document.getElementById("dronesPressureInput").style.backgroundColor="#32CD32";setTimeout(blinkDrones,500);sendToWARBL(MIDI_CC_106,MIDI_LEARN_DRONES_PRESSURE)}
function blinkDrones(){document.getElementById("dronesPressureInput").style.backgroundColor="#FFF"}
function blinkOctave(){document.getElementById("octavePressureInput").style.backgroundColor="#FFF"}
function sendDronesPressure(selection){var x=parseFloat(selection);if(x<0||x>24||isNaN(x)){alert("Value must be 0.0 - 24.0.");document.getElementById("dronesPressureInput").value=null}else{x=parseInt(x*900/24+100);blink(1);document.getElementById("dronesPressureInput").style.backgroundColor="#32CD32";setTimeout(blinkDrones,500);sendToWARBL(MIDI_CC_104,MIDI_DRONES_PRESSURE_LOW_BYTE);sendToWARBL(MIDI_CC_105,x&0x7F);sendToWARBL(MIDI_CC_104,MIDI_DRONES_PRESSURE_HIGH_BYTE);sendToWARBL(MIDI_CC_105,x>>7)}}
function sendOctavePressure(selection){var x=parseFloat(selection);if(x<0||x>24||isNaN(x)){alert("Value must be 0.0 - 24.0.");document.getElementById("octavePressureInput").value=null}else{x=parseInt(x*900/24+100);blink(1);document.getElementById("octavePressureInput").style.backgroundColor="#32CD32";setTimeout(blinkOctave,500);sendToWARBL(MIDI_CC_104,MIDI_LEARNED_PRESS_LSB);sendToWARBL(MIDI_CC_105,x&0x7F);sendToWARBL(MIDI_CC_104,MIDI_LEARNED_PRESS_MSB);sendToWARBL(MIDI_CC_105,x>>7)}}
function sendOverblowSemitones(selection){var x=parseInt(selection);if(x<0||x>24||isNaN(x)){alert("Value must be 0 - 24.");document.getElementById("overblowSemitonesInput").value=null}else{blink(1);sendToWARBL(MIDI_CC_104,MIDI_OVERBLOW_SEMITONES);sendToWARBL(MIDI_CC_105,x)}}
function learn(){blink(1);document.getElementById("octavePressureInput").style.backgroundColor="#32CD32";setTimeout(blinkOctave,500);sendToWARBL(MIDI_CC_106,MIDI_LEARN_INITIAL_NOTE_PRESS)}
function sendCalibrateRadio(selection){selection=parseFloat(selection);blink(1);sendToWARBL(MIDI_CC_106,MIDI_STARTUP_CALIB+selection)}
function sendPitchbendRadio(selection){updateCustom();updateCustom();selection=parseFloat(selection);if(selection>0){blink(selection+1)}
sendToWARBL(MIDI_CC_102,MIDI_PB_MODE_START+selection)}
function sendVibratoHoles(holeNumber,selection){selection=+selection;sendToWARBL(MIDI_CC_106,(MIDI_DIS_VIBRATO_HOLES_START-(selection*10))+holeNumber)}
function sendVibratoHoles(holeNumber,selection){selection=+selection;sendToWARBL(MIDI_CC_106,(MIDI_DIS_VIBRATO_HOLES_START-(selection*10))+holeNumber)}
function sendHalfHoles(holeNumber,selection){if(selection==!0){halfHoles=setBit(halfHoles,holeNumber)}else{halfHoles=clearBit(halfHoles,holeNumber)}
const low4Bits=halfHoles&0x0F;const high4Bits=(halfHoles&0xF0)>>4;sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+33);sendToWARBL(MIDI_CC_105,low4Bits);sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+34);sendToWARBL(MIDI_CC_105,high4Bits)}
function setBit(number,bitPosition){const mask=1<<bitPosition;return number|mask}
function clearBit(number,bitPosition){const mask=~(1<<bitPosition);return number&mask}
function updateCustom(){var a=document.getElementById("fingeringSelect"+instrument).value;if(document.getElementById("pitchbendradio2").checked==!1&&(((a==0||a==1||a==4||a==10)&&((document.getElementById("pitchbendradio1").checked==!0&&version<1.6)||(version=="Unknown"||version>1.5)))||(version=="Unknown"||version>1.5)&&(a==3||a==2))){document.getElementById("checkbox5").disabled=!1;document.getElementById("switch5").style.cursor="pointer"}else{document.getElementById("checkbox5").disabled=!0;document.getElementById("switch5").style.cursor="default"}
if(document.getElementById("checkbox5").checked==!0&&document.getElementById("checkbox5").disabled==!1){for(var i=0;i<9;i++){document.getElementById("vibratoCheckbox"+i).disabled=!0;document.getElementById("vibratoCheckbox"+i).style.cursor="default"}}else{for(var i=0;i<9;i++){document.getElementById("vibratoCheckbox"+i).disabled=!1;document.getElementById("vibratoCheckbox"+i).style.cursor="pointer"}}
if(document.getElementById("checkbox18").checked==!0){document.getElementById("fingeringInput11").disabled=!0;document.getElementById("fingeringInput11").style.cursor="default"}else{document.getElementById("fingeringInput11").disabled=!1;document.getElementById("fingeringInput11").style.cursor="pointer"}
exprlowslider.noUiSlider.updateOptions({range:{'min':0,'max':100},start:[0,100]})}
function sendBreathmodeRadio(selection){selection=parseFloat(selection);if(selection>0){blink(selection+1)}
if(document.getElementById("sensorradio1").checked==!0){document.getElementById("checkbox16").disabled=!0;document.getElementById("overrideExprCheck").disabled=!0}else{document.getElementById("checkbox16").disabled=!1;document.getElementById("overrideExprCheck").disabled=!1}
sendToWARBL(MIDI_CC_102,MIDI_BREATH_MODE_START+selection);updateExpressionSliderEnableState()}
function advanced(){document.getElementById("box2").style.display="block";document.getElementById("box1").style.display="none";updateSelected()}
function advancedOkay(){document.getElementById("box2").style.display="none";document.getElementById("box1").style.display="block"}
function advancedPB(){if(version>1.8||version=="Unknown"){document.getElementById("box4").style.display="block";document.getElementById("box5").style.display="none"}}
function mapPressure(){document.getElementById("expressionPressureBox").style.display="block";document.getElementById("box9").style.display="none"}
function mapIMU(){document.getElementById("box10").style.display="block";document.getElementById("box9").style.display="none"}
function backPressure(){if(version>3.9&&version<4.5){document.getElementById("expressionPressureBox").style.display="none";document.getElementById("box9").style.display="block"}
if(version=="Unknown"){document.getElementById("expressionPressureBox").style.display="block";document.getElementById("box9").style.display="none"}}
function backIMU(){if(version<4.5){document.getElementById("box10").style.display="none"}
if(version>3.9&&version<4.5){document.getElementById("box9").style.display="block"}
if(version=="Unknown"){document.getElementById("box10").style.display="block";document.getElementById("box9").style.display="none"}}
function overRideExpression(){if(version>1.8||version=="Unknown"){if(document.getElementById("sensorradio1").checked==!0){document.getElementById("checkbox16").disabled=!0;document.getElementById("overrideExprCheck").disabled=!0}else{document.getElementById("checkbox16").disabled=!1;document.getElementById("overrideExprCheck").disabled=!1}
var dispval=version<4.3?"none":"block";document.getElementById("exprhighslider").style.display=dispval;document.getElementById("exprhighslider-value-min").style.display=dispval;document.getElementById("exprhighslider-value-max").style.display=dispval;document.getElementById("exprlowbendslider").style.display=dispval;document.getElementById("exprlowbendslider-value").style.display=dispval;document.getElementById("exprhighbendslider").style.display=dispval;document.getElementById("exprhighbendslider-value").style.display=dispval;document.getElementById("clampExprMaxLabel").style.display=dispval;document.getElementById("clampExprSwitch").style.display=dispval;document.getElementById("resetExpressionButton").style.display=dispval;document.getElementById("overrideRangeLabel").style.display=dispval;document.getElementById("overrideCentsLabel").style.display=dispval;document.getElementById("lowrangelabel").style.display=dispval;document.getElementById("lowrangelabel2").style.display=dispval;document.getElementById("highrangelabel").style.display=dispval;document.getElementById("highrangelabel2").style.display=dispval;document.getElementById("exprInputPressureLevelContainer").style.display=dispval;document.getElementById("exprcurvelowlabel").style.display=dispval;document.getElementById("exprcurvelowslider").style.display=dispval;document.getElementById("exprcurvelowslider-value").style.display=dispval;document.getElementById("exprcurvehighlabel").style.display=dispval;document.getElementById("exprcurvehighslider").style.display=dispval;document.getElementById("exprcurvehighslider-value").style.display=dispval;document.getElementById("box8").style.display="block";document.getElementById("expressionPressureBox").style.display="none"}}
function okayOverride(){document.getElementById("box8").style.display="none";document.getElementById("expressionPressureBox").style.display="block"}
function advancedOkayPB(){document.getElementById("box4").style.display="none";document.getElementById("box5").style.display="block"}
function configureCustomFingering(){if(version<3.9){document.getElementById("topControls").style.display="none";document.getElementById("customControls").style.display="block";document.getElementById("box1").style.top="740px";document.getElementById("box2").style.top="740px";document.getElementById("box4").style.top="740px";document.getElementById("box5").style.top="740px";document.getElementById("pressuregraph").style.top="740px";document.getElementById("box3").style.top="1200px";document.getElementById("expressionPressureBox").style.top="1200px";document.getElementById("box9").style.top="1200px";document.getElementById("box10").style.top="1200px";document.getElementById("box7").style.top="1200px";document.getElementById("box8").style.top="1200px";document.getElementById("buttonBox").style.top="1690px";document.getElementById("topcontrolbox").style.height="2155px"}else{document.getElementById("topControls").style.display="none";document.getElementById('WARBL2customFingeringFill').value='10';document.getElementById("WARBL2CustomTextArea").value='';document.getElementById("WARBL2customControls").style.display="block"}}
function customFingeringOkay(){document.getElementById("customControls").style.display="none";document.getElementById("WARBL2customControls").style.display="none";document.getElementById("topControls").style.display="block";if(version<3.9){document.getElementById("box1").style.top="440px";document.getElementById("box2").style.top="440px";document.getElementById("box4").style.top="440px";document.getElementById("box5").style.top="440px";document.getElementById("pressuregraph").style.top="440px";document.getElementById("box3").style.top="900px";document.getElementById("expressionPressureBox").style.top="900px";document.getElementById("box9").style.top="900px";document.getElementById("box10").style.top="900px";document.getElementById("box7").style.top="900px";document.getElementById("box8").style.top="900px";document.getElementById("topcontrolbox").style.height="1855px";document.getElementById("buttonBox").style.top="1390px"}
document.getElementById("customFingeringFill").value="12"}
function updatePressureValuesForSelection(){slider.noUiSlider.set([inputSliderMin[mapSelection],inputSliderMax[mapSelection]]);slider2.noUiSlider.set([outputSliderMin[mapSelection],outputSliderMax[mapSelection]]);document.getElementById("pressureShakeModDepth").value=pressureShakeDepth[mapSelection];document.getElementById("pressureShakeModDepthValue").innerHTML=pressureShakeDepth[mapSelection]+"%";document.getElementById("pressureShakeModCheck").checked=pressureShakeMod[mapSelection];document.getElementById("shakePressureModMode").value=pressureShakeModMode[mapSelection];if(curve[mapSelection]<3){document.getElementById("curveRadio"+curve[mapSelection]).checked=!0}}
function mapCC(){mapSelection=0;document.getElementById('receivedpressureCC').innerHTML=null;document.getElementById("CCpressurelevel").style.width=0+"%";document.getElementById("pressureChannel").style.visibility="visible";document.getElementById("pressureCC").style.visibility="visible";document.getElementById("expressionChannel").style.visibility="visible";document.getElementById("highByte").style.visibility="visible";document.getElementById("box7").style.display="block";document.getElementById("expressionPressureBox").style.display="none";var dispval=version<4.3?"none":"block";document.getElementById("pressureShakeModSwitch").style.display=dispval;document.getElementById("pressureShakeModLabel").style.display=dispval;document.getElementById("pressureMPEplusSwitch").style.display="none";document.getElementById("pressureMPEplusLabel").style.display="none";document.getElementById("pressureShakeModDepth").style.display=dispval;document.getElementById("pressureShakeModDepthLabel").style.display=dispval;document.getElementById("pressureShakeModDepthValue").style.display=dispval;document.getElementById("shakePressureModModeContainer").style.display=dispval;document.getElementById("pressureMappingHeader").innerHTML="CC Mapping";updatePressureValuesForSelection()}
function mapVelocity(){mapSelection=1;document.getElementById('receivedpressureCC').innerHTML=null;document.getElementById("CCpressurelevel").style.width=0+"%";document.getElementById("box7").style.display="block";document.getElementById("expressionPressureBox").style.display="none";document.getElementById("pressureMappingHeader").innerHTML="Velocity Mapping";document.getElementById("pressureShakeModSwitch").style.display="none";document.getElementById("pressureShakeModLabel").style.display="none";document.getElementById("pressureMPEplusSwitch").style.display="none";document.getElementById("pressureMPEplusLabel").style.display="none";document.getElementById("pressureShakeModDepth").style.display="none";document.getElementById("pressureShakeModDepthLabel").style.display="none";document.getElementById("pressureShakeModDepthValue").style.display="none";document.getElementById("shakePressureModModeContainer").style.display="none";updatePressureValuesForSelection()}
function mapAftertouch(){mapSelection=2;document.getElementById('receivedpressureCC').innerHTML=null;document.getElementById("CCpressurelevel").style.width=0+"%";document.getElementById("box7").style.display="block";document.getElementById("expressionPressureBox").style.display="none";document.getElementById("pressureMappingHeader").innerHTML="Channel Pressure Mapping";var dispval=version<4.3?"none":"block";document.getElementById("pressureShakeModSwitch").style.display=dispval;document.getElementById("pressureShakeModLabel").style.display=dispval;document.getElementById("pressureMPEplusSwitch").style.display=dispval;document.getElementById("pressureMPEplusLabel").style.display=dispval;document.getElementById("pressureShakeModDepth").style.display=dispval;document.getElementById("pressureShakeModDepthLabel").style.display=dispval;document.getElementById("pressureShakeModDepthValue").style.display=dispval;document.getElementById("shakePressureModModeContainer").style.display=dispval;updatePressureValuesForSelection()}
function mapPoly(){mapSelection=3;document.getElementById('receivedpressureCC').innerHTML=null;document.getElementById("CCpressurelevel").style.width=0+"%";document.getElementById("box7").style.display="block";document.getElementById("expressionPressureBox").style.display="none";document.getElementById("pressureMappingHeader").innerHTML="Key Pressure Mapping";var dispval=version<4.3?"none":"block";document.getElementById("pressureShakeModSwitch").style.display=dispval;document.getElementById("pressureShakeModLabel").style.display=dispval;document.getElementById("pressureMPEplusSwitch").style.display="none";document.getElementById("pressureMPEplusLabel").style.display="none";document.getElementById("pressureShakeModDepth").style.display=dispval;document.getElementById("pressureShakeModDepthLabel").style.display=dispval;document.getElementById("pressureShakeModDepthValue").style.display=dispval;document.getElementById("shakePressureModModeContainer").style.display=dispval;updatePressureValuesForSelection()}
function okayCCmap(){mapSelection=4;document.getElementById("box7").style.display="none";document.getElementById("expressionPressureBox").style.display="block";document.getElementById("pressureChannel").style.visibility="hidden";document.getElementById("pressureCC").style.visibility="hidden";document.getElementById("expressionChannel").style.visibility="hidden";document.getElementById("highByte").style.visibility="hidden"}
function mapRoll(){IMUmapSelection=1;document.getElementById('receivedCC').innerHTML=null;document.getElementById("CClevel").style.width=0+"%";document.getElementById("checkbox23").checked=center[1];document.getElementById("IMUChannelInput").value=IMUchannel[0];document.getElementById("IMUCC").value=IMUnumber[0];slider5.noUiSlider.set([inputSliderMin[4],inputSliderMax[4]]);slider4.noUiSlider.set([outputSliderMin[4],outputSliderMax[4]]);document.getElementById("box10").style.display="none";document.getElementById("box11").style.display="block";document.getElementById("IMUMappingHeader").innerHTML="Roll Mapping";document.getElementById("centerLabel").style.display="block";document.getElementById("switch23").style.display="block"}
function mapPitch(){IMUmapSelection=2;document.getElementById('receivedCC').innerHTML=null;document.getElementById("CClevel").style.width=0+"%";document.getElementById("IMUChannelInput").value=IMUchannel[1];document.getElementById("IMUCC").value=IMUnumber[1];slider5.noUiSlider.set([inputSliderMin[5],inputSliderMax[5]]);slider4.noUiSlider.set([outputSliderMin[5],outputSliderMax[5]]);document.getElementById("box10").style.display="none";document.getElementById("box11").style.display="block";document.getElementById("IMUMappingHeader").innerHTML="Elevation Mapping";document.getElementById("centerLabel").style.display="none";document.getElementById("switch23").style.display="none"}
function mapYaw(){IMUmapSelection=3;document.getElementById("YawCenterControls").style.display="block";document.getElementById("IMUMappingControls").style.top="-190px";document.getElementById('receivedCC').innerHTML=null;document.getElementById("CClevel").style.width=0+"%";document.getElementById("IMUChannelInput").value=IMUchannel[2];document.getElementById("IMUCC").value=IMUnumber[2];document.getElementById("checkbox23").checked=center[3];slider5.noUiSlider.set([inputSliderMin[6],inputSliderMax[6]]);slider4.noUiSlider.set([outputSliderMin[6],outputSliderMax[6]]);document.getElementById("box10").style.display="none";document.getElementById("box11").style.display="block";document.getElementById("IMUMappingHeader").innerHTML="Yaw Mapping";document.getElementById("centerLabel").style.display="block";document.getElementById("switch23").style.display="block"}
function mapRollPitchbend(){IMUpitchSelection=1;document.getElementById("box10").style.display="none";document.getElementById("box13").style.display="block";updateRolltoPitchbendSliders()}
function updateRolltoPitchbendSliders(){document.getElementById("IMUPitchbendMappingHeader").innerHTML="Roll Pitch Bend Mapping";IMUlowslider.noUiSlider.set([IMUtoPitchSettingsRoll[0],IMUtoPitchSettingsRoll[2]]);IMUhighslider.noUiSlider.set([IMUtoPitchSettingsRoll[3],IMUtoPitchSettingsRoll[1]]);IMUlowbendslider.noUiSlider.set([IMUtoPitchSettingsRoll[4],null]);IMUhighbendslider.noUiSlider.set([IMUtoPitchSettingsRoll[5],null]);document.getElementById("IMUcurvelowslider").value=IMUtoPitchSettingsRoll[7];document.getElementById("IMUcurvehighslider").value=IMUtoPitchSettingsRoll[8];document.getElementById("clampIMUCheck").checked=IMUtoPitchSettingsRoll[6];updateIMUCurveLabels()}
function mapPitchPitchbend(){IMUpitchSelection=2;document.getElementById("box10").style.display="none";document.getElementById("box13").style.display="block";updatePitchtoPitchbendSliders()}
function updatePitchtoPitchbendSliders(){document.getElementById("IMUPitchbendMappingHeader").innerHTML="Elevation Pitch Bend Mapping";IMUlowslider.noUiSlider.set([IMUtoPitchSettingsPitch[0],IMUtoPitchSettingsPitch[2]]);IMUhighslider.noUiSlider.set([IMUtoPitchSettingsPitch[3],IMUtoPitchSettingsPitch[1]]);IMUlowbendslider.noUiSlider.set([IMUtoPitchSettingsPitch[4],null]);IMUhighbendslider.noUiSlider.set([IMUtoPitchSettingsPitch[5],null]);document.getElementById("IMUcurvelowslider").value=IMUtoPitchSettingsPitch[7];document.getElementById("IMUcurvehighslider").value=IMUtoPitchSettingsPitch[8];document.getElementById("clampIMUCheck").checked=IMUtoPitchSettingsPitch[6];updateIMUCurveLabels()}
function mapYawPitchbend(){IMUpitchSelection=3;document.getElementById("box10").style.display="none";document.getElementById("box13").style.display="block";updateYawtoPitchbendSliders()}
function updateYawtoPitchbendSliders(){document.getElementById("IMUPitchbendMappingHeader").innerHTML="Yaw Pitch Bend Mapping";IMUlowslider.noUiSlider.set([IMUtoPitchSettingsYaw[0],IMUtoPitchSettingsYaw[2]]);IMUhighslider.noUiSlider.set([IMUtoPitchSettingsYaw[3],IMUtoPitchSettingsYaw[1]]);IMUlowbendslider.noUiSlider.set([IMUtoPitchSettingsYaw[4],null]);IMUhighbendslider.noUiSlider.set([IMUtoPitchSettingsYaw[5],null]);document.getElementById("IMUcurvelowslider").value=IMUtoPitchSettingsYaw[7];document.getElementById("IMUcurvehighslider").value=IMUtoPitchSettingsYaw[8];document.getElementById("clampIMUCheck").checked=IMUtoPitchSettingsYaw[6];updateIMUCurveLabels()}
function mapPitchRegister(){document.getElementById('receivedCC').innerHTML=null;document.getElementById("CClevel").style.width=0+"%";document.getElementById("IMUChannelInput").value=IMUchannel[1];document.getElementById("IMUCC").value=IMUnumber[1];slider5.noUiSlider.set([inputSliderMin[5],inputSliderMax[5]]);slider4.noUiSlider.set([outputSliderMin[5],outputSliderMax[5]]);document.getElementById("box10").style.display="none";document.getElementById("box12").style.display="block";document.getElementById("IMUMappingHeader").innerHTML="Pitch Mapping";document.getElementById("centerLabel").style.display="none";document.getElementById("switch23").style.display="none"}
function okayIMUmap(){document.getElementById("YawCenterControls").style.display="none";document.getElementById("IMUMappingControls").style.top="-170px";document.getElementById("box11").style.display="none";document.getElementById("box10").style.display="block"}
function okayIMUPitchbend(){document.getElementById("box13").style.display="none";document.getElementById("box10").style.display="block"}
function okayPitchRegistermap(){document.getElementById("box12").style.display="none";document.getElementById("box10").style.display="block"}
function sendCenter(selection){selection=+selection;center[IMUmapSelection]=selection;blink(1);if(IMUmapSelection==1){sendToWARBL(MIDI_CC_109,MIDI_SEND_CENTER_ROLL)}else{sendToWARBL(MIDI_CC_109,MIDI_SEND_CENTER_YAW)}
sendToWARBL(MIDI_CC_105,selection)}
function sendIMUChannel(selection){selection=+selection;blink(1);IMUchannel[IMUmapSelection-1]=selection;sendToWARBL(MIDI_CC_109,IMUmapSelection-1+MIDI_IMU_CHANNEL_START);sendToWARBL(MIDI_CC_105,selection)}
function sendIMUCC(selection){selection=+selection;blink(1);IMUnumber[IMUmapSelection-1]=selection;sendToWARBL(MIDI_CC_109,IMUmapSelection-1+MIDI_IMU_CC_START);sendToWARBL(MIDI_CC_105,selection)}
function pressureGraph(){document.getElementById("pressuregraph").style.display="block";document.getElementById("box1").style.display="none";startPressureGraph()}
function pressureOkay(){stopPressureGraph();document.getElementById("pressuregraph").style.display="none";document.getElementById("box1").style.display="block"}
function advancedDefaults(){if(version>2.0||version=="Unknown"){document.getElementById("jumpFactor7").value="3";document.getElementById("jumpFactor8").value="7";document.getElementById("jumpFactor9").value="20";document.getElementById("jumpFactor11").value="3";document.getElementById("jumpFactor12").value="10";for(var i=7;i<10;i++){var k=document.getElementById("jumpFactor"+(i));k.dispatchEvent(new Event('input'));var j=document.getElementById("jumpFactor"+(i)).value;sendJumpFactor(i,j)}
for(var i=11;i<13;i++){var k=document.getElementById("jumpFactor"+(i));k.dispatchEvent(new Event('input'));var j=document.getElementById("jumpFactor"+(i)).value;sendJumpFactor(i,j)}}else{document.getElementById("jumpFactor1").value="25";document.getElementById("jumpFactor2").value="15";document.getElementById("jumpFactor3").value="15";document.getElementById("jumpFactor4").value="15";document.getElementById("jumpFactor5").value="30";document.getElementById("jumpFactor6").value="60";document.getElementById("jumpFactor7").value="3";document.getElementById("jumpFactor8").value="7";document.getElementById("jumpFactor9").value="100";document.getElementById("jumpFactor10").value="7";document.getElementById("jumpFactor11").value="9";document.getElementById("jumpFactor12").value="9";for(var i=1;i<13;i++){var k=document.getElementById("jumpFactor"+(i));k.dispatchEvent(new Event('input'));var j=document.getElementById("jumpFactor"+(i)).value;sendJumpFactor(i,j)}}}
function advancedBagDefaults(){if(version>2.0||version=="Unknown"){document.getElementById("jumpFactor1").value="50";document.getElementById("jumpFactor2").value="20";document.getElementById("jumpFactor3").value="20";document.getElementById("jumpFactor4").value="50";document.getElementById("jumpFactor6").value="75";for(var i=1;i<7;i++){var k=document.getElementById("jumpFactor"+(i));k.dispatchEvent(new Event('input'));var j=document.getElementById("jumpFactor"+(i)).value;sendJumpFactor(i,j)}}else{document.getElementById("jumpFactor1").value="75";document.getElementById("jumpFactor2").value="25";document.getElementById("jumpFactor3").value="15";document.getElementById("jumpFactor4").value="15";document.getElementById("jumpFactor5").value="30";document.getElementById("jumpFactor6").value="60";document.getElementById("jumpFactor7").value="50";document.getElementById("jumpFactor8").value="20";document.getElementById("jumpFactor9").value="28";document.getElementById("jumpFactor10").value="7";document.getElementById("jumpFactor11").value="15";document.getElementById("jumpFactor12").value="22";for(var i=1;i<13;i++){var k=document.getElementById("jumpFactor"+(i));k.dispatchEvent(new Event('input'));var j=document.getElementById("jumpFactor"+(i)).value;sendJumpFactor(i,j)}}}
function sendJumpFactor(factor,selection){selection=parseFloat(selection);blink(1);sendToWARBL(MIDI_CC_104,factor);sendToWARBL(MIDI_CC_105,selection)}
function sendRow(rowNum){blink(1);updateCells();sendToWARBL(MIDI_CC_102,MIDI_GESTURE_START+rowNum);var y=(100)+parseFloat(document.getElementById("row"+rowNum).value);if(version<4.0){sendToWARBL(MIDI_CC_102,y);sendMIDIrow(rowNum)}else sendToWARBL(MIDI_CC_106,y);if(rowNum<3){sendMomentary(rowNum)}}
function sendMIDIrow(MIDIrowNum){blink(1);updateCells();sendToWARBL(MIDI_CC_102,MIDI_GESTURE_START+MIDIrowNum);var y=(112)+parseFloat(document.getElementById("MIDIrow"+MIDIrowNum).value);sendToWARBL(MIDI_CC_102,y);if(MIDIrowNum<3){sendMomentary(MIDIrowNum)}}
function sendChannel(rowNum){blink(1);MIDIvalueChange();var y=parseFloat(document.getElementById("channel"+(rowNum)).value);sendToWARBL(MIDI_CC_102,MIDI_GESTURE_START+rowNum);sendToWARBL(MIDI_CC_106,y)}
function sendByte2(rowNum){blink(1);MIDIvalueChange();sendToWARBL(MIDI_CC_102,MIDI_GESTURE_START+rowNum);var y=parseFloat(document.getElementById("byte2_"+(rowNum)).value);sendToWARBL(MIDI_CC_107,y)}
function sendByte3(rowNum){blink(1);MIDIvalueChange();sendToWARBL(MIDI_CC_102,MIDI_GESTURE_START+rowNum);var y=parseFloat(document.getElementById("byte3_"+(rowNum)).value);sendToWARBL(MIDI_CC_108,y)}
function sendMomentary(rowNum){blink(1);updateCells();var y=document.getElementById("checkbox"+rowNum).checked
sendToWARBL(MIDI_CC_102,MIDI_GESTURE_START+rowNum);if(y==!1){sendToWARBL(MIDI_CC_102,MIDI_MOMENTARY_OFF)}
if(y==!0){sendToWARBL(MIDI_CC_102,MIDI_MOMENTARY_ON)}}
function sendVented(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START);sendToWARBL(MIDI_CC_105,selection);updateSelected()}
function sendBagless(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+1);sendToWARBL(MIDI_CC_105,selection)}
function sendSecret(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+2);sendToWARBL(MIDI_CC_105,selection)}
function sendInvert(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+3);sendToWARBL(MIDI_CC_105,selection)}
function sendCustom(selection){selection=+selection;blink(1);updateCustom();sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+4);sendToWARBL(MIDI_CC_105,selection)}
function sendHalfhole(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+29);sendToWARBL(MIDI_CC_105,selection)}
function sendHalfholeMIDI(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+35);sendToWARBL(MIDI_CC_105,selection)}
function sendHalfholeThumb(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+36);sendToWARBL(MIDI_CC_105,selection)}
function sendUseThumb(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_ED_VARS2_START+37);sendToWARBL(MIDI_CC_105,selection)}
function sendExpression(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_ED_VARS_START);sendToWARBL(MIDI_CC_105,selection)}
function sendRawPressure(selection){selection=+selection;updateCustom();blink(1);sendToWARBL(MIDI_CC_104,MIDI_SEND_PRESSURE);sendToWARBL(MIDI_CC_105,selection)}
function sendVelocity(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+5);sendToWARBL(MIDI_CC_105,selection);updateCells()}
function sendAftertouch(selection,polyselection){selection=+selection;var val=selection|((+polyselection)<<1);blink(1);sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+6);sendToWARBL(MIDI_CC_105,val)}
function sendForceVelocity(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+7);sendToWARBL(MIDI_CC_105,selection)}
function sendHack1(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+8);sendToWARBL(MIDI_CC_105,selection)}
function sendHack2(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+9);sendToWARBL(MIDI_CC_105,selection)}
function updateExpressionCenterPressureLabel(){var slider=document.getElementById('exprfixedcenterslider');var element=document.getElementById('exprfixedcenterslider-value');var min=parseFloat(slider.value*0.24).toFixed(1);element.innerHTML=min}
function updateExpressionCurveLabel(theslider,thelabel){var val=parseInt(theslider.value-64);if(val==0){thelabel.innerHTML="Linear"}else if(val>0){thelabel.innerHTML=((3*val/63.0)+1).toFixed(2)}else{thelabel.innerHTML=(0.75*(64+val)/64.0+0.25).toFixed(3)}}
function updateExpressionCurveLabels(){var lowslider=document.getElementById('exprcurvelowslider');var lowelement=document.getElementById('exprcurvelowslider-value');updateExpressionCurveLabel(lowslider,lowelement);var highslider=document.getElementById('exprcurvehighslider');var highelement=document.getElementById('exprcurvehighslider-value');updateExpressionCurveLabel(highslider,highelement)}
function updateIMUCurveLabel(theslider,thelabel){var val=parseInt(theslider.value-64);if(val==0){thelabel.innerHTML="Linear"}else if(val>0){thelabel.innerHTML=((3*val/63.0)+1).toFixed(2)}else{thelabel.innerHTML=(0.75*(64+val)/64.0+0.25).toFixed(3)}}
function updateIMUCurveLabels(){var lowslider=document.getElementById('IMUcurvelowslider');var lowelement=document.getElementById('IMUcurvelowslider-value');updateIMUCurveLabel(lowslider,lowelement);var highslider=document.getElementById('IMUcurvehighslider');var highelement=document.getElementById('IMUcurvehighslider-value');updateIMUCurveLabel(highslider,highelement)}
function updateExpressionSliderEnableState(){var overidden=document.getElementById("overrideExprCheck").checked;var overblow=document.getElementById("sensorradio1").checked;document.getElementById("expressionDepth").disabled=overidden&&!overblow;document.getElementById("exprfixedcenterslider").disabled=overidden||overblow;var dispval=version<4.3?"none":"block";document.getElementById("exprfixedcenterslider").style.display=dispval;document.getElementById("exprfixedcenterslider-value").style.display=dispval;document.getElementById("exprcenterpresslabel").style.display=dispval;document.getElementById("overrideExprCheck").disabled=overblow}
function curveValToExponent(val){var retval=1.0;val-=64;if(val>=0){retval=((3.0*val/63.0)+1.0)}else{retval=(0.75*(64.0+val)/64.0+0.25)}
return retval}
function calculateOutExprBendFromInput(sensorValue){let overblow=document.getElementById("sensorradio1").checked;let overidden=document.getElementById("overrideExprCheck").checked;if(!overidden||overblow){return 0.0}
let lowPressureMin=parseInt(exprlowslider.noUiSlider.get()[0])*9+100;let lowPressureMax=parseInt(exprlowslider.noUiSlider.get()[1])*9+100;let highPressureMin=parseInt(exprhighslider.noUiSlider.get()[0])*9+100;let highPressureMax=parseInt(exprhighslider.noUiSlider.get()[1])*9+100;var centsLowOffset=2*(parseInt(exprlowbendslider.noUiSlider.get()[0])-64);var centsHighOffset=2*(parseInt(exprhighbendslider.noUiSlider.get()[0])-64);var lowCurveExp=curveValToExponent(parseInt(document.getElementById("exprcurvelowslider").value));var highCurveExp=curveValToExponent(parseInt(document.getElementById("exprcurvehighslider").value));let doClamp=document.getElementById("clampExprCheck").checked;var centsOffset=0.0;var ratio=0.0;let lowRangeSpan=Math.max(lowPressureMax-lowPressureMin,1);let highRangeSpan=Math.max(highPressureMax-highPressureMin,1);if(sensorValue<=lowPressureMax){ratio=Math.min(((lowPressureMax-sensorValue))/(lowRangeSpan),1.0);if(lowCurveExp!=1.0){ratio=Math.pow(ratio,lowCurveExp)}
centsOffset=centsLowOffset*ratio}else if(sensorValue>=highPressureMin){ratio=Math.max(((sensorValue-highPressureMin))/(highRangeSpan),0.0);if(highCurveExp!=1.0){ratio=Math.pow(ratio,highCurveExp)}
if(doClamp){ratio=Math.min(ratio,1.0)}
centsOffset=centsHighOffset*ratio}else{centsOffset=0}
return centsOffset}
function sendOverride(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+10);sendToWARBL(MIDI_CC_105,selection);document.getElementById("overrideExprCheck").checked=selection;document.getElementById("checkbox16").checked=selection;updateExpressionSliderEnableState()}
function sendBoth(selection){selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+11);sendToWARBL(MIDI_CC_105,selection)}
function sendR4flatten(selection){selection=+selection;blink(1);updateCustom();sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+12);sendToWARBL(MIDI_CC_105,selection)}
function updateDoubleClick(){if(document.getElementById("cbDoubleClick").checked){document.getElementById("gestureLabel0").innerHTML="Double-click 1";document.getElementById("gestureLabel1").innerHTML="Double-click 2";document.getElementById("gestureLabel2").innerHTML="Double-click 3"}else{document.getElementById("gestureLabel0").innerHTML="Click 1";document.getElementById("gestureLabel1").innerHTML="Click 2";document.getElementById("gestureLabel2").innerHTML="Click 3"}}
function sendDoubleClick(selection){updateDoubleClick();selection=+selection;blink(1);sendToWARBL(MIDI_CC_104,MIDI_SWITCHES_VARS_START+13);sendToWARBL(MIDI_CC_105,selection)}
function calibrateIMU(){blink(1);sendToWARBL(MIDI_CC_106,MIDI_CALIB_IMU)}
function centerYaw(){blink(1);sendToWARBL(MIDI_CC_106,MIDI_CENTER_YAW)}
function resetPitchExpressionOverride(){blink(1);sendToWARBL(MIDI_CC_106,MIDI_RESET_PITCH_EXPRESSION);setTimeout(function(){sendToWARBL(MIDI_CC_102,MIDI_ENTER_COMM_MODE);setTimeout(function(){mapPressure();overRideExpression()},500)},500)}
function resetIMUPitch(){blink(1);if(IMUpitchSelection==1){IMUtoPitchSettingsRoll=IMURolltoPitchSettingsDefaults.slice(0);for(var i=0;i<9;i++){sendToWARBL(MIDI_CC_109,IMU_ROLL_PITCH_MIN+i);sendToWARBL(MIDI_CC_105,parseInt(IMUtoPitchSettingsRoll[i]))}
IMUlowslider.noUiSlider.set([IMUtoPitchSettingsRoll[0],IMUtoPitchSettingsRoll[2]]);IMUhighslider.noUiSlider.set([IMUtoPitchSettingsRoll[3],IMUtoPitchSettingsRoll[1]]);IMUlowbendslider.noUiSlider.set([IMUtoPitchSettingsRoll[4],null]);IMUhighbendslider.noUiSlider.set([IMUtoPitchSettingsRoll[5],null]);document.getElementById("IMUcurvelowslider").value=IMUtoPitchSettingsRoll[7];document.getElementById("IMUcurvehighslider").value=IMUtoPitchSettingsRoll[8];document.getElementById("clampIMUCheck").checked=IMUtoPitchSettingsRoll[6]}else if(IMUpitchSelection==2){IMUtoPitchSettingsPitch=IMUElevationtoPitchSettingsDefaults.slice(0);for(var i=0;i<9;i++){sendToWARBL(MIDI_CC_109,IMU_ELEVATION_PITCH_MIN+i);sendToWARBL(MIDI_CC_105,parseInt(IMUtoPitchSettingsPitch[i]))}
IMUlowslider.noUiSlider.set([IMUtoPitchSettingsPitch[0],IMUtoPitchSettingsPitch[2]]);IMUhighslider.noUiSlider.set([IMUtoPitchSettingsPitch[3],IMUtoPitchSettingsPitch[1]]);IMUlowbendslider.noUiSlider.set([IMUtoPitchSettingsPitch[4],null]);IMUhighbendslider.noUiSlider.set([IMUtoPitchSettingsPitch[5],null]);document.getElementById("IMUcurvelowslider").value=IMUtoPitchSettingsPitch[7];document.getElementById("IMUcurvehighslider").value=IMUtoPitchSettingsPitch[8];document.getElementById("clampIMUCheck").checked=IMUtoPitchSettingsPitch[6]}else if(IMUpitchSelection==3){IMUtoPitchSettingsYaw=IMUYawtoPitchSettingsDefaults.slice(0);for(var i=0;i<9;i++){sendToWARBL(MIDI_CC_109,IMU_YAW_PITCH_MIN+i);sendToWARBL(MIDI_CC_105,parseInt(IMUtoPitchSettingsYaw[i]))}
IMUlowslider.noUiSlider.set([IMUtoPitchSettingsYaw[0],IMUtoPitchSettingsYaw[2]]);IMUhighslider.noUiSlider.set([IMUtoPitchSettingsYaw[3],IMUtoPitchSettingsYaw[1]]);IMUlowbendslider.noUiSlider.set([IMUtoPitchSettingsYaw[4],null]);IMUhighbendslider.noUiSlider.set([IMUtoPitchSettingsYaw[5],null]);document.getElementById("IMUcurvelowslider").value=IMUtoPitchSettingsYaw[7];document.getElementById("IMUcurvehighslider").value=IMUtoPitchSettingsYaw[8];document.getElementById("clampIMUCheck").checked=IMUtoPitchSettingsYaw[6]}}
function WARBL2Radio(selection){blink(1);selection=parseFloat(selection);sendToWARBL(MIDI_CC_106,MIDI_WARBL2_SETTINGS_START);sendToWARBL(MIDI_CC_119,selection)}
function sendHost(selection){blink(1);selection=+selection;sendToWARBL(MIDI_CC_106,MIDI_WARBL2_SETTINGS_START+1);sendToWARBL(MIDI_CC_119,selection)}
function sendPoweroff(selection){selection=parseFloat(selection);blink(1);sendToWARBL(MIDI_CC_106,MIDI_WARBL2_SETTINGS_START+2);sendToWARBL(MIDI_CC_119,selection)}
function saveAsDefaults(){modalclose(2);blink(3);sendToWARBL(MIDI_CC_102,MIDI_SAVE_AS_DEFAULTS_CURRENT)}
function saveCalibAsFactoryDefault(){modalclose(2);blink(3);sendToWARBL(MIDI_CC_106,MIDI_SAVE_CALIB_AS_FACTORY)}
function saveAsDefaultsForAll(){modalclose(3);blink(3);sendToWARBL(MIDI_CC_102,MIDI_SAVE_AS_DEFAULTS_ALL)}
function restoreAll(){modalclose(4);blink(3);sendToWARBL(MIDI_CC_102,MIDI_RESTORE_FACTORY);communicationMode=0;if(version>1.9&&version<4.0){setTimeout(connect,3000)}}
function autoCalibrateBell(){if(communicationMode){LEDon()}
setTimeout(LEDoff,5000);sendToWARBL(MIDI_CC_106,MIDI_CALIB_BELL_SENSOR)}
function autoCalibrate(){if(communicationMode){LEDon()}
setTimeout(LEDoff,10000);sendToWARBL(MIDI_CC_102,MIDI_START_CALIB)}
function frequencyFromNoteNumber(note){return 440*Math.pow(2,(note-69)/12)}
function modal(modalId){document.getElementById("open-modal"+modalId).classList.add('modal-window-open');if(modalId==18){clearConsole()}
if(modalId==25){document.getElementById("sending").innerHTML="Sending...";document.getElementById("WARBL2CustomSuccessOkay").style.display="none"}}
function modalclose(modalId){document.getElementById("open-modal"+modalId).classList.remove('modal-window-open')}
function blink(blinkNum){if(communicationMode){LEDon();setTimeout(LEDoff,200);if(blinkNum>1){setTimeout(LEDon,400);setTimeout(LEDoff,600)}
if(blinkNum>2){setTimeout(LEDon,800);setTimeout(LEDoff,1000)}
if(blinkNum>3){setTimeout(LEDon,1200);setTimeout(LEDoff,1400)}
if(blinkNum>4){setTimeout(LEDon,1600);setTimeout(LEDoff,1800)}}}
function checkMax(field){var x=document.getElementById("v"+field).textContent;if(x=="MAX"){document.getElementById(field*2).disabled=!0}
if(x!="MAX"){document.getElementById(field*2).disabled=!1}}
function isEven(n){return n%2==0}
function isOdd(n){return Math.abs(n%2)==1}
function LEDoff(){elements=document.getElementsByClassName("leddot");for(var i=0;i<elements.length;i++){elements[i].style.visibility="hidden"}}
function LEDon(){elements=document.getElementsByClassName("leddot");for(var i=0;i<elements.length;i++){elements[i].style.visibility="visible"}}
function toggleOn(){volume=+!volume;if(volume==0){document.getElementById("volumeOff").style.display="block";document.getElementById("volumeOn").style.display="none";noteOff(currentNote)}else{document.getElementById("volumeOff").style.display="none";document.getElementById("volumeOn").style.display="block"}}
function logKeys(){var s='Keys';for(var i=0;i<midiNotes.length;i++){s=s+' '+midiNotes[i].pitch}}
function noteOn(pitch){noteOff(pitch);currentNote=pitch;if(volume){for(var i=0;i<_tone_0650_SBLive_sf2.zones.length;i++){_tone_0650_SBLive_sf2.zones[i].ahdsr=!1}
var envelope=player.queueWaveTable(audioContext,audioContext.destination,_tone_0650_SBLive_sf2,0,pitch,999,0.5,!0);var note={pitch:pitch,envelope:envelope};midiNotes.push(note)}}
function noteOff(pitch){for(var i=0;i<midiNotes.length;i++){if(midiNotes[i].pitch==pitch){if(midiNotes[i].envelope){midiNotes[i].envelope.cancel()}
midiNotes.splice(i,1);return}}}
var output18=document.getElementById("demo18");var slideLimitSlider=document.getElementById('slidelimit');slideLimitSlider.addEventListener('input',sliderLimitChange);function sliderLimitChange(){output18.innerHTML=slideLimitSlider.value}
var output14=document.getElementById("demo14");var depthSlider=document.getElementById('depth');depthSlider.addEventListener('input',slider14Change);function slider14Change(){output14.innerHTML=depthSlider.value}
var output15=document.getElementById("demo15");var shakeDepthSlider=document.getElementById('shakeDepth');shakeDepthSlider.addEventListener('input',slider15Change);function slider15Change(){output15.innerHTML=shakeDepthSlider.value}
var output16=document.getElementById("demo16");var autoCenterYawSlider=document.getElementById('autoCenterYawInterval');autoCenterYawSlider.addEventListener('input',slider16Change);function slider16Change(){output16.innerHTML=autoCenterYawSlider.value/4}
var output17=document.getElementById("demo17");var pitchRegisterSlider=document.getElementById('pitchRegisterNumber');pitchRegisterSlider.addEventListener('input',slider17Change);function slider17Change(){output17.innerHTML=pitchRegisterSlider.value}
var output1=document.getElementById("demo1");var jumpSlider1=document.getElementById('jumpFactor1');jumpSlider1.addEventListener('input',slider1Change);function slider1Change(){output1.innerHTML=jumpSlider1.value}
var output2=document.getElementById("demo2");var jumpSlider2=document.getElementById('jumpFactor2');jumpSlider2.addEventListener('input',slider2Change);function slider2Change(){output2.innerHTML=jumpSlider2.value}
var output3=document.getElementById("demo3");var jumpSlider3=document.getElementById('jumpFactor3');jumpSlider3.addEventListener('input',slider3Change);function slider3Change(){output3.innerHTML=jumpSlider3.value}
var output4=document.getElementById("demo4");var jumpSlider4=document.getElementById('jumpFactor4');jumpSlider4.addEventListener('input',slider4Change);function slider4Change(){output4.innerHTML=jumpSlider4.value}
var output5=document.getElementById("demo5");var jumpSlider5=document.getElementById('jumpFactor5');jumpSlider5.addEventListener('input',slider5Change);function slider5Change(){output5.innerHTML=jumpSlider5.value}
var output6=document.getElementById("demo6");var jumpSlider6=document.getElementById('jumpFactor6');jumpSlider6.addEventListener('input',slider6Change);function slider6Change(){output6.innerHTML=jumpSlider6.value}
var output7=document.getElementById("demo7");var jumpSlider7=document.getElementById('jumpFactor7');jumpSlider7.addEventListener('input',slider7Change);function slider7Change(){output7.innerHTML=jumpSlider7.value}
var output8=document.getElementById("demo8");var jumpSlider8=document.getElementById('jumpFactor8');jumpSlider8.addEventListener('input',slider8Change);function slider8Change(){output8.innerHTML=jumpSlider8.value}
var output9=document.getElementById("demo9");var jumpSlider9=document.getElementById('jumpFactor9');jumpSlider9.addEventListener('input',slider9Change);function slider9Change(){output9.innerHTML=jumpSlider9.value}
var output10=document.getElementById("demo10");var jumpSlider10=document.getElementById('jumpFactor10');jumpSlider10.addEventListener('input',slider10Change);function slider10Change(){output10.innerHTML=jumpSlider10.value}
var output10b=document.getElementById("demo10b");var jumpSlider10b=document.getElementById('jumpFactor10b');jumpSlider10b.addEventListener('input',slider10bChange);function slider10bChange(){output10b.innerHTML=jumpSlider10b.value}
var output11=document.getElementById("demo11");var jumpSlider11=document.getElementById('jumpFactor11');jumpSlider11.addEventListener('input',slider11Change);function slider11Change(){output11.innerHTML=jumpSlider11.value}
var output12=document.getElementById("demo12");var jumpSlider12=document.getElementById('jumpFactor12');jumpSlider12.addEventListener('input',slider12Change);function slider12Change(){output12.innerHTML=jumpSlider12.value}
var output19=document.getElementById("demo19");var jumpSlider19=document.getElementById('halfholeOffset');jumpSlider19.addEventListener('input',slider19Change);function slider19Change(){output19.innerHTML=jumpSlider19.value}
var output20=document.getElementById("demo20");var jumpSlider20=document.getElementById('halfholeSize');jumpSlider20.addEventListener('input',slider20Change);function slider20Change(){output20.innerHTML=jumpSlider20.value}
var output21=document.getElementById("demo21");var jumpSlider21=document.getElementById('halfholeRate');jumpSlider21.addEventListener('input',slider21Change);function slider21Change(){output21.innerHTML=jumpSlider21.value}
var outputPoweroff=document.getElementById("poweroffValue");var poweroffSlider=document.getElementById('poweroffSlider');poweroffSlider.addEventListener('input',poweroffSliderChange);function poweroffSliderChange(){var value=poweroffSlider.value;if(version>4.4&&value==25){value=""}
outputPoweroff.innerHTML=value}
var pressureShakeModDepthValue=document.getElementById("pressureShakeModDepthValue");var pressureShakeModDepthSlider=document.getElementById('pressureShakeModDepth');pressureShakeModDepthSlider.addEventListener('input',pressureShakeModDepthSliderChange);function pressureShakeModDepthSliderChange(){pressureShakeModDepthValue.innerHTML=pressureShakeModDepthSlider.value+"%"}
function clearConsole(){document.getElementById("console").innerHTML="";consoleEntries=0}
function updateCells(){if(version>1.6){var p=document.getElementById("checkbox10").checked;if(p==!0){document.getElementById("checkbox12").disabled=!0;document.getElementById("switch12").style.cursor="default"}else{document.getElementById("checkbox12").disabled=!1;document.getElementById("switch12").style.cursor="pointer"}}
var q=document.getElementById("checkbox0").checked;if(q==!0){document.getElementById("row5").disabled=!0}else{document.getElementById("row5").disabled=!1}
var r=document.getElementById("checkbox1").checked;if(r==!0){document.getElementById("row6").disabled=!0}else{document.getElementById("row6").disabled=!1}
if(q==!0||r==!0){document.getElementById("row3").disabled=!0}else{document.getElementById("row3").disabled=!1}
var s=document.getElementById("checkbox2").checked;if(s==!0){document.getElementById("row7").disabled=!0}else{document.getElementById("row7").disabled=!1}
if(r==!0||s==!0){document.getElementById("row4").disabled=!0}else{document.getElementById("row4").disabled=!1}
for(var i=0;i<numberOfGestures;i++){var x=document.getElementById("row"+i).value;var t=document.getElementById("row"+i).disabled;if((x!=1||t==!0)){document.getElementById("MIDIrow"+i).disabled=!0;document.getElementById("channel"+i).disabled=!0;document.getElementById("byte2_"+i).disabled=!0;document.getElementById("byte3_"+i).disabled=!0}else{document.getElementById("MIDIrow"+i).disabled=!1;document.getElementById("channel"+i).disabled=!1;document.getElementById("byte2_"+i).disabled=!1;document.getElementById("byte3_"+i).disabled=!1}
var y=document.getElementById("MIDIrow"+i).value;if(y==2){document.getElementById("byte3_"+i).disabled=!0}
if(y>2){document.getElementById("byte2_"+i).disabled=!0;document.getElementById("byte3_"+i).disabled=!0}
var z=document.getElementById("row"+i).value;if(((y==0||(version>4.1&&y==1))&&i<3&&x==1)||((version>1.4||version=="Unknown")&&i<3&&(z==5||z==6||z==10||z==11||z==16))){document.getElementById("checkbox"+i).disabled=!1;document.getElementById("switch"+i).style.cursor="pointer"}
if(((((y!=0&&version<=4.1)||(version>4.1&&y>1))&&i<3)||(i<3&&(x==0||x>1)))&&!((version>1.4||version=="Unknown")&&i<3&&(z==5||z==6||z==10||z==11||z==16))){document.getElementById("checkbox"+i).disabled=!0;document.getElementById("switch"+i).style.cursor="default";document.getElementById("checkbox"+i).checked=!1}
var q=document.getElementById("checkbox0").checked;if(q==!0){document.getElementById("row5").disabled=!0}else{document.getElementById("row5").disabled=!1}
var r=document.getElementById("checkbox1").checked;if(r==!0){document.getElementById("row6").disabled=!0}else{document.getElementById("row6").disabled=!1}
if(q==!0||r==!0){document.getElementById("row3").disabled=!0}else{document.getElementById("row3").disabled=!1}
var s=document.getElementById("checkbox2").checked;if(s==!0){document.getElementById("row7").disabled=!0}else{document.getElementById("row7").disabled=!1}
if(r==!0||s==!0){document.getElementById("row4").disabled=!0}else{document.getElementById("row4").disabled=!1}}
var z=$("#fingeringSelect0 option:selected").text();document.getElementById("fingeringLabel1").innerHTML=z;var z=$("#fingeringSelect1 option:selected").text();document.getElementById("fingeringLabel2").innerHTML=z;var z=$("#fingeringSelect2 option:selected").text();document.getElementById("fingeringLabel3").innerHTML=z}
function MIDIvalueChange(){for(var i=0;i<numberOfGestures;i++){var x=document.getElementById("channel"+i).value;if(((x<0||x>16||isNaN(x))&&!document.getElementById("channel"+i).disabled)){alert("Value must be 1-16.");document.getElementById("channel"+i).value=null}}
for(var j=0;j<numberOfGestures;j++){var y=document.getElementById("channel"+j).value;var x=document.getElementById("byte2_"+j).value;if(x<0||x>127||isNaN(x)){alert("Value must be 0-127.");document.getElementById("byte2_"+j).value=null}
if(y==7&&x>101&&x<120){alert("This CC range on channel 7 is reserved for the Configuration Tool.");document.getElementById("byte2_"+j).value=null}}
for(var k=0;k<numberOfGestures;k++){var x=document.getElementById("byte3_"+k).value;if(x<0||x>127||isNaN(x)){alert("Value must be 0-127.");document.getElementById("byte3_"+k).value=null}}}
var AudioContextFunc=window.AudioContext||window.webkitAudioContext;var audioContext=new AudioContextFunc();var player=new WebAudioFontPlayer();player.loader.decodeAfterLoading(audioContext,'_tone_0650_SBLive_sf2');function topNavFunction(){var x=document.getElementById("myTopnav");if(x.className==="topnav"){x.className+=" responsive"}else{x.className="topnav"}}
function sleep(ms){return new Promise(resolve=>setTimeout(resolve,ms))}
function importPreset(context){if(!WARBLout){document.getElementById("modal14-title").innerHTML="Preset import only allowed when WARBL is connected";document.getElementById("modal14-ok").style.opacity=1.0;modal(14);return}
var maxSupportedPresetVersion=1;var delay=10;if(context.files&&(context.files.length!=0)){var fname=context.files[0].name;fname=fname.replace(".warbl","");fname=fname.replace(".WARBL","");document.getElementById("modal14-title").innerHTML="Importing: "+context.files[0].name;document.getElementById("modal14-ok").style.opacity=0.001;modal(14);var reader=new FileReader();reader.onload=async function(){try{var theImportObject=JSON.parse(reader.result)}catch(e){document.getElementById("modal14-title").innerHTML="Error: File is not a WARBL Preset";return;document.getElementById("modal14-ok").style.opacity=1}
if(!theImportObject){document.getElementById("modal14-title").innerHTML="Error: File is not a WARBL Preset";return;document.getElementById("modal14-ok").style.opacity=1}
if((!theImportObject.signature)||(theImportObject.signature!="WARBL")){document.getElementById("modal14-title").innerHTML="Error: File is not a WARBL Preset";return;document.getElementById("modal14-ok").style.opacity=1}
if(!theImportObject.version){document.getElementById("modal14-title").innerHTML="Error: File is not a WARBL Preset";return;document.getElementById("modal14-ok").style.opacity=1}
if(theImportObject.version>maxSupportedPresetVersion){document.getElementById("modal14-title").innerHTML="Error: WARBL Preset Version "+theImportObject.version+" not supported by this version of the configuration tool";document.getElementById("modal14-ok").style.opacity=1;return}
if((theImportObject.messages[0][2]>40&&version<4.0)||(theImportObject.messages[0][2]<40&&version>4.0)){document.getElementById("modal14-title").innerHTML="Sorry, it is not possible to import settings from the original WARBL to WARBL2 or vice versa.";document.getElementById("modal14-ok").style.opacity=1;return}
var nMessages=theImportObject.messages.length;var i;var byte0,byte1,byte2;byte0=theImportObject.messages[0][0];byte1=theImportObject.messages[0][1];byte2=theImportObject.messages[0][2];sendToWARBL(byte1,byte2);await sleep(delay);var exportedInstrument=theImportObject.messages[10][2]-60;var targetInstrument=30+instrument;var targetKey=111+instrument;switch(exportedInstrument){case 0:byte0=theImportObject.messages[1][0];byte1=theImportObject.messages[1][2];byte2=targetInstrument;sendToWARBL(byte1,byte2);await sleep(delay);byte0=theImportObject.messages[2][0];byte1=theImportObject.messages[2][1];byte2=theImportObject.messages[2][2];sendToWARBL(byte1,byte2);await sleep(delay);byte0=theImportObject.messages[3][0];byte1=targetKey;byte2=theImportObject.messages[3][2];sendToWARBL(byte1,byte2);await sleep(delay);break;case 1:byte0=theImportObject.messages[4][0];byte1=theImportObject.messages[4][1];byte2=targetInstrument;sendToWARBL(byte1,byte2);await sleep(delay);byte0=theImportObject.messages[5][0];byte1=theImportObject.messages[5][1];byte2=theImportObject.messages[5][2];sendToWARBL(byte1,byte2);await sleep(delay);byte0=theImportObject.messages[6][0];byte1=targetKey;byte2=theImportObject.messages[6][2];sendToWARBL(byte1,byte2);await sleep(delay);break;case 2:byte0=theImportObject.messages[7][0];byte1=theImportObject.messages[7][1];byte2=targetInstrument;sendToWARBL(byte1,byte2);await sleep(delay);byte0=theImportObject.messages[8][0];byte1=theImportObject.messages[8][1];byte2=theImportObject.messages[8][2];sendToWARBL(byte1,byte2);await sleep(delay);byte0=theImportObject.messages[9][0];byte1=targetKey;byte2=theImportObject.messages[9][2];sendToWARBL(byte1,byte2);await sleep(delay);break}
for(i=12;i<nMessages;++i){byte0=theImportObject.messages[i][0];byte1=theImportObject.messages[i][1];byte2=theImportObject.messages[i][2];if(byte1==106){if(byte2>=55&&byte2<=57){WARBL2SettingsReceive="null"}else{WARBL2SettingsReceive=0}}
if(!((byte1==MIDI_CC_119)||(byte1==MIDI_CC_106&&(byte2>=55&&byte2<=99)))){sendToWARBL(byte1,byte2);await sleep(delay)}}
setTimeout(function(){sendToWARBL(MIDI_CC_102,MIDI_ENTER_COMM_MODE);document.getElementById("modal14-title").innerHTML="Preset Import Complete!";document.getElementById("modal14-ok").style.opacity=1.0;setTimeout(function(){$('#importPreset').val('')},1000)},500)}
reader.readAsText(context.files[0])}}
function exportPreset(){if(!WARBLout){document.getElementById("modal14-title").innerHTML="Preset export only allowed when WARBL is connected";document.getElementById("modal14-ok").style.opacity=1.0;modal(14);return}
var nMessages=0;document.getElementById("modal14-ok").style.opacity=0.0;document.getElementById("modal14-title").innerHTML="Exporting...";modal(14);var theExportObject={signature:"WARBL",version:1,messages:[]};function downloadPreset(content,filename,contentType){const a=document.createElement('a');const file=new Blob([content],{type:contentType});a.href=URL.createObjectURL(file);a.download=filename;a.click();URL.revokeObjectURL(a.href);document.getElementById("modal14-title").innerHTML="Preset Export Complete!";document.getElementById("modal14-ok").style.opacity=1.0;modal(14)};function exportMessageHandler(byte0,byte1,byte2){theExportObject.messages.push([byte0,byte1,byte2]);nMessages++}
function exportFunction(){var theExportObjectJSON=JSON.stringify(theExportObject);gExportProxy=null;downloadPreset(theExportObjectJSON,"WARBL_Preset.warbl","text/plain")}
gExportProxy=exportMessageHandler;sendToWARBL(MIDI_CC_102,MIDI_ENTER_COMM_MODE);setTimeout(exportFunction,3000)}
function capturePressure(val){gCurrentPressure=val}
function graphPressure(){gPressureReadings.pop();gPressureReadings.unshift(gCurrentPressure);$("#d3PressureGraph").empty();var margin={top:10,right:10,bottom:100,left:50},width=390,height=320-margin.top-margin.bottom;var svg=d3.select("#d3PressureGraph").append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")");var x=d3.scaleLinear().domain([0,width]).range([0,width]);svg.append('g').attr("transform","translate(0,"+height+")").call(d3.axisBottom(x).tickSize(0).tickFormat(""));var y=d3.scaleLinear().domain([0,gMaxPressure]).range([height,0]);svg.append('g').call(d3.axisLeft(y));svg.append("text").attr("y",(height+4)).attr("x",(width/2)-(margin.left/2)+10).attr("dy","1em").style("text-anchor","middle").style("fill","white").text("Time");svg.append("text").attr("transform","rotate(-90)").attr("y",0-(margin.left-5)).attr("x",0-(height/2)).attr("dy","1em").style("text-anchor","middle").style("fill","white").text("Inches of HO");var xScale=d3.scaleLinear().domain([0,gNPressureReadings-1]).range([0,width]);var yScale=d3.scaleLinear().domain([0,gMaxPressure]).range([height,0]);var line=d3.line().x(function(d,i){return xScale(i)}).y(function(d){return yScale(d.y)}).curve(d3.curveMonotoneX);var dataset=d3.range(gNPressureReadings).map(function(d){return{"y":gPressureReadings[d]}});svg.append("path").datum(dataset).attr("class","pressureline").attr("d",line)}
function startPressureGraph(){gPressureGraphEnabled=!0;gCurrentPressure=0.0;var i;gPressureReadings=[];for(i=0;i<gNPressureReadings;++i){gPressureReadings.push(0.0)}
gGraphInterval=setInterval(graphPressure,100)}
function stopPressureGraph(){gPressureGraphEnabled=!1;clearInterval(gGraphInterval);$("#d3PressureGraph").empty();return}